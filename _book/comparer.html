<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 13 Comparer | Méthodes quantitatives avec R</title>
<meta name="author" content="P.-O. Caron">
<meta name="description" content="Les expérimentateurs souhaitent souvent tester plus que deux moyennes. L’analyse de variance, souvent appelée ANOVA (ANalysis Of VAriance), permet de comparer une variable continue sur plusieurs...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content=" 13 Comparer | Méthodes quantitatives avec R">
<meta property="og:type" content="book">
<meta property="og:url" content="mqr.teluq.ca/comparer.html">
<meta property="og:description" content="Les expérimentateurs souhaitent souvent tester plus que deux moyennes. L’analyse de variance, souvent appelée ANOVA (ANalysis Of VAriance), permet de comparer une variable continue sur plusieurs...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 13 Comparer | Méthodes quantitatives avec R">
<meta name="twitter:description" content="Les expérimentateurs souhaitent souvent tester plus que deux moyennes. L’analyse de variance, souvent appelée ANOVA (ANalysis Of VAriance), permet de comparer une variable continue sur plusieurs...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.0/htmlwidgets.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.11/grViz.js"></script><!-- 
    \(
    \newcommand{\EX}{\mathbb{E}}
    \)
    --><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Méthodes quantitatives avec R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bienvenue!</a></li>
<li><a class="" href="pr%C3%A9face.html">Préface</a></li>
<li class="book-part">Rudiments</li>
<li><a class="" href="commencer.html"><span class="header-section-number">1</span> Commencer</a></li>
<li><a class="" href="programmer.html"><span class="header-section-number">2</span> Programmer</a></li>
<li><a class="" href="calculer.html"><span class="header-section-number">3</span> Calculer</a></li>
<li><a class="" href="r%C3%A9diger.html"><span class="header-section-number">4</span> Rédiger</a></li>
<li><a class="" href="exercice-rudiments.html">Exercices</a></li>
<li class="book-part">Jeux de données</li>
<li><a class="" href="entrer.html"><span class="header-section-number">5</span> Entrer</a></li>
<li><a class="" href="importer.html"><span class="header-section-number">6</span> Importer</a></li>
<li><a class="" href="manipuler.html"><span class="header-section-number">7</span> Manipuler</a></li>
<li><a class="" href="visualiser.html"><span class="header-section-number">8</span> Visualiser</a></li>
<li><a class="" href="exercice-gestion.html">Exercices</a></li>
<li class="book-part">Statistiques</li>
<li><a class="" href="d%C3%A9crire.html"><span class="header-section-number">9</span> Décrire</a></li>
<li><a class="" href="inf%C3%A9rer.html"><span class="header-section-number">10</span> Inférer</a></li>
<li><a class="" href="analyser.html"><span class="header-section-number">11</span> Analyser</a></li>
<li><a class="" href="simuler.html"><span class="header-section-number">12</span> Simuler</a></li>
<li><a class="" href="exercice-analyse.html">Exercices</a></li>
<li class="book-part">Modèles linéaires</li>
<li><a class="active" href="comparer.html"><span class="header-section-number">13</span> Comparer</a></li>
<li><a class="" href="pr%C3%A9dire.html"><span class="header-section-number">14</span> Prédire</a></li>
<li><a class="" href="cr%C3%A9er.html"><span class="header-section-number">15</span> Créer</a></li>
<li><a class="" href="m%C3%A9dier.html"><span class="header-section-number">16</span> Médier</a></li>
<li><a class="" href="mod%C3%A9rer.html"><span class="header-section-number">17</span> Modérer</a></li>
<li><a class="" href="exercice-lineaire.html">Exercices</a></li>
<li class="book-part">Analyses factorielles</li>
<li><a class="" href="d%C3%A9composer.html"><span class="header-section-number">18</span> Décomposer</a></li>
<li><a class="" href="explorer.html"><span class="header-section-number">19</span> Explorer</a></li>
<li><a class="" href="r%C3%A9duire.html"><span class="header-section-number">20</span> Réduire</a></li>
<li><a class="" href="exercice-factoriel.html">Exercices</a></li>
<li class="book-part">Équations structurelles</li>
<li><a class="" href="confirmer.html"><span class="header-section-number">21</span> Confirmer</a></li>
<li><a class="" href="classer.html"><span class="header-section-number">22</span> Classer</a></li>
<li class="book-part">Annexes</li>
<li><a class="" href="solutions.html">Solutions</a></li>
<li><a class="" href="r%C3%A9f%C3%A9rences.html">Références</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/quantmeth/MQR">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="comparer" class="section level1" number="13">
<h1>
<span class="header-section-number"> 13</span> Comparer<a class="anchor" aria-label="anchor" href="#comparer"><i class="fas fa-link"></i></a>
</h1>
<p>Les expérimentateurs souhaitent souvent tester plus que deux moyennes. L’analyse de variance, souvent appelée ANOVA (<em>ANalysis Of VAriance</em>), permet de comparer une variable continue sur plusieurs groupes ou traitements. Il s’agit d’une extension du test-<span class="math inline">\(t\)</span> indépendant qui compare une variable continue auprès de deux groupes. À plus de deux groupes, l’analyse de variance entre en jeu.</p>
<p><strong>Attention!</strong> Cette section se limite au cas où les groupes sont de tailles identiques (même nombre de participants par groupe, le symbole <span class="math inline">\(n_k\)</span> pour référer à cette quantité) afin d’en simplifier la présentation.</p>
<div id="la-logique-de-lanalyse-de-variance" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> La logique de l’analyse de variance<a class="anchor" aria-label="anchor" href="#la-logique-de-lanalyse-de-variance"><i class="fas fa-link"></i></a>
</h2>
<p>Comme il a été présenté dans la section sur <a href="analyser.html#le-test-t-ind%C3%A9pendant">le test-<span class="math inline">\(t\)</span> indépendant</a>, le modèle sous-jacent à l’analyse de variance à un facteur est une extension de ce modèle pour <span class="math inline">\(k\)</span> groupes. Chaque groupe est associé à une différence de moyennes <span class="math inline">\(\mu_i\)</span>, pour <span class="math inline">\(i = 1,2, ...k\)</span> par rapport à la moyenne groupe référent, <span class="math inline">\(\mu_0\)</span>. Les variables <span class="math inline">\(x_i\)</span> définissent l’appartenance au groupe <span class="math inline">\(i\)</span> par la valeur 1 et 0 pour les autres groupes (codage factice ou <em>dummy coding</em>).</p>
<p><span class="math display">\[y = \mu_0 + \mu_1x_1 + \mu_2x_2+ ... +\mu_kx_k + \epsilon\]</span>
L’hypothèse nulle est la suivante.
<span class="math display">\[\sigma^2_1=\sigma^2_2=...=\sigma^2_k\]</span>
L’analyse de variance est un test omnibus (global) qui ne teste pas où est la différence, mais bien <em>s’il y a au moins une différence</em> entre les groupes. L’hypothèse nulle peut s’avérer fausse de plusieurs façons. Il peut y avoir une ou plusieurs inégalités pour rejeter l’hypothèse nulle.</p>
<p>La logique sous-jacente est basée sur l’idée selon laquelle les moyennes des groupes proviennent d’une même population. Elle compare les hypothèses suivantes : l’hypothèse nulle : les données (les moyennes) proviennent d’une même population; et l’hypothèse opposée : les données ne proviennent pas d’une même population.</p>
<p>Elle suggère ainsi deux types de variances (ou carré moyen, CM, dans ce contexte) : le CMI, carré moyen intergroupe, lorsque l’hypothèse nulle est vraie (la variabilité des moyennes); et le CMR, carré moyen résiduel, lorsque l’hypothèse nulle n’est ni vraie, ni fausse (la variabilité des données).</p>
<p>Pour calculer le CMI, la variance des moyennes des groupes est
<span class="math display">\[s^2_{\bar{x}}=\sum_{i=1}^k\frac{(\bar{x_i}-\overline{\overline{x}})^2}{k-1}\]</span></p>
<p>où <span class="math inline">\(\overline{\overline{x}}\)</span> est la grande moyenne (la moyenne de toutes les unités). Cette statistique se retrouve sur la plan des distributions d’échantillonnage (comment les moyennes se distribuent). Il faut ainsi multiplier cette valeur par <span class="math inline">\(n_k\)</span>, le nombre d’unités par groupes, pour obtenir une estimation de la variance de la population. Ainsi, <span class="math inline">\(\text{CMI} = s^2_{\bar{x}}n_k\)</span>.</p>
<p>Il y a plusieurs méthodes pour calculer le CMR, comme le CMR est envisagé comme la moyenne des variances de groupes, il est pratique d’en référer le calcul à sa définition.</p>
<p><span class="math display">\[
\text{CMR} = \bar{s^2} = \frac{1}{k}\sum_{i=k}^k\sigma_k^2
\]</span>
Lorsque l’hypothèse nulle est vraie, les variances des groupes sont traitées comme le résultat d’une étude sur une même population, comme si <span class="math inline">\(k\)</span> petites études avaient été réalisées. L’estimation du CMI est de l’ordre d’une distribution d’échantillonnage connue par le théorème central limite définissant le comportement des moyennes lorsqu’elles proviennent d’une même population (c’est ce que pose comme hypothèse l’analyse de variance). Toutefois, la valeur du CMI est relative au CMR, la quantité de bruit dans les données.</p>
<p>L’analyse de variance pose alors la question : la variance attribuable aux différentes moyennes des groupes est-elle supérieure à la variance résiduelle? Pour tester cette question, une possibilité est de tester le ratio <span class="math inline">\(\frac{\text{CMI}}{\text{CMR}}\)</span>, ce qui donne une valeur-<span class="math inline">\(F\)</span>. Le ratio de deux variances suit une distribution-<span class="math inline">\(F_{dl_1, dl_2}\)</span> avec deux degrés de liberté différents qui lui sont associés. Autrement dit, la distribution-<span class="math inline">\(F\)</span> est la distribution d’échantillonnage du ratio deux variances.</p>
<p><span class="math display">\[F_{dl_1,dl_2} = \frac{n_ks^2_{\bar{x}}}{\bar{s^2}} = \frac{\text{CMI}}{\text{CMR}}\]</span>
où <span class="math inline">\(dl_1 = k-1\)</span>, et <span class="math inline">\(dl_2 = k(n_k-1)\)</span>. L’interprétation du ratio est ainsi :</p>
<ul>
<li>si <span class="math inline">\(\text{CMI}&gt;\text{CMR}\)</span>, alors <span class="math inline">\(\text{CMI}/\text{CMR}&gt;1\)</span>;</li>
<li>si <span class="math inline">\(\text{CMI}=\text{CMR}\)</span>, alors <span class="math inline">\(\text{CMI}/\text{CMR}=1\)</span>;</li>
<li>si <span class="math inline">\(\text{CMI}&lt;\text{CMR}\)</span>, alors <span class="math inline">\(\text{CMI}/\text{CMR}&lt;1\)</span>.</li>
</ul>
<p>Plus les moyennes sont variables, plus la valeur du CMI est élevée. Plus les unités sont variables, plus le CMR est élevé. S’il existe au moins une différence entre les groupes, le ratio est en faveur du CMI. En fait, plus <span class="math inline">\(F\)</span> est élevée, toutes autres choses étant égales (les degrés de libertés, p. ex.), plus la probabilité de rejeter l’hypothèse nulle est grande. Ainsi, lorsque, la valeur-<span class="math inline">\(F\)</span> est obtenue, il est possible de calculer une valeur-<span class="math inline">\(p\)</span>, et le test d’hypothèse se déroule tel qu’auparavant.</p>
</div>
<div id="la-création-de-données" class="section level2" number="13.2">
<h2>
<span class="header-section-number">13.2</span> La création de données<a class="anchor" aria-label="anchor" href="#la-cr%C3%A9ation-de-donn%C3%A9es"><i class="fas fa-link"></i></a>
</h2>
<p>Dans un jeu de données commun, une variable désigne les groupes et une autre leur score sur une certaine mesure. La syntaxe suivante montre trois façons pour créer une variable facteur.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="comparer.html#cb173-1" aria-hidden="true" tabindex="-1"></a>nk <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># nombre d'unités par groupe</span></span>
<span id="cb173-2"><a href="comparer.html#cb173-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>  <span class="co"># nombre de groupes</span></span>
<span id="cb173-3"><a href="comparer.html#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="co"># En ordre</span></span>
<span id="cb173-4"><a href="comparer.html#cb173-4" aria-hidden="true" tabindex="-1"></a>groupe1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">each =</span> nk)</span>
<span id="cb173-5"><a href="comparer.html#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="co"># En alternance</span></span>
<span id="cb173-6"><a href="comparer.html#cb173-6" aria-hidden="true" tabindex="-1"></a>groupe2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">times =</span> nk)</span>
<span id="cb173-7"><a href="comparer.html#cb173-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Aléatoire</span></span>
<span id="cb173-8"><a href="comparer.html#cb173-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">765</span>)</span>
<span id="cb173-9"><a href="comparer.html#cb173-9" aria-hidden="true" tabindex="-1"></a>groupe3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>k, <span class="at">size =</span> (k <span class="sc">*</span> nk), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb173-10"><a href="comparer.html#cb173-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(groupe1, groupe2, groupe3)</span>
<span id="cb173-11"><a href="comparer.html#cb173-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>       groupe1 groupe2 groupe3</span>
<span id="cb173-12"><a href="comparer.html#cb173-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">1</span>,]       <span class="dv">1</span>       <span class="dv">1</span>       <span class="dv">4</span></span>
<span id="cb173-13"><a href="comparer.html#cb173-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">2</span>,]       <span class="dv">1</span>       <span class="dv">2</span>       <span class="dv">2</span></span>
<span id="cb173-14"><a href="comparer.html#cb173-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">3</span>,]       <span class="dv">1</span>       <span class="dv">3</span>       <span class="dv">4</span></span>
<span id="cb173-15"><a href="comparer.html#cb173-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">4</span>,]       <span class="dv">1</span>       <span class="dv">4</span>       <span class="dv">3</span></span>
<span id="cb173-16"><a href="comparer.html#cb173-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">5</span>,]       <span class="dv">1</span>       <span class="dv">1</span>       <span class="dv">3</span></span>
<span id="cb173-17"><a href="comparer.html#cb173-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">6</span>,]       <span class="dv">2</span>       <span class="dv">2</span>       <span class="dv">4</span></span>
<span id="cb173-18"><a href="comparer.html#cb173-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">7</span>,]       <span class="dv">2</span>       <span class="dv">3</span>       <span class="dv">3</span></span>
<span id="cb173-19"><a href="comparer.html#cb173-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">8</span>,]       <span class="dv">2</span>       <span class="dv">4</span>       <span class="dv">1</span></span>
<span id="cb173-20"><a href="comparer.html#cb173-20" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">9</span>,]       <span class="dv">2</span>       <span class="dv">1</span>       <span class="dv">4</span></span>
<span id="cb173-21"><a href="comparer.html#cb173-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">10</span>,]       <span class="dv">2</span>       <span class="dv">2</span>       <span class="dv">3</span></span>
<span id="cb173-22"><a href="comparer.html#cb173-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">11</span>,]       <span class="dv">3</span>       <span class="dv">3</span>       <span class="dv">3</span></span>
<span id="cb173-23"><a href="comparer.html#cb173-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">12</span>,]       <span class="dv">3</span>       <span class="dv">4</span>       <span class="dv">2</span></span>
<span id="cb173-24"><a href="comparer.html#cb173-24" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">13</span>,]       <span class="dv">3</span>       <span class="dv">1</span>       <span class="dv">3</span></span>
<span id="cb173-25"><a href="comparer.html#cb173-25" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">14</span>,]       <span class="dv">3</span>       <span class="dv">2</span>       <span class="dv">3</span></span>
<span id="cb173-26"><a href="comparer.html#cb173-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">15</span>,]       <span class="dv">3</span>       <span class="dv">3</span>       <span class="dv">2</span></span>
<span id="cb173-27"><a href="comparer.html#cb173-27" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">16</span>,]       <span class="dv">4</span>       <span class="dv">4</span>       <span class="dv">4</span></span>
<span id="cb173-28"><a href="comparer.html#cb173-28" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">17</span>,]       <span class="dv">4</span>       <span class="dv">1</span>       <span class="dv">4</span></span>
<span id="cb173-29"><a href="comparer.html#cb173-29" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">18</span>,]       <span class="dv">4</span>       <span class="dv">2</span>       <span class="dv">2</span></span>
<span id="cb173-30"><a href="comparer.html#cb173-30" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">19</span>,]       <span class="dv">4</span>       <span class="dv">3</span>       <span class="dv">1</span></span>
<span id="cb173-31"><a href="comparer.html#cb173-31" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">20</span>,]       <span class="dv">4</span>       <span class="dv">4</span>       <span class="dv">1</span></span></code></pre></div>
<p>Il est aussi possible de remplacer les arguments, <code>1:k</code> par des chaînes de caractères (des catégories au lieu de nombres).</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="comparer.html#cb174-1" aria-hidden="true" tabindex="-1"></a>categorie <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"char"</span>, <span class="st">"chat"</span>, <span class="st">"cheval"</span>, <span class="st">"chevalier"</span>, <span class="st">"chien"</span>)</span>
<span id="cb174-2"><a href="comparer.html#cb174-2" aria-hidden="true" tabindex="-1"></a>nk <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb174-3"><a href="comparer.html#cb174-3" aria-hidden="true" tabindex="-1"></a>groupe <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">rep</span>(categorie, <span class="at">each =</span> nk)) <span class="co"># Déclarer comme facteur</span></span>
<span id="cb174-4"><a href="comparer.html#cb174-4" aria-hidden="true" tabindex="-1"></a>groupe</span>
<span id="cb174-5"><a href="comparer.html#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">1</span>] char      char      chat      chat      cheval   </span>
<span id="cb174-6"><a href="comparer.html#cb174-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">6</span>] cheval    chevalier chevalier chien     chien    </span>
<span id="cb174-7"><a href="comparer.html#cb174-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Levels<span class="sc">:</span> char chat cheval chevalier chien</span></code></pre></div>
<p>Une bonne pratique dans le contexte des comparaisons de moyenne est de déclarer les variables catégorielles comme facteur avec <code><a href="https://rdrr.io/r/base/factor.html">as.factor()</a></code>.</p>
<p>Pour créer des valeurs à ces catégories, une stratégie simple est de créer des valeurs pour chacun des groupes et de les combiner.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="comparer.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la reproductibilité</span></span>
<span id="cb175-2"><a href="comparer.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2602</span>)</span>
<span id="cb175-3"><a href="comparer.html#cb175-3" aria-hidden="true" tabindex="-1"></a>char      <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> nk, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">4</span>) </span>
<span id="cb175-4"><a href="comparer.html#cb175-4" aria-hidden="true" tabindex="-1"></a>chat      <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> nk, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">4</span>) <span class="co"># Différences ici</span></span>
<span id="cb175-5"><a href="comparer.html#cb175-5" aria-hidden="true" tabindex="-1"></a>cheval    <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> nk, <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">4</span>) <span class="co"># et ici</span></span>
<span id="cb175-6"><a href="comparer.html#cb175-6" aria-hidden="true" tabindex="-1"></a>chevalier <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> nk, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb175-7"><a href="comparer.html#cb175-7" aria-hidden="true" tabindex="-1"></a>chien     <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> nk, <span class="at">mean =</span> <span class="dv">15</span>, <span class="at">sd =</span> <span class="dv">4</span>) </span>
<span id="cb175-8"><a href="comparer.html#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinés</span></span>
<span id="cb175-9"><a href="comparer.html#cb175-9" aria-hidden="true" tabindex="-1"></a>score <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(char, chat, cheval, chevalier, chien))</span>
<span id="cb175-10"><a href="comparer.html#cb175-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Conserver toutes les informations en un jeu de données</span></span>
<span id="cb175-11"><a href="comparer.html#cb175-11" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(groupe, score)</span>
<span id="cb175-12"><a href="comparer.html#cb175-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(donnees)</span>
<span id="cb175-13"><a href="comparer.html#cb175-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>   groupe score</span>
<span id="cb175-14"><a href="comparer.html#cb175-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">1</span>   char    <span class="dv">14</span></span>
<span id="cb175-15"><a href="comparer.html#cb175-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">2</span>   char    <span class="dv">12</span></span>
<span id="cb175-16"><a href="comparer.html#cb175-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">3</span>   chat    <span class="dv">17</span></span>
<span id="cb175-17"><a href="comparer.html#cb175-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">4</span>   chat    <span class="dv">21</span></span>
<span id="cb175-18"><a href="comparer.html#cb175-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">5</span> cheval    <span class="dv">14</span></span>
<span id="cb175-19"><a href="comparer.html#cb175-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">6</span> cheval    <span class="dv">10</span></span></code></pre></div>
</div>
<div id="codage-factice" class="section level2" number="13.3">
<h2>
<span class="header-section-number">13.3</span> Codage factice<a class="anchor" aria-label="anchor" href="#codage-factice"><i class="fas fa-link"></i></a>
</h2>
<p>La plupart du temps, les variables de regroupement, les variables identifiant l’appartenance aux groupes, sont construites avec une variable de type facteur, c’est-à-dire une colonne avec différentes valeurs ou libellés. C’est d’ailleurs ce qui a été fait dans l’exemple précédent. Cette méthode d’identification de groupement implique une programmation plus intensive, surtout pour la création de valeurs. En termes de programmation, il est plus élégant de recourir à une fonction de codage factice (<em>dummy coding</em>). Cela permettra de représenter fidèlement le modèle sous-jacent. Étrangement, il n’y a pas de fonction de base avec <strong>R</strong> pour du codage factice. Une fonction maison permettra d’automatiser la réassignation des groupes (en une seule variable) sur plusieurs variables désignant leur appartenance.</p>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dummy.coding</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># Retourne un codage factice de x</span></span>
<span>  <span class="co"># avec les facteurs en ordre alphabétique</span></span>
<span>  <span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, </span>
<span>              USE.NAMES <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span> <span class="op">==</span> <span class="va">v</span><span class="op">}</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">W</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>La plupart du temps, les variables de regroupement, les variables identifiant l’appartenance aux groupes, sont construites avec une variable de type facteur, c’est-à-dire une colonne avec différentes valeurs ou libellés. C’est d’ailleurs ce qui a été fait dans l’exemple précédent. Cette méthode d’identification de groupement implique une programmation plus intensive, surtout pour la création de valeurs. En termes de programmation, il est plus élégant de recourir à une fonction de codage factice. Cela permettra de représenter fidèlement le modèle sous-jacent. Étrangement, il n’y a pas de fonction de base avec <strong>R</strong> pour du codage factice. Une fonction maison permettra d’automatiser la réassignation des groupes (en une seule variable) sur plusieurs variables désignant leur appartenance.</p>
<!-- ```{r} -->
<!-- dummy.coding <- function(x){ -->
<!--   # Retourne un codage factice de x -->
<!--   # avec les facteurs en ordre alphabétique -->
<!--   tab <- table(x)    # Extraire une table -->
<!--   k <- length(tab)   # Nombre de groupes -->
<!--   n <- length(x)     # Nombre d'unités -->
<!--   X <- matrix(0, nrow = n, ncol = k) # Création d'une nouvelle variable  -->
<!--   xlev <- as.factor(x) -->
<!--   for (i in 1:n) { -->
<!--     X[i, xlev[i]] <- 1 # Identification des groupes -->
<!--   } -->
<!--   colnames(X) <- names(tab) -->
<!--   return(X) -->
<!-- } -->
<!-- ``` -->
<p>La fonction maison retourne un codage factice pour les <span class="math inline">\(k\)</span> groupes. <strong>Attention</strong>, le codage factice est fait en ordre alphabétique. Comme il est redondant d’avoir <span class="math inline">\(k\)</span> groupes (identifier <span class="math inline">\(k\)</span> groupes nécessite <span class="math inline">\(k-1\)</span> variables), un groupe référent est désigné. Ce dernier aura 0 sur tous les scores. Pour retirer un groupe, l’utilisation des crochets et une valeur négative associés à la colonne du groupe référent feront l’affaire, p. ex. <code>dummy.coding(x)[,-k]</code> déclare le <span class="math inline">\(k\)</span><sup>e</sup> groupe comme le groupe référent.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="comparer.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la reproductibilité</span></span>
<span id="cb177-2"><a href="comparer.html#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2602</span>)</span>
<span id="cb177-3"><a href="comparer.html#cb177-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-4"><a href="comparer.html#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Facteur de groupe</span></span>
<span id="cb177-5"><a href="comparer.html#cb177-5" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">length</span>(categorie)</span>
<span id="cb177-6"><a href="comparer.html#cb177-6" aria-hidden="true" tabindex="-1"></a>nk <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb177-7"><a href="comparer.html#cb177-7" aria-hidden="true" tabindex="-1"></a>groupe <span class="ot">&lt;-</span> <span class="fu">rep</span>(categorie, <span class="at">each =</span> nk)</span>
<span id="cb177-8"><a href="comparer.html#cb177-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-9"><a href="comparer.html#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Groupement</span></span>
<span id="cb177-10"><a href="comparer.html#cb177-10" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">dummy.coding</span>(groupe)[,<span class="sc">-</span><span class="dv">5</span>] <span class="co"># groupe 4 "chien" comme référent</span></span>
<span id="cb177-11"><a href="comparer.html#cb177-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-12"><a href="comparer.html#cb177-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Spécifications des paramètres</span></span>
<span id="cb177-13"><a href="comparer.html#cb177-13" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb177-14"><a href="comparer.html#cb177-14" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>)</span>
<span id="cb177-15"><a href="comparer.html#cb177-15" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> k <span class="sc">*</span> nk, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb177-16"><a href="comparer.html#cb177-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-17"><a href="comparer.html#cb177-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Création des scores</span></span>
<span id="cb177-18"><a href="comparer.html#cb177-18" aria-hidden="true" tabindex="-1"></a>score <span class="ot">&lt;-</span> <span class="fu">round</span>(mu0 <span class="sc">+</span> X <span class="sc">%*%</span> mu <span class="sc">+</span> e)</span>
<span id="cb177-19"><a href="comparer.html#cb177-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-20"><a href="comparer.html#cb177-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparaison des valeurs</span></span>
<span id="cb177-21"><a href="comparer.html#cb177-21" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(donnees, score)</span>
<span id="cb177-22"><a href="comparer.html#cb177-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>       groupe score score</span>
<span id="cb177-23"><a href="comparer.html#cb177-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">1</span>       char    <span class="dv">14</span>    <span class="dv">14</span></span>
<span id="cb177-24"><a href="comparer.html#cb177-24" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">2</span>       char    <span class="dv">12</span>    <span class="dv">12</span></span>
<span id="cb177-25"><a href="comparer.html#cb177-25" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">3</span>       chat    <span class="dv">17</span>    <span class="dv">17</span></span>
<span id="cb177-26"><a href="comparer.html#cb177-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">4</span>       chat    <span class="dv">21</span>    <span class="dv">21</span></span>
<span id="cb177-27"><a href="comparer.html#cb177-27" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">5</span>     cheval    <span class="dv">14</span>    <span class="dv">14</span></span>
<span id="cb177-28"><a href="comparer.html#cb177-28" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">6</span>     cheval    <span class="dv">10</span>    <span class="dv">10</span></span>
<span id="cb177-29"><a href="comparer.html#cb177-29" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">7</span>  chevalier    <span class="dv">12</span>    <span class="dv">12</span></span>
<span id="cb177-30"><a href="comparer.html#cb177-30" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">8</span>  chevalier    <span class="dv">17</span>    <span class="dv">17</span></span>
<span id="cb177-31"><a href="comparer.html#cb177-31" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">9</span>      chien    <span class="dv">21</span>    <span class="dv">21</span></span>
<span id="cb177-32"><a href="comparer.html#cb177-32" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">10</span>     chien    <span class="dv">18</span>    <span class="dv">18</span></span></code></pre></div>
<p>L’expression <code>X %*% mu</code> est une multiplication d’algèbre matricielle qui multiplie la matrice <span class="math inline">\(n \times p\)</span> de codage factice <span class="math inline">\(X\)</span> à une matrice <span class="math inline">\(p\times 1\)</span> de moyennes <span class="math inline">\(\mu\)</span>. L’opération multiple les <span class="math inline">\(p\)</span> éléments d’une ligne de <span class="math inline">\(X\)</span> à la colonne <span class="math inline">\(p\)</span> correspondante de <span class="math inline">\(\mu\)</span>. En algèbre matricielle Le résultat est une matrice <span class="math inline">\(n \times 1\)</span> qui contient les différences de moyennes pour chaque unité. Dans la même ligne de syntaxe, la moyenne de la population (groupe référent), <span class="math inline">\(\mu_0\)</span> est ajoutée et la variation individuelle, <span class="math inline">\(\epsilon\)</span>.</p>
<p>Les scores produits sont identiques. Dans cet exemple par contre, l’origine des différences entre groupes est plus évidente, spécialement en comparant le modèle sous-jacent à l’analyse de variance. La source d’erreur est visible ainsi que les différences de moyennes. La force de cette deuxième méthode est qu’elle peut facilement être automatisée pour créer des jeux de données, alors que la première est plus compliquée. La seconde méthode nécessite six arguments (<span class="math inline">\(n_k\)</span>, <span class="math inline">\(\mu_0\)</span>, <span class="math inline">\(\mu_{1:k}\)</span>, et <span class="math inline">\(\sigma_{e}\)</span> en plus de catégories et définir le groupe référent), la première aurait de la difficulté à spécifier tous les arrangements de différence de moyennes automatiquement, quoiqu’elles sont plus personnalisables.</p>
</div>
<div id="analyse" class="section level2" number="13.4">
<h2>
<span class="header-section-number">13.4</span> Analyse<a class="anchor" aria-label="anchor" href="#analyse"><i class="fas fa-link"></i></a>
</h2>
<p>À toute fin pratique, un jeu de données est recréé avec les catégories et paramètres précédents, mais avec <span class="math inline">\(n_k=20\)</span> unités par groupe. La fonction <strong>R</strong> de base est <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>. Elle prend comme argument une formule, de forme <code>VD ~ VI</code> (variable dépendante prédite par variable indépendante) et un jeu de données duquel prendre les variables. Il existe également une fonction <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code>, une fonction un peu plus complexe que <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>. Pour obtenir toute l’information désirée de la sortie de la fonction, il faut demander un sommaire de la sortie avec <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="comparer.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Anova de base</span></span>
<span id="cb178-2"><a href="comparer.html#cb178-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">aov</span>(score <span class="sc">~</span> groupe, <span class="at">data =</span> donnees)</span>
<span id="cb178-3"><a href="comparer.html#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span>
<span id="cb178-4"><a href="comparer.html#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>             Df Sum Sq Mean Sq F value  <span class="fu">Pr</span>(<span class="sc">&gt;</span>F)    </span>
<span id="cb178-5"><a href="comparer.html#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> groupe       <span class="dv">4</span>    <span class="dv">834</span>   <span class="fl">208.4</span>      <span class="dv">14</span> <span class="fl">5.1e-09</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb178-6"><a href="comparer.html#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residuals   <span class="dv">95</span>   <span class="dv">1414</span>    <span class="fl">14.9</span>                    </span>
<span id="cb178-7"><a href="comparer.html#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb178-8"><a href="comparer.html#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Signif. codes<span class="sc">:</span>  </span>
<span id="cb178-9"><a href="comparer.html#cb178-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="dv">0</span> <span class="st">'***'</span> <span class="fl">0.001</span> <span class="st">'**'</span> <span class="fl">0.01</span> <span class="st">'*'</span> <span class="fl">0.05</span> <span class="st">'.'</span> <span class="fl">0.1</span> <span class="st">' '</span> <span class="dv">1</span></span>
<span id="cb178-10"><a href="comparer.html#cb178-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-11"><a href="comparer.html#cb178-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction maison</span></span>
<span id="cb178-12"><a href="comparer.html#cb178-12" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">table</span>(donnees<span class="sc">$</span>groupe)</span>
<span id="cb178-13"><a href="comparer.html#cb178-13" aria-hidden="true" tabindex="-1"></a>k  <span class="ot">&lt;-</span> <span class="fu">length</span>(gr)          <span class="co"># Nombre de groupes</span></span>
<span id="cb178-14"><a href="comparer.html#cb178-14" aria-hidden="true" tabindex="-1"></a>nk <span class="ot">&lt;-</span> <span class="fu">dim</span>(donnees)[<span class="dv">1</span>] <span class="sc">/</span> k <span class="co"># Nombre de participants par groupe</span></span>
<span id="cb178-15"><a href="comparer.html#cb178-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-16"><a href="comparer.html#cb178-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Moyennes et variance par (`by()`) groupes</span></span>
<span id="cb178-17"><a href="comparer.html#cb178-17" aria-hidden="true" tabindex="-1"></a>moyenne  <span class="ot">&lt;-</span> <span class="fu">by</span>(donnees<span class="sc">$</span>score, donnees<span class="sc">$</span>groupe, mean)</span>
<span id="cb178-18"><a href="comparer.html#cb178-18" aria-hidden="true" tabindex="-1"></a>variance <span class="ot">&lt;-</span> <span class="fu">by</span>(donnees<span class="sc">$</span>score, donnees<span class="sc">$</span>groupe, var)</span>
<span id="cb178-19"><a href="comparer.html#cb178-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-20"><a href="comparer.html#cb178-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistiques</span></span>
<span id="cb178-21"><a href="comparer.html#cb178-21" aria-hidden="true" tabindex="-1"></a>CMI <span class="ot">&lt;-</span> nk <span class="sc">*</span> <span class="fu">var</span>(moyenne)</span>
<span id="cb178-22"><a href="comparer.html#cb178-22" aria-hidden="true" tabindex="-1"></a>CMR <span class="ot">&lt;-</span> <span class="fu">mean</span>(variance)</span>
<span id="cb178-23"><a href="comparer.html#cb178-23" aria-hidden="true" tabindex="-1"></a>dl1 <span class="ot">&lt;-</span> k <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb178-24"><a href="comparer.html#cb178-24" aria-hidden="true" tabindex="-1"></a>dl2 <span class="ot">&lt;-</span> k <span class="sc">*</span> (nk <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb178-25"><a href="comparer.html#cb178-25" aria-hidden="true" tabindex="-1"></a>vf <span class="ot">&lt;-</span> CMI <span class="sc">/</span> CMR </span>
<span id="cb178-26"><a href="comparer.html#cb178-26" aria-hidden="true" tabindex="-1"></a>vp <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(vf, <span class="at">df1 =</span> dl1, <span class="at">df2 =</span> dl2)) </span>
<span id="cb178-27"><a href="comparer.html#cb178-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-28"><a href="comparer.html#cb178-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Création du tableau</span></span>
<span id="cb178-29"><a href="comparer.html#cb178-29" aria-hidden="true" tabindex="-1"></a>resultats <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">5</span>) <span class="co"># Tableau vide</span></span>
<span id="cb178-30"><a href="comparer.html#cb178-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-31"><a href="comparer.html#cb178-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter noms</span></span>
<span id="cb178-32"><a href="comparer.html#cb178-32" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(resultats)  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dl"</span>, <span class="st">"SS"</span>, <span class="st">"CM"</span>, <span class="st">"F"</span>, <span class="st">"p"</span>)</span>
<span id="cb178-33"><a href="comparer.html#cb178-33" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(resultats) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"groupe"</span>, <span class="st">"residu"</span>)</span>
<span id="cb178-34"><a href="comparer.html#cb178-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-35"><a href="comparer.html#cb178-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter valeurs</span></span>
<span id="cb178-36"><a href="comparer.html#cb178-36" aria-hidden="true" tabindex="-1"></a>resultats[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(dl1, CMI <span class="sc">*</span> dl1, CMI, vf, vp)</span>
<span id="cb178-37"><a href="comparer.html#cb178-37" aria-hidden="true" tabindex="-1"></a>resultats[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(dl2, CMR <span class="sc">*</span> dl2, CMR, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb178-38"><a href="comparer.html#cb178-38" aria-hidden="true" tabindex="-1"></a>resultats</span>
<span id="cb178-39"><a href="comparer.html#cb178-39" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>        dl   SS    CM  F        p</span>
<span id="cb178-40"><a href="comparer.html#cb178-40" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> groupe  <span class="dv">4</span>  <span class="dv">834</span> <span class="fl">208.4</span> <span class="dv">14</span> <span class="fl">5.15e-09</span></span>
<span id="cb178-41"><a href="comparer.html#cb178-41" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> residu <span class="dv">95</span> <span class="dv">1414</span>  <span class="fl">14.9</span>  <span class="dv">0</span> <span class="fl">0.00e+00</span></span></code></pre></div>
<p>Les résultats sont identiques, les seules différences étant dues à l’arrondissement. Comme la valeur-<span class="math inline">\(p\)</span> est de 5.145^{-9}, ce qui est extrêmement plus petit que l’usuel .05 (ou un autre taux d’erreur de type I fixé à l’avance), l’hypothèse nulle est rejetée, il y a vraisemblablement une différence entre les groupes, ce qui est déjà connu. La Figure <a href="comparer.html#fig:ft">13.1</a> illustre très bien la rareté d’un tel jeu de données sous l’hypothèse nulle.</p>
<div class="figure">
<span style="display:block;" id="fig:ft"></span>
<img src="13-Comparer_files/figure-html/ft-1.png" alt="Valeur-$F$ de la comparaison des moyennes" width="672"><p class="caption">
Figure 13.1: Valeur-<span class="math inline">\(F\)</span> de la comparaison des moyennes
</p>
</div>
</div>
<div id="rapporter-lanova" class="section level2" number="13.5">
<h2>
<span class="header-section-number">13.5</span> Rapporter l’ANOVA<a class="anchor" aria-label="anchor" href="#rapporter-lanova"><i class="fas fa-link"></i></a>
</h2>
<p>Voici comment commander une anova avec <strong>R</strong>. Il faut utilise la formule, <code>VD ~ VI</code> où la VD est la variable dépendante qui est d’échelle continue, la ou les VI, les variables indépendantes, contiennent les variables de groupement, mais aussi des variables continues, si besoin est.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="comparer.html#cb179-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">aov</span>(score <span class="sc">~</span> groupe, <span class="at">data =</span> donnees)</span>
<span id="cb179-2"><a href="comparer.html#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res)</span>
<span id="cb179-3"><a href="comparer.html#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>             Df Sum Sq Mean Sq F value  <span class="fu">Pr</span>(<span class="sc">&gt;</span>F)    </span>
<span id="cb179-4"><a href="comparer.html#cb179-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> groupe       <span class="dv">4</span>    <span class="dv">834</span>   <span class="fl">208.4</span>      <span class="dv">14</span> <span class="fl">5.1e-09</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb179-5"><a href="comparer.html#cb179-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residuals   <span class="dv">95</span>   <span class="dv">1414</span>    <span class="fl">14.9</span>                    </span>
<span id="cb179-6"><a href="comparer.html#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb179-7"><a href="comparer.html#cb179-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Signif. codes<span class="sc">:</span>  </span>
<span id="cb179-8"><a href="comparer.html#cb179-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="dv">0</span> <span class="st">'***'</span> <span class="fl">0.001</span> <span class="st">'**'</span> <span class="fl">0.01</span> <span class="st">'*'</span> <span class="fl">0.05</span> <span class="st">'.'</span> <span class="fl">0.1</span> <span class="st">' '</span> <span class="dv">1</span></span></code></pre></div>
<p>Voici comment rapporter l’ANOVA dans un article scientifique.</p>
<blockquote>
<p>Une ANOVA est réalisée pour comparer les groupes sur un certain score. Les résutats montrent une différence significative (pour un <span class="math inline">\(\alpha = .05\)</span>), <span class="math inline">\(F(4, 95) = 13.998, p &lt; .001\)</span>.</p>
</blockquote>
<div id="la-sortie-de-aov" class="section level3" number="13.5.1">
<h3>
<span class="header-section-number">13.5.1</span> La sortie de <code>aov()</code><a class="anchor" aria-label="anchor" href="#la-sortie-de-aov"><i class="fas fa-link"></i></a>
</h3>
<p>Une petite digression pour parler de la sortie de <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>. Normalement, <strong>R</strong> produit [des listes][Créer des listes] comme sortie, particulièrement en ce qui a trait aux analyses statistiques. Le cas de <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> est différent : le sommaire est une liste vide.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="comparer.html#cb180-1" aria-hidden="true" tabindex="-1"></a>sommaire <span class="ot">&lt;-</span> <span class="fu">summary</span>(res)</span>
<span id="cb180-2"><a href="comparer.html#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les éléments de la sortie `sommaire`</span></span>
<span id="cb180-3"><a href="comparer.html#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sommaire)</span>
<span id="cb180-4"><a href="comparer.html#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="cn">NULL</span></span></code></pre></div>
<p>Pour avoir accès directement au tableau de résultats du sommaire pour le manipuler, il faut ajouter <code>[[1]]</code> à la suite du code, ce qui permet d’atteindre les résultats. Les manipulations usuelles d’une liste sont maintenant réalisables.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="comparer.html#cb181-1" aria-hidden="true" tabindex="-1"></a>sommaire <span class="ot">&lt;-</span> <span class="fu">summary</span>(res)[[<span class="dv">1</span>]]</span>
<span id="cb181-2"><a href="comparer.html#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(sommaire)</span>
<span id="cb181-3"><a href="comparer.html#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="st">"Df"</span>      <span class="st">"Sum Sq"</span>  <span class="st">"Mean Sq"</span> <span class="st">"F value"</span> <span class="st">"Pr(&gt;F)"</span></span></code></pre></div>
<p>Le symbole <code>[[1]]</code> indique que seulement le premier élément de la liste est désiré. Il s’agit d’une formule renforcée <a href="programmer.html#r%C3%A9f%C3%A9rer-%C3%A0-des-sous-%C3%A9l%C3%A9ments">des crochets</a> pour ne choisir qu’un seul élément de la liste. Et dans cette liste, on retrouve la liste contenant des résultats. En d’autres termes, la sortie de <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> est une liste. Il y a bien deux niveaux de liste dans cette sortie, la première rendant plus difficile à la seconde. Une petit idiosyncrasie de <strong>R</strong>.</p>
</div>
</div>
<div id="les-tests-posthoc" class="section level2" number="13.6">
<h2>
<span class="header-section-number">13.6</span> Les tests posthoc<a class="anchor" aria-label="anchor" href="#les-tests-posthoc"><i class="fas fa-link"></i></a>
</h2>
<p>Une fois que le test général montre une différence à laquelle l’expérimentateur juge pertinent de s’y pencher<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Pour ne pas dire &lt;em&gt;significative&lt;/em&gt;&lt;/p&gt;"><sup>14</sup></a>, ce dernier désire généralement connaître d’où origine cette différence globale entre les groupes. Autrement, il cherche à identifier spécifiquement les groupes qui diffère des autres.</p>
<p>La première étape est évidement de rouler l’ANOVA globale, voir la section précédente <a href="comparer.html#rapporter-lanova">Rapporter l’ANOVA</a>. En deuxième étape, une façon simple de demander les comparaisons posthoc est d’utiliser la fonction <code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code>, soit la différence significative honnête, ou plus simplement la méthode de Tukey, en y introduisant comme argument la sortie de l’ANOVA.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="comparer.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(res)</span>
<span id="cb182-2"><a href="comparer.html#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>   Tukey multiple comparisons of means</span>
<span id="cb182-3"><a href="comparer.html#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>     <span class="dv">95</span>% family<span class="sc">-</span>wise confidence level</span>
<span id="cb182-4"><a href="comparer.html#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb182-5"><a href="comparer.html#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Fit<span class="sc">:</span> <span class="fu">aov</span>(<span class="at">formula =</span> score <span class="sc">~</span> groupe, <span class="at">data =</span> donnees)</span>
<span id="cb182-6"><a href="comparer.html#cb182-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb182-7"><a href="comparer.html#cb182-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>groupe</span>
<span id="cb182-8"><a href="comparer.html#cb182-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>                   diff     lwr   upr p adj</span>
<span id="cb182-9"><a href="comparer.html#cb182-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> chat<span class="sc">-</span>char         <span class="fl">4.45</span>   <span class="fl">1.057</span>  <span class="fl">7.84</span> <span class="fl">0.004</span></span>
<span id="cb182-10"><a href="comparer.html#cb182-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> cheval<span class="sc">-</span>char      <span class="sc">-</span><span class="fl">4.55</span>  <span class="sc">-</span><span class="fl">7.943</span> <span class="sc">-</span><span class="fl">1.16</span> <span class="fl">0.003</span></span>
<span id="cb182-11"><a href="comparer.html#cb182-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> chevalier<span class="sc">-</span>char   <span class="sc">-</span><span class="fl">1.05</span>  <span class="sc">-</span><span class="fl">4.443</span>  <span class="fl">2.34</span> <span class="fl">0.910</span></span>
<span id="cb182-12"><a href="comparer.html#cb182-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> chien<span class="sc">-</span>char       <span class="sc">-</span><span class="fl">1.00</span>  <span class="sc">-</span><span class="fl">4.393</span>  <span class="fl">2.39</span> <span class="fl">0.924</span></span>
<span id="cb182-13"><a href="comparer.html#cb182-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> cheval<span class="sc">-</span>chat      <span class="sc">-</span><span class="fl">9.00</span> <span class="sc">-</span><span class="fl">12.393</span> <span class="sc">-</span><span class="fl">5.61</span> <span class="fl">0.000</span></span>
<span id="cb182-14"><a href="comparer.html#cb182-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> chevalier<span class="sc">-</span>chat   <span class="sc">-</span><span class="fl">5.50</span>  <span class="sc">-</span><span class="fl">8.893</span> <span class="sc">-</span><span class="fl">2.11</span> <span class="fl">0.000</span></span>
<span id="cb182-15"><a href="comparer.html#cb182-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> chien<span class="sc">-</span>chat       <span class="sc">-</span><span class="fl">5.45</span>  <span class="sc">-</span><span class="fl">8.843</span> <span class="sc">-</span><span class="fl">2.06</span> <span class="fl">0.000</span></span>
<span id="cb182-16"><a href="comparer.html#cb182-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> chevalier<span class="sc">-</span>cheval  <span class="fl">3.50</span>   <span class="fl">0.107</span>  <span class="fl">6.89</span> <span class="fl">0.040</span></span>
<span id="cb182-17"><a href="comparer.html#cb182-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> chien<span class="sc">-</span>cheval      <span class="fl">3.55</span>   <span class="fl">0.157</span>  <span class="fl">6.94</span> <span class="fl">0.036</span></span>
<span id="cb182-18"><a href="comparer.html#cb182-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> chien<span class="sc">-</span>chevalier   <span class="fl">0.05</span>  <span class="sc">-</span><span class="fl">3.343</span>  <span class="fl">3.44</span> <span class="fl">1.000</span></span></code></pre></div>
<p>Dans cette sortie, chaque paire de groupes est indiquer à gauche, les différences et les intervalles de confiance sont produites. La dernière colonnes (<code>p adj</code>) contient la valeur-<span class="math inline">\(p\)</span> indiquant si la paire est significativement différente ou non. Par exemple, la première ligne porte sur la comparaison <code>chat-char</code> et ces deux groupes sont vraisemblablement différents avec une valeur-<span class="math inline">\(p\)</span> de 0.004. Il est possible de définir différents arguments, comme l’ordre des paires avec <code>ordered = TRUE</code> qui ordonne les moyennes des groupes de la plus petite à la plus grandes, ou encore le degré de confiance <code>conf.level = 0.95</code> par défaut. Enfin, il est possible de sélectionner spécifiquement la variable de groupement avec l’argument <code>which</code>.</p>
<p>La fonction <code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code> est aussi lié à une figure qu’il est possible de commander avec <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> en y mettant comme argument la sortie de <code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code>.</p>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tukey"></span>
<img src="13-Comparer_files/figure-html/tukey-1.png" alt="Illustration du test de comparaisons multiples de Tukey" width="50%" height="50%"><p class="caption">
Figure 13.2: Illustration du test de comparaisons multiples de Tukey
</p>
</div>
<p>Malheureusement la Figure <a href="comparer.html#fig:tukey">13.2</a> n’est pas parfaite, car elle n’affiche pas toutes les libellées de chaque ligne. Toutefois, chaque ligne de la Figure <a href="comparer.html#fig:tukey">13.2</a> correspond à une ligne de la figure. Avec le package <code>ggplot2</code>(voir [Visualier]), il est possible de remédier à la situation.</p>
<p>D’abord, il faut importer le <code>tidyverse</code>. Ensuite, la prochaine étape consiste à extraire les résultats de <code><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD()</a></code>, de les transformer en jeu de données avec <code><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame()</a></code> et de rendre le nom des lignes manipulables avec <code>add_rownames_to_column()</code>. Comme pour toutes les figures, il faut indiquer l’abscisse et l’ordonnée, ici le nom des lignes (<code>x</code>) et la différence entre les groupes(<code>y</code>), respectivement. Ensuite, comme la figure avec <a href="visualiser.html#les-barres-derreurs">les barres d’erreurs</a>, il faut associer dans <code>geom_errorbar</code> les intervalles de confiance <code>lwr</code> et <code>upr</code> à <code>ymin</code> et <code>ymax</code>. Enfin, il est possible d’ajouter la moyenne sous forme de point (<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> et de tourner la figure avec <code>coord_flip</code>, ce qui permet de répliquer la figure originale.</p>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>   <span class="co"># Extraire les résultats</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>    <span class="co"># Transformer en jeu de données</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>     <span class="co"># Ajouter les noms des lignes</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rowname</span>, </span>
<span>                       y <span class="op">=</span> <span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lwr</span>,</span>
<span>                    ymax <span class="op">=</span> <span class="va">upr</span><span class="op">)</span>,</span>
<span>                width <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tukey2"></span>
<img src="13-Comparer_files/figure-html/tukey2-1.png" alt="Illustration corrigée du test de comparaisons multiples de Tukey" width="50%" height="50%"><p class="caption">
Figure 13.3: Illustration corrigée du test de comparaisons multiples de Tukey
</p>
</div>
<p>La Figure <a href="comparer.html#fig:tukey2">13.3</a> montre une illustration des comparaisons de Tukey plus adéquate.</p>
<p>Une autre technique permet d’obtenir une table de comparaisons. Il s’agit de <code><a href="https://rdrr.io/r/stats/pairwise.t.test.html">pairwise.t.test()</a></code>. Cette fonction prend en argument deux vecteurs, la variable continue et la variable de groupement, et un troisième argument, soit la correction à appliquer avec l’argument <code>p.adj</code>.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="comparer.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(donnees<span class="sc">$</span>score, donnees<span class="sc">$</span>groupe, <span class="at">p.adj =</span> <span class="st">"none"</span>)</span>
<span id="cb185-2"><a href="comparer.html#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb185-3"><a href="comparer.html#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Pairwise comparisons using t tests with pooled SD </span>
<span id="cb185-4"><a href="comparer.html#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb185-5"><a href="comparer.html#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> data<span class="sc">:</span>  donnees<span class="sc">$</span>score and donnees<span class="sc">$</span>groupe </span>
<span id="cb185-6"><a href="comparer.html#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb185-7"><a href="comparer.html#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>           char  chat  cheval chevalier</span>
<span id="cb185-8"><a href="comparer.html#cb185-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> chat      <span class="fl">4e-04</span> <span class="sc">-</span>     <span class="sc">-</span>      <span class="sc">-</span>        </span>
<span id="cb185-9"><a href="comparer.html#cb185-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> cheval    <span class="fl">3e-04</span> <span class="fl">6e-11</span> <span class="sc">-</span>      <span class="sc">-</span>        </span>
<span id="cb185-10"><a href="comparer.html#cb185-10" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> chevalier <span class="fl">0.392</span> <span class="fl">2e-05</span> <span class="fl">0.005</span>  <span class="sc">-</span>        </span>
<span id="cb185-11"><a href="comparer.html#cb185-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> chien     <span class="fl">0.415</span> <span class="fl">2e-05</span> <span class="fl">0.005</span>  <span class="fl">0.967</span>    </span>
<span id="cb185-12"><a href="comparer.html#cb185-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb185-13"><a href="comparer.html#cb185-13" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> P value adjustment method<span class="sc">:</span> none</span></code></pre></div>
<p>Cette technique à l’avantage d’être prête pour la plupart corrections, par exemple <code>p.adj = "bonferroni"</code> ou <code>p.adj = "holm"</code>.</p>
<p>TODO</p>
</div>
<div id="anova-à-mesures-répétées" class="section level2" number="13.7">
<h2>
<span class="header-section-number">13.7</span> ANOVA à mesures répétées<a class="anchor" aria-label="anchor" href="#anova-%C3%A0-mesures-r%C3%A9p%C3%A9t%C3%A9es"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="comparer.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Un exemple d'ANOVA à mesures répétées</span></span>
<span id="cb186-2"><a href="comparer.html#cb186-2" aria-hidden="true" tabindex="-1"></a>res.aov.r <span class="ot">&lt;-</span> <span class="fu">aov</span>(circumference <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">Error</span>(Tree<span class="sc">/</span>age), <span class="at">data =</span> Orange)</span>
<span id="cb186-3"><a href="comparer.html#cb186-3" aria-hidden="true" tabindex="-1"></a>res.aov.r</span>
<span id="cb186-4"><a href="comparer.html#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb186-5"><a href="comparer.html#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Call<span class="sc">:</span></span>
<span id="cb186-6"><a href="comparer.html#cb186-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">aov</span>(<span class="at">formula =</span> circumference <span class="sc">~</span> age <span class="sc">+</span> <span class="fu">Error</span>(Tree<span class="sc">/</span>age), <span class="at">data =</span> Orange)</span>
<span id="cb186-7"><a href="comparer.html#cb186-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb186-8"><a href="comparer.html#cb186-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Grand Mean<span class="sc">:</span> <span class="dv">116</span></span>
<span id="cb186-9"><a href="comparer.html#cb186-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb186-10"><a href="comparer.html#cb186-10" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Stratum <span class="dv">1</span><span class="sc">:</span> Tree</span>
<span id="cb186-11"><a href="comparer.html#cb186-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb186-12"><a href="comparer.html#cb186-12" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Terms<span class="sc">:</span></span>
<span id="cb186-13"><a href="comparer.html#cb186-13" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>                 Residuals</span>
<span id="cb186-14"><a href="comparer.html#cb186-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Sum of Squares      <span class="dv">11841</span></span>
<span id="cb186-15"><a href="comparer.html#cb186-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Deg. of Freedom         <span class="dv">4</span></span>
<span id="cb186-16"><a href="comparer.html#cb186-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb186-17"><a href="comparer.html#cb186-17" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residual standard error<span class="sc">:</span> <span class="fl">54.4</span></span>
<span id="cb186-18"><a href="comparer.html#cb186-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb186-19"><a href="comparer.html#cb186-19" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Stratum <span class="dv">2</span><span class="sc">:</span> Tree<span class="sc">:</span>age</span>
<span id="cb186-20"><a href="comparer.html#cb186-20" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb186-21"><a href="comparer.html#cb186-21" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Terms<span class="sc">:</span></span>
<span id="cb186-22"><a href="comparer.html#cb186-22" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>                   age Residuals</span>
<span id="cb186-23"><a href="comparer.html#cb186-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Sum of Squares  <span class="dv">93772</span>      <span class="dv">4043</span></span>
<span id="cb186-24"><a href="comparer.html#cb186-24" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Deg. of Freedom     <span class="dv">1</span>         <span class="dv">4</span></span>
<span id="cb186-25"><a href="comparer.html#cb186-25" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb186-26"><a href="comparer.html#cb186-26" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residual standard error<span class="sc">:</span> <span class="fl">31.8</span></span>
<span id="cb186-27"><a href="comparer.html#cb186-27" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Estimated effects are balanced</span>
<span id="cb186-28"><a href="comparer.html#cb186-28" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb186-29"><a href="comparer.html#cb186-29" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Stratum <span class="dv">3</span><span class="sc">:</span> Within</span>
<span id="cb186-30"><a href="comparer.html#cb186-30" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb186-31"><a href="comparer.html#cb186-31" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Terms<span class="sc">:</span></span>
<span id="cb186-32"><a href="comparer.html#cb186-32" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>                 Residuals</span>
<span id="cb186-33"><a href="comparer.html#cb186-33" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Sum of Squares       <span class="dv">2711</span></span>
<span id="cb186-34"><a href="comparer.html#cb186-34" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Deg. of Freedom        <span class="dv">25</span></span>
<span id="cb186-35"><a href="comparer.html#cb186-35" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb186-36"><a href="comparer.html#cb186-36" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residual standard error<span class="sc">:</span> <span class="fl">10.4</span></span>
<span id="cb186-37"><a href="comparer.html#cb186-37" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res.aov.r)</span>
<span id="cb186-38"><a href="comparer.html#cb186-38" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb186-39"><a href="comparer.html#cb186-39" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Error<span class="sc">:</span> Tree</span>
<span id="cb186-40"><a href="comparer.html#cb186-40" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>           Df Sum Sq Mean Sq F value <span class="fu">Pr</span>(<span class="sc">&gt;</span>F)</span>
<span id="cb186-41"><a href="comparer.html#cb186-41" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Residuals  <span class="dv">4</span>  <span class="dv">11841</span>    <span class="dv">2960</span>               </span>
<span id="cb186-42"><a href="comparer.html#cb186-42" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb186-43"><a href="comparer.html#cb186-43" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Error<span class="sc">:</span> Tree<span class="sc">:</span>age</span>
<span id="cb186-44"><a href="comparer.html#cb186-44" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>           Df Sum Sq Mean Sq F value  <span class="fu">Pr</span>(<span class="sc">&gt;</span>F)    </span>
<span id="cb186-45"><a href="comparer.html#cb186-45" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> age        <span class="dv">1</span>  <span class="dv">93772</span>   <span class="dv">93772</span>    <span class="fl">92.8</span> <span class="fl">0.00065</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb186-46"><a href="comparer.html#cb186-46" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residuals  <span class="dv">4</span>   <span class="dv">4043</span>    <span class="dv">1011</span>                    </span>
<span id="cb186-47"><a href="comparer.html#cb186-47" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb186-48"><a href="comparer.html#cb186-48" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Signif. codes<span class="sc">:</span>  </span>
<span id="cb186-49"><a href="comparer.html#cb186-49" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="dv">0</span> <span class="st">'***'</span> <span class="fl">0.001</span> <span class="st">'**'</span> <span class="fl">0.01</span> <span class="st">'*'</span> <span class="fl">0.05</span> <span class="st">'.'</span> <span class="fl">0.1</span> <span class="st">' '</span> <span class="dv">1</span></span>
<span id="cb186-50"><a href="comparer.html#cb186-50" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb186-51"><a href="comparer.html#cb186-51" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Error<span class="sc">:</span> Within</span>
<span id="cb186-52"><a href="comparer.html#cb186-52" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>           Df Sum Sq Mean Sq F value <span class="fu">Pr</span>(<span class="sc">&gt;</span>F)</span>
<span id="cb186-53"><a href="comparer.html#cb186-53" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Residuals <span class="dv">25</span>   <span class="dv">2711</span>     <span class="dv">108</span></span></code></pre></div>
<!-- ## Anova avec facteur intersujet et intrasujet -->
<!-- ```{r} -->
<!-- jd <- data.frame( -->
<!--   Sujet = factor(rep(1:10, each = 4)),             # 10 sujets, chacun mesuré 4 fois -->
<!--   Facteur_Intersujet = factor(rep(c("A", "B"), each = 20)),  # Facteur intersujet (A et B) -->
<!--   Facteur_Intrasujet = factor(rep(c("T1", "T2"), times = 10)), # Facteur intrasujet (T1 et T2) -->
<!--   Reponse = rnorm(40)                              # Variable de réponse simulée -->
<!-- ) -->
<!-- model <- aov(Reponse ~ Facteur_Intersujet * Facteur_Intrasujet +  -->
<!--              Error(Sujet/Facteur_Intrasujet), data = jd) -->
<!-- # Afficher les résultats -->
<!-- summary(model) -->
<!-- ``` -->
</div>
<div id="manova-analyse-de-variance-multivariée" class="section level2" number="13.8">
<h2>
<span class="header-section-number">13.8</span> MANOVA : analyse de variance multivariée<a class="anchor" aria-label="anchor" href="#manova-analyse-de-variance-multivari%C3%A9e"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="comparer.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Un example d'ANOVA multivarié</span></span>
<span id="cb187-2"><a href="comparer.html#cb187-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-3"><a href="comparer.html#cb187-3" aria-hidden="true" tabindex="-1"></a>res.maov <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">cbind</span>(Sepal.Length, Petal.Length) <span class="sc">~</span> Species, <span class="at">data =</span> iris)</span>
<span id="cb187-4"><a href="comparer.html#cb187-4" aria-hidden="true" tabindex="-1"></a>res.maov</span>
<span id="cb187-5"><a href="comparer.html#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Call<span class="sc">:</span></span>
<span id="cb187-6"><a href="comparer.html#cb187-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>    <span class="fu">manova</span>(<span class="fu">cbind</span>(Sepal.Length, Petal.Length) <span class="sc">~</span> Species, <span class="at">data =</span> iris)</span>
<span id="cb187-7"><a href="comparer.html#cb187-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb187-8"><a href="comparer.html#cb187-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Terms<span class="sc">:</span></span>
<span id="cb187-9"><a href="comparer.html#cb187-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>                 Species Residuals</span>
<span id="cb187-10"><a href="comparer.html#cb187-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Sepal.Length         <span class="dv">63</span>        <span class="dv">39</span></span>
<span id="cb187-11"><a href="comparer.html#cb187-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Petal.Length        <span class="dv">437</span>        <span class="dv">27</span></span>
<span id="cb187-12"><a href="comparer.html#cb187-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Deg. of Freedom       <span class="dv">2</span>       <span class="dv">147</span></span>
<span id="cb187-13"><a href="comparer.html#cb187-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb187-14"><a href="comparer.html#cb187-14" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residual standard errors<span class="sc">:</span> <span class="fl">0.515</span> <span class="fl">0.43</span></span>
<span id="cb187-15"><a href="comparer.html#cb187-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Estimated effects may be unbalanced</span>
<span id="cb187-16"><a href="comparer.html#cb187-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(res.maov)</span>
<span id="cb187-17"><a href="comparer.html#cb187-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>            Df Pillai approx F num Df den Df <span class="fu">Pr</span>(<span class="sc">&gt;</span>F)    </span>
<span id="cb187-18"><a href="comparer.html#cb187-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Species     <span class="dv">2</span>  <span class="fl">0.989</span>     <span class="fl">71.8</span>      <span class="dv">4</span>    <span class="dv">294</span> <span class="sc">&lt;</span><span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb187-19"><a href="comparer.html#cb187-19" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residuals <span class="dv">147</span>                                         </span>
<span id="cb187-20"><a href="comparer.html#cb187-20" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb187-21"><a href="comparer.html#cb187-21" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Signif. codes<span class="sc">:</span>  </span>
<span id="cb187-22"><a href="comparer.html#cb187-22" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="dv">0</span> <span class="st">'***'</span> <span class="fl">0.001</span> <span class="st">'**'</span> <span class="fl">0.01</span> <span class="st">'*'</span> <span class="fl">0.05</span> <span class="st">'.'</span> <span class="fl">0.1</span> <span class="st">' '</span> <span class="dv">1</span></span>
<span id="cb187-23"><a href="comparer.html#cb187-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-24"><a href="comparer.html#cb187-24" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(res.maov)</span>
<span id="cb187-25"><a href="comparer.html#cb187-25" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  Response Sepal.Length <span class="sc">:</span></span>
<span id="cb187-26"><a href="comparer.html#cb187-26" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>              Df Sum Sq Mean Sq F value <span class="fu">Pr</span>(<span class="sc">&gt;</span>F)    </span>
<span id="cb187-27"><a href="comparer.html#cb187-27" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Species       <span class="dv">2</span>   <span class="fl">63.2</span>   <span class="fl">31.61</span>     <span class="dv">119</span> <span class="sc">&lt;</span><span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb187-28"><a href="comparer.html#cb187-28" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residuals   <span class="dv">147</span>   <span class="fl">39.0</span>    <span class="fl">0.27</span>                   </span>
<span id="cb187-29"><a href="comparer.html#cb187-29" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb187-30"><a href="comparer.html#cb187-30" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Signif. codes<span class="sc">:</span>  </span>
<span id="cb187-31"><a href="comparer.html#cb187-31" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="dv">0</span> <span class="st">'***'</span> <span class="fl">0.001</span> <span class="st">'**'</span> <span class="fl">0.01</span> <span class="st">'*'</span> <span class="fl">0.05</span> <span class="st">'.'</span> <span class="fl">0.1</span> <span class="st">' '</span> <span class="dv">1</span></span>
<span id="cb187-32"><a href="comparer.html#cb187-32" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb187-33"><a href="comparer.html#cb187-33" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  Response Petal.Length <span class="sc">:</span></span>
<span id="cb187-34"><a href="comparer.html#cb187-34" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>              Df Sum Sq Mean Sq F value <span class="fu">Pr</span>(<span class="sc">&gt;</span>F)    </span>
<span id="cb187-35"><a href="comparer.html#cb187-35" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Species       <span class="dv">2</span>    <span class="dv">437</span>   <span class="fl">218.6</span>    <span class="dv">1180</span> <span class="sc">&lt;</span><span class="fl">2e-16</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb187-36"><a href="comparer.html#cb187-36" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Residuals   <span class="dv">147</span>     <span class="dv">27</span>     <span class="fl">0.2</span>                   </span>
<span id="cb187-37"><a href="comparer.html#cb187-37" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="sc">---</span></span>
<span id="cb187-38"><a href="comparer.html#cb187-38" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Signif. codes<span class="sc">:</span>  </span>
<span id="cb187-39"><a href="comparer.html#cb187-39" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="dv">0</span> <span class="st">'***'</span> <span class="fl">0.001</span> <span class="st">'**'</span> <span class="fl">0.01</span> <span class="st">'*'</span> <span class="fl">0.05</span> <span class="st">'.'</span> <span class="fl">0.1</span> <span class="st">' '</span> <span class="dv">1</span></span>
<span id="cb187-40"><a href="comparer.html#cb187-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-41"><a href="comparer.html#cb187-41" aria-hidden="true" tabindex="-1"></a>res.lda <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">lda</span>(Species <span class="sc">~</span> Sepal.Length <span class="sc">+</span> Petal.Length, <span class="at">data =</span> iris)</span>
<span id="cb187-42"><a href="comparer.html#cb187-42" aria-hidden="true" tabindex="-1"></a>res.lda </span>
<span id="cb187-43"><a href="comparer.html#cb187-43" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Call<span class="sc">:</span></span>
<span id="cb187-44"><a href="comparer.html#cb187-44" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">lda</span>(Species <span class="sc">~</span> Sepal.Length <span class="sc">+</span> Petal.Length, <span class="at">data =</span> iris)</span>
<span id="cb187-45"><a href="comparer.html#cb187-45" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb187-46"><a href="comparer.html#cb187-46" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Prior probabilities of groups<span class="sc">:</span></span>
<span id="cb187-47"><a href="comparer.html#cb187-47" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>     setosa versicolor  virginica </span>
<span id="cb187-48"><a href="comparer.html#cb187-48" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      <span class="fl">0.333</span>      <span class="fl">0.333</span>      <span class="fl">0.333</span> </span>
<span id="cb187-49"><a href="comparer.html#cb187-49" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb187-50"><a href="comparer.html#cb187-50" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Group means<span class="sc">:</span></span>
<span id="cb187-51"><a href="comparer.html#cb187-51" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>            Sepal.Length Petal.Length</span>
<span id="cb187-52"><a href="comparer.html#cb187-52" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> setosa             <span class="fl">5.01</span>         <span class="fl">1.46</span></span>
<span id="cb187-53"><a href="comparer.html#cb187-53" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> versicolor         <span class="fl">5.94</span>         <span class="fl">4.26</span></span>
<span id="cb187-54"><a href="comparer.html#cb187-54" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> virginica          <span class="fl">6.59</span>         <span class="fl">5.55</span></span>
<span id="cb187-55"><a href="comparer.html#cb187-55" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb187-56"><a href="comparer.html#cb187-56" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Coefficients of linear discriminants<span class="sc">:</span></span>
<span id="cb187-57"><a href="comparer.html#cb187-57" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>                LD1    LD2</span>
<span id="cb187-58"><a href="comparer.html#cb187-58" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Sepal.Length <span class="sc">-</span><span class="fl">1.66</span>  <span class="fl">2.462</span></span>
<span id="cb187-59"><a href="comparer.html#cb187-59" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Petal.Length  <span class="fl">3.43</span> <span class="sc">-</span><span class="fl">0.928</span></span>
<span id="cb187-60"><a href="comparer.html#cb187-60" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb187-61"><a href="comparer.html#cb187-61" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Proportion of trace<span class="sc">:</span></span>
<span id="cb187-62"><a href="comparer.html#cb187-62" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>    LD1    LD2 </span>
<span id="cb187-63"><a href="comparer.html#cb187-63" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fl">0.9987</span> <span class="fl">0.0013</span></span>
<span id="cb187-64"><a href="comparer.html#cb187-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-65"><a href="comparer.html#cb187-65" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(res.lda)</span></code></pre></div>
<div class="inline-figure"><img src="13-Comparer_files/figure-html/unnamed-chunk-16-1.png" width="672"></div>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># iris %&gt;% </span></span>
<span><span class="co">#   ggplot(mapping = aes(x = Sepal.Length,</span></span>
<span><span class="co">#                        y = Petal.Length, </span></span>
<span><span class="co">#                        color = Species)) + </span></span>
<span><span class="co">#            geom_point()</span></span></code></pre></div>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="exercice-analyse.html">Exercices</a></div>
<div class="next"><a href="pr%C3%A9dire.html"><span class="header-section-number">14</span> Prédire</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#comparer"><span class="header-section-number">13</span> Comparer</a></li>
<li><a class="nav-link" href="#la-logique-de-lanalyse-de-variance"><span class="header-section-number">13.1</span> La logique de l’analyse de variance</a></li>
<li><a class="nav-link" href="#la-cr%C3%A9ation-de-donn%C3%A9es"><span class="header-section-number">13.2</span> La création de données</a></li>
<li><a class="nav-link" href="#codage-factice"><span class="header-section-number">13.3</span> Codage factice</a></li>
<li><a class="nav-link" href="#analyse"><span class="header-section-number">13.4</span> Analyse</a></li>
<li>
<a class="nav-link" href="#rapporter-lanova"><span class="header-section-number">13.5</span> Rapporter l’ANOVA</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#la-sortie-de-aov"><span class="header-section-number">13.5.1</span> La sortie de aov()</a></li></ul>
</li>
<li><a class="nav-link" href="#les-tests-posthoc"><span class="header-section-number">13.6</span> Les tests posthoc</a></li>
<li><a class="nav-link" href="#anova-%C3%A0-mesures-r%C3%A9p%C3%A9t%C3%A9es"><span class="header-section-number">13.7</span> ANOVA à mesures répétées</a></li>
<li><a class="nav-link" href="#manova-analyse-de-variance-multivari%C3%A9e"><span class="header-section-number">13.8</span> MANOVA : analyse de variance multivariée</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/quantmeth/MQR/blob/master/13-Comparer.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/quantmeth/MQR/edit/master/13-Comparer.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Méthodes quantitatives avec R</strong>" was written by P.-O. Caron. It was last built on 2024-11-08.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
