<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 10 Inférer | Méthodes quantitatives avec R</title>
<meta name="author" content="P.-O. Caron">
<meta name="description" content="Le but principal de toute inférence statistique est de tirer des conclusions sur une population à partir d’un échantillon (un fragment beaucoup plus petit de la population). Comme il est rarement...">
<meta name="generator" content="bookdown 0.31 with bs4_book()">
<meta property="og:title" content=" 10 Inférer | Méthodes quantitatives avec R">
<meta property="og:type" content="book">
<meta property="og:url" content="mqr.teluq.ca/inférer.html">
<meta property="og:description" content="Le but principal de toute inférence statistique est de tirer des conclusions sur une population à partir d’un échantillon (un fragment beaucoup plus petit de la population). Comme il est rarement...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 10 Inférer | Méthodes quantitatives avec R">
<meta name="twitter:description" content="Le but principal de toute inférence statistique est de tirer des conclusions sur une population à partir d’un échantillon (un fragment beaucoup plus petit de la population). Comme il est rarement...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- 
    \(
    \newcommand{\EX}{\mathbb{E}}
    \)
    --><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Méthodes quantitatives avec R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bienvenue!</a></li>
<li><a class="" href="pr%C3%A9face.html">Préface</a></li>
<li class="book-part">Rudiments</li>
<li><a class="" href="commencer.html"><span class="header-section-number">1</span> Commencer</a></li>
<li><a class="" href="programmer.html"><span class="header-section-number">2</span> Programmer</a></li>
<li><a class="" href="calculer.html"><span class="header-section-number">3</span> Calculer</a></li>
<li><a class="" href="r%C3%A9diger.html"><span class="header-section-number">4</span> Rédiger</a></li>
<li><a class="" href="exercice-rudiments.html">Exercices</a></li>
<li class="book-part">Jeux de données</li>
<li><a class="" href="entrer.html"><span class="header-section-number">5</span> Entrer</a></li>
<li><a class="" href="importer.html"><span class="header-section-number">6</span> Importer</a></li>
<li><a class="" href="manipuler.html"><span class="header-section-number">7</span> Manipuler</a></li>
<li><a class="" href="visualiser.html"><span class="header-section-number">8</span> Visualiser</a></li>
<li><a class="" href="exercice-gestion.html">Exercices</a></li>
<li class="book-part">Statistiques</li>
<li><a class="" href="d%C3%A9crire.html"><span class="header-section-number">9</span> Décrire</a></li>
<li><a class="active" href="inf%C3%A9rer.html"><span class="header-section-number">10</span> Inférer</a></li>
<li><a class="" href="analyser.html"><span class="header-section-number">11</span> Analyser</a></li>
<li><a class="" href="simuler.html"><span class="header-section-number">12</span> Simuler</a></li>
<li><a class="" href="exercice-analyse.html">Exercices</a></li>
<li class="book-part">Modèles linéaires</li>
<li><a class="" href="comparer.html"><span class="header-section-number">13</span> Comparer</a></li>
<li><a class="" href="pr%C3%A9dire.html"><span class="header-section-number">14</span> Prédire</a></li>
<li><a class="" href="cr%C3%A9er.html"><span class="header-section-number">15</span> Créer</a></li>
<li><a class="" href="m%C3%A9dier.html"><span class="header-section-number">16</span> Médier</a></li>
<li><a class="" href="mod%C3%A9rer.html"><span class="header-section-number">17</span> Modérer</a></li>
<li><a class="" href="exercice-lineaire.html">Exercices</a></li>
<li class="book-part">Analyses factorielles</li>
<li><a class="" href="d%C3%A9composer.html"><span class="header-section-number">18</span> Décomposer</a></li>
<li><a class="" href="explorer.html"><span class="header-section-number">19</span> Explorer</a></li>
<li><a class="" href="r%C3%A9duire.html"><span class="header-section-number">20</span> Réduire</a></li>
<li class="book-part">Annexes</li>
<li><a class="" href="solutions.html">Solutions</a></li>
<li><a class="" href="r%C3%A9f%C3%A9rences.html">Références</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/quantmeth/MQR">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="inférer" class="section level1" number="10">
<h1>
<span class="header-section-number"> 10</span> Inférer<a class="anchor" aria-label="anchor" href="#inf%C3%A9rer"><i class="fas fa-link"></i></a>
</h1>
<p>Le but principal de toute inférence statistique est de tirer des conclusions sur une population à partir d’un échantillon (un fragment beaucoup plus petit de la population). Comme il est rarement possible de collecter des données sur l’ensemble de la population, l’expérimentateur choisi, idéalement, un échantillon représentatif tiré aléatoirement. Une fois l’échantillon recruté et mesuré, l’expérimentateur dérive des indices statistiques. Un <strong>indice</strong> statistique synthétise par une estimation basée sur l’échantillon de l’information sur le <strong>paramètre</strong> de la population. Cet indice possède un comportement, une distribution d’échantillonnage qui détermine les différentes valeurs qu’il peut prendre. En obtenant ces indices, l’expérimentateur tente de connaître le paramètre de la population. S’il s’intéresse à la relation entre l’anxiété et un cours de méthodes quantitatives, l’expérimentateur voudra savoir si cette relation n’est pas nulle, mais aussi sa force, en termes de tailles d’effet.</p>
<p>Cette tâche peut apparaître difficile considérant le peu d’informations sur la population, sa distribution de probabilité, les paramètres et la relative petite taille de l’échantillon par rapport à la population. Pour aider l’expérimentateur, les statisticiens ont le théorème central limite. Pour eux, il est certainement l’équivalent de la théorie de l’évolution pour le biologiste ou la théorie de la relativité générale pour le physicien. Ce théorème permet de connaître comment et sous quelles conditions se comportent les variables aléatoires.</p>
<div id="le-théorème-central-limite" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Le théorème central limite<a class="anchor" aria-label="anchor" href="#le-th%C3%A9or%C3%A8me-central-limite"><i class="fas fa-link"></i></a>
</h2>
<p>Les valeurs d’un échantillon sont, pour le statisticien, des variables aléatoires. Une variable aléatoire, c’est un peu comme piger dans une boîte à l’aveuglette pour obtenir une valeur. La boîte est impénétrable, personne ne sait par quel processus elle accorde telle ou telle autre valeur. Pour le statisticien, ce qui importe c’est que chaque valeur possède une chance égale aux autres d’être sélectionnée et qu’elles soient indépendantes entre elles (le fait d’en choisir une soit sans conséquence sur la probabilité des autres).</p>
<p>Pour le non-initié aux fonctions permettant de créer des nombres pseudoaléatoires, une fonction <strong>R</strong> comme <code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> ou <code><a href="https://rdrr.io/r/stats/Uniform.html">runif()</a></code> (<em>r</em> suivi d’un nom de distribution, voir <a href="calculer.html#les-distributions">Les distributions</a>) joue parfaitement le rôle de cette boîte. Si l’usager demande une valeur, la fonction retourne une valeur aléatoire (imprévisible à chaque fois) sans connaître comment cette valeur est produite.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="inf%C3%A9rer.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb114-2"><a href="inf%C3%A9rer.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.218</span></span></code></pre></div>
<p>Le statisticien s’intéresse à inférer comment ces valeurs sont générées. Il postule ainsi que les valeurs aléatoires suivent une distribution de probabilité. Connaître cette distribution est très important, car c’est elle qui permet de répondre à des questions comme : quelle est la probabilité d’obtenir un résultat aussi rare que <span class="math inline">\(x\)</span>? Ou quelle sont les valeurs attendues pour <span class="math inline">\(95\%\)</span> des tirages? Questions tout à fait pertinentes pour l’expérimentateur. Une des distributions les plus connues est certainement la distribution normale, celle qui est derrière la fonction <code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> d’ailleurs. Mais, il y en a beaucoup, beaucoup d’autres.</p>
<p>Lorsque plus d’une variable sont issues d’une même boîte (distribution), elles sont <em>identiquement distribuées</em>. Si ces variables aléatoires sont combinées, que ce soit en termes de produit, de quotient, d’addition, de soustraction, le résultat est une nouvelle variable aléatoire qui possède sa propre distribution nommée <em>distribution d’échantillonnage</em>. Sur le plan de la syntaxe <strong>R</strong>, il s’agit de réaliser des opérations mathématiques avec des variables aléatoires identiquement distribuées.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="inf%C3%A9rer.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour répliquer</span></span>
<span id="cb115-2"><a href="inf%C3%A9rer.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb115-3"><a href="inf%C3%A9rer.html#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="inf%C3%A9rer.html#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de deux variables identiquement distribuées</span></span>
<span id="cb115-5"><a href="inf%C3%A9rer.html#cb115-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb115-6"><a href="inf%C3%A9rer.html#cb115-6" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb115-7"><a href="inf%C3%A9rer.html#cb115-7" aria-hidden="true" tabindex="-1"></a>a ; b</span>
<span id="cb115-8"><a href="inf%C3%A9rer.html#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.266</span></span>
<span id="cb115-9"><a href="inf%C3%A9rer.html#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.372</span></span>
<span id="cb115-10"><a href="inf%C3%A9rer.html#cb115-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-11"><a href="inf%C3%A9rer.html#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Une nouvelle variable aléatoire</span></span>
<span id="cb115-12"><a href="inf%C3%A9rer.html#cb115-12" aria-hidden="true" tabindex="-1"></a>total <span class="ot">&lt;-</span> a <span class="sc">+</span> b</span></code></pre></div>
<p>Entre en jeu le <em>théorème central limite</em>: plus des variables aléatoires identiquement distribuées sont additionnées ensemble, plus la distribution de probabilité de cette somme se rapproche d’une distribution normale.</p>
<p>Par exemple, la fonction <code><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm()</a></code> génère des variables issues d’une distribution log normale. Elle a la forme illustré à la Figure <a href="inf%C3%A9rer.html#fig:lognormal">10.1</a> (qui n’a rien de normal à première vue).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:lognormal"></span>
<img src="10-Inferer_files/figure-html/lognormal-1.png" alt="Distribution log normale" width="80%" height="80%"><p class="caption">
Figure 10.1: Distribution log normale
</p>
</div>
<p>En calculant la somme de plusieurs variables aléatoires de cette distribution, pour diverses valeurs de tailles d’échantillons (nombre de variables échantillonnées), les résultats tendent de plus en plus vers une distribution normale. Le code ci-dessous présente la démarche utilisée et la Figure <a href="inf%C3%A9rer.html#fig:testn">10.2</a> en fait la démonstration graphique en présentant les distributions d’échantillonnage obtenues.</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cette fonction sort les nombres, mais pas les graphiques.</span></span>
<span><span class="co"># Différentes tailles d'échantillons</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">90</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co"># Nombre de tirage pour chaque élément de N</span></span>
<span><span class="va">reps</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># Une boucle pour tester toutes les possibilités</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="va">N</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">reps</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co"># Faire la somme de n valeurs tirés d'une distribution log normale</span></span>
<span>    <span class="va">total</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># hist(total) </span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>La Figure <a href="inf%C3%A9rer.html#fig:testn">10.2</a> montre que la distribution d’échantillonnage de la somme des variables converge vers une distribution normale à mesure que la taille d’échantillon <span class="math inline">\(n\)</span> augmente. Cela est vrai pour n’importe quelle distribution de probabilité de la population. Le théorème central en dit plus que simplement la forme de la distribution. Elle affirme également qu’une distribution de probabilité d’une population ayant une moyenne <span class="math inline">\(\mu\)</span> et un écart type <span class="math inline">\(\sigma\)</span> échantillonnées sur <span class="math inline">\(n\)</span> unités, génére une distribution d’échantillonnage des totaux (indicé <span class="math inline">\(t\)</span>) ayant une espérance (la moyenne) de <span class="math inline">\(n\mu_t\)</span> et un écart type de <span class="math inline">\(n\sigma_t^2\)</span>.</p>
<div class="figure">
<span style="display:block;" id="fig:testn"></span>
<img src="10-Inferer_files/figure-html/testn-1.png" alt="Distributions des totaux de n variables log normales" width="672"><p class="caption">
Figure 10.2: Distributions des totaux de n variables log normales
</p>
</div>
<p>Les expérimentateurs ne connaissent pas les distributions sous-jacentes aux valeurs des unités issues de la population. Par contre, à l’aide des statisticiens et du théorème central limite, ils savent comment se comportent les sommes des variables. Les expérimentateurs s’intéressent toutefois rarement aux sommes de variable… ou le sont-ils? En fait, les expérimentateurs s’intéressent particulièrement aux sommes de variables, comme la moyenne (une somme de variables divisée par la constante <span class="math inline">\(n\)</span>), la variance (la somme des écarts au carré) ou la corrélation (la somme des produits de deux variables divisée par <span class="math inline">\(n-1\)</span>). Dans le cas de la moyenne, le théorème central limite stipule qu’une distribution de probabilité ayant une moyenne <span class="math inline">\(\mu\)</span> et un écart type <span class="math inline">\(\sigma\)</span> dont l’échantillon est constitué de <span class="math inline">\(n\)</span> unités, génère une distribution d’échantillonnage des moyennes avec une espérance de <span class="math inline">\(\mu_{\bar{x}}\)</span> et un écart type de <span class="math inline">\(\sigma_{\bar{x}}/\sqrt{n}\)</span>.</p>
<p>Dans la mesure où l’expérimentateur connaît la distribution de la population (extrêmement rare, mais permet de mieux illustrer la théorie) ou qu’il recoure à une distribution d’échantillonnage connue, il peut inférer la probabilité d’une variable aléatoire par rapport à ce qui est attendu simplement par hasard. Il juge alors si cette variable est trop rare par rapport à l’hypothèse de base (nulle).</p>
<p>La théorie traditionnelle des tests d’hypothèses repose sur l’idée selon laquelle on compare la vraisemblance d’une variable aléatoire estimée auprès d’un échantillon par rapport à une hypothèse nulle (l’absence d’effet). En épistémologie des sciences, il n’est pas possible de montrer l’exactitude d’une hypothèse, seulement son inexactitude. Cela rappelle le principe du falsificationnisme selon lequel on ne peut prouver une hypothèse, on ne peut que la falsifier. En statistiques, c’est la rareté d’une donnée qui agira comme indice d’<em>inexactitude</em>. Si la variable aléatoire est trop rare pour l’hypothèse nulle, celle-ci est rejetée : d’autres hypothèses doivent être considérées pour expliquer ce résultat. Autrement, l’hypothèse nulle n’est pas rejetée, les preuves sont insuffisantes pour informer l’expérimentateur sur l’hypothèse nulle.</p>
</div>
<div id="inférence-avec-la-distribution-normale-sur-une-unité" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Inférence avec la distribution normale sur une unité<a class="anchor" aria-label="anchor" href="#inf%C3%A9rence-avec-la-distribution-normale-sur-une-unit%C3%A9"><i class="fas fa-link"></i></a>
</h2>
<p>Un excellent exemple en sciences humaines et sociales où la distribution de probabilité de la population est connue est le quotient intellectuel (QI). Le QI d’une population occidentale est distribué normalement (établi intentionnellement par les psychométriciens) avec une moyenne de 100 (<span class="math inline">\(\mu=100\)</span>) et un écart type de <span class="math inline">\(\sigma = 15\)</span>. Ces valeurs sont totalement arbitraires, il est tout aussi convenable de parler d’une moyenne de 0 et d’un écart type de 1 (la distribution peut être standardisée) quoiqu’il est contre-intuitif de parle d’un QI de 0. (Qui voudrait avoir une intelligence de 0?)</p>
<p>Dans la population, bien que la moyenne et la variance peuvent être connues, sélectionner une unité au hasard génère une variable aléatoire. Chaque individu de la population a une probabilité très faible d’être sélectionné et est indépendant des autres individus de la population. Il est très difficile de prédire le score exact d’une personne. Toutefois, il est possible d’avoir un idée de la variabilité des scores. La Figure <a href="inf%C3%A9rer.html#fig:regle">10.3</a> montre la distribution normale par rapport à la moyenne, <span class="math inline">\(\mu\)</span> pour différentes valeurs d’écart type, <span class="math inline">\(\sigma\)</span>. Elle montre que 68.269% devrait se retrouvé entre plus ou moins un écart types ou encore que 95.45% devrait se retrouvé entre plus ou moins deux écarts types. Ajuster au QI, il s’agit de 85 à 115 et de 70 à 130 respectivement</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:regle"></span>
<img src="10-Inferer_files/figure-html/regle-1.png" alt="La distribution normale du QI" width="90%" height="90%"><p class="caption">
Figure 10.3: La distribution normale du QI
</p>
</div>
<p>Une autre façon de fonctionner est de prendre une personne au hasard et de mesurer son QI. Le score obtenu est une valeur aléatoire. Comme la distribution est connue avec ses paramètres, il est possible de juger de la vraisemblance de ce score (est-il rare?) par rapport à la population.</p>
<p>Voici un exemple où ces informations sont pertinentes. Un groupe d’<em>expérimentateurs</em> mettent en place un outil d’évaluation qui teste si un individu donné est un humain ou un reptilien (une race d’extra-terrestre). Leur outil n’est pas si sophistiqué. En fait, il se base sur le QI, car les expérimentateurs ont remarqué que les reptiliens ont un QI beaucoup plus élevé que le QI humain.</p>
<p>La distribution normale du QI humain joue le rôle d’hypothèse nulle, les personnes mesurées sont admises humaines jusqu’à preuve du contraire (une présomption d’innocence en quelque sorte), un QI <em>trop</em> élevé suggérant la culpabilité.</p>
<p>Les expérimentateurs émettent l’hypothèse que les 5 % personnes ayant le plus haut QI sont vraisemblablement reptiliens. C’est le risque qu’ils sont prêts à prendre de sélectionner un humain et de le classer erronément comme reptilien.</p>
<p>Le groupe d’expérimentateurs teste leur instrument sur Fanny. Elle a un QI de 120. La Figure <a href="inf%C3%A9rer.html#fig:fannyd">10.4</a> illustre la distribution de l’intelligence dans la population et où se situe Fanny parmi celle-ci. Comment tester si elle est reptilienne?</p>
<div class="figure">
<span style="display:block;" id="fig:fannyd"></span>
<img src="10-Inferer_files/figure-html/fannyd-1.png" alt="Score de Fanny sur la distribution normale" width="672"><p class="caption">
Figure 10.4: Score de Fanny sur la distribution normale
</p>
</div>
<p>La première étape est d’obtenir un <strong>score-<span class="math inline">\(z\)</span></strong>. Un score-<span class="math inline">\(z\)</span> est une échelle standardisée des distances d’une valeur par rapport à la moyenne. Lorsqu’une échelle de mesure est transformée en score-<span class="math inline">\(z\)</span>, la moyenne est de 0 et l’écart type est égal à 1. Cela permet de mieux apprécier les distances et leur probabilité. Un score-<span class="math inline">\(z\)</span> s’obtient en prenant la différence entre une unité (<span class="math inline">\(x\)</span>) par rapport à la moyenne (<span class="math inline">\(\mu\)</span>) divisée par l’écart type (<span class="math inline">\(\sigma\)</span>). L’équation <a href="inf%C3%A9rer.html#eq:zzz">(10.1)</a> illustre ce calcul.</p>
<p><span class="math display" id="eq:zzz">\[\begin{equation}
z = \frac{x-\mu}{\sigma}
\tag{10.1}
\end{equation}\]</span></p>
<p>Comme un score-<span class="math inline">\(z\)</span> est standardisé, la Figure <a href="inf%C3%A9rer.html#fig:regle">10.3</a> est utilisable pour tirer des conclusions, car celle-ci applicable pour toutes sortes de situations où la distribution est vraisemblablement normale.</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fanny</span> <span class="op">&lt;-</span> <span class="fl">120</span></span>
<span><span class="va">z.fanny</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">fanny</span> <span class="op">-</span> <span class="fl">100</span><span class="op">)</span> <span class="op">/</span> <span class="fl">15</span></span></code></pre></div>
<p>Fanny a un score-<span class="math inline">\(z\)</span> de 1.333. Maintenant, il faut traduire cette valeur en probabilité.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="inf%C3%A9rer.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># La probabilité que Fanny ait un QI de -Inf à z.fanny</span></span>
<span id="cb118-2"><a href="inf%C3%A9rer.html#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(z.fanny)</span>
<span id="cb118-3"><a href="inf%C3%A9rer.html#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.909</span></span>
<span id="cb118-4"><a href="inf%C3%A9rer.html#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="inf%C3%A9rer.html#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="co"># En pourcentage</span></span>
<span id="cb118-6"><a href="inf%C3%A9rer.html#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(z.fanny) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb118-7"><a href="inf%C3%A9rer.html#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">90.9</span></span></code></pre></div>
<p>L’expectative sous l’hypothèse nulle est d’observer un score pareil ou supérieur à celui de Fanny 9.121 % du temps. Cette statistique correspond à la <em>valeur-<span class="math inline">\(p\)</span></em>, la probabilité de l’indice par rapport à sa distribution d’échantillonnage (hypothèse nulle). Comme elle ne dépasse pas le seuil de 5%, soit la limite selon laquelle le score est jugé invraisemblable, l’hypothèse nulle n’est pas rejetée (elle est humaine!).</p>
<p>Avec le critère d’identifier erronément les 5 % humains les plus intelligents, il s’agit, du même coup, du <strong>taux de faux positif</strong> <em>acceptable</em> de l’étude. Un faible sacrifice à réaliser afin identifier des reptiliens parmi les humains. La zone de rejet, c’est-à-dire la zone dans laquelle l’hypothèse nulle (humain) est rejetée, correspond à la zone ombragée à droite de la distribution.</p>
<p>La logique des tests statistiques inférentiels repose sur cette série d’étapes : choisir un indice, connaître sa distribution sous-jacente, déterminer l’hypothèse nulle (généralement l’absence d’effet), calculer la probabilité de l’indice par rapport à cette hypothèse nulle.</p>
</div>
<div id="inférence-avec-la-distribution-normale-sur-un-échantillon" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Inférence avec la distribution normale sur un échantillon<a class="anchor" aria-label="anchor" href="#inf%C3%A9rence-avec-la-distribution-normale-sur-un-%C3%A9chantillon"><i class="fas fa-link"></i></a>
</h2>
<p>Jusqu’à maintenant, seule une unité d’observation était traitée. L’indice et la distribution étaient également spécifiés. Dans cette section, l’exemple est étendu aux échantillons (plus d’une unité d’observation).</p>
<p>Fanny a un QI de 120. Si une autre personne est sélectionnée, cette nouvelle personne aurait inévitablement un autre score. Cette logique s’applique également aux échantillons. L’exemple ci-dessous échantillonne 10 unités d’une population de QI distribuée normalement avec les paramètres usuels.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="inf%C3%A9rer.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'un échantillon de 10 unités</span></span>
<span id="cb119-2"><a href="inf%C3%A9rer.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">824</span>)</span>
<span id="cb119-3"><a href="inf%C3%A9rer.html#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="inf%C3%A9rer.html#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Dix valeurs arrondies avec une moyenne de 100 et un écart type de 10</span></span>
<span id="cb119-5"><a href="inf%C3%A9rer.html#cb119-5" aria-hidden="true" tabindex="-1"></a>QI <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>))</span>
<span id="cb119-6"><a href="inf%C3%A9rer.html#cb119-6" aria-hidden="true" tabindex="-1"></a>QI</span>
<span id="cb119-7"><a href="inf%C3%A9rer.html#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">1</span>] <span class="dv">110</span> <span class="dv">111</span> <span class="dv">102</span>  <span class="dv">99</span> <span class="dv">109</span> <span class="dv">102</span>  <span class="dv">99</span> <span class="dv">110</span> <span class="dv">132</span> <span class="dv">114</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:rept"></span>
<img src="10-Inferer_files/figure-html/rept-1.png" alt="Scores des unités de l'échantillon" width="90%" height="90%"><p class="caption">
Figure 10.5: Scores des unités de l’échantillon
</p>
</div>
<p>Dans la Figure <a href="inf%C3%A9rer.html#fig:rept">10.5</a>, chaque unité est présentée par un trait vertical noir. La moyenne de cet échantillon est de 108.8 et l’écart type est de 9.762. Dans cet exemple, l’indice est clairement identifié, mais quelle est la distribution d’échantillonnage des moyennes? Selon le théorème central limite, la moyenne de la distribution d’échantillonnage est <span class="math inline">\(\mu=\mu_{\bar{x}}=100\)</span> et l’écart type est <span class="math inline">\(\sigma_{\bar{x}} = \frac{\sigma}{\sqrt{n}}=\frac{15}{\sqrt{10}}=4.743\)</span> . Maintenant, il est possible de calculer un score-<span class="math inline">\(z\)</span>.</p>
<p><span class="math display">\[
z = \frac{\bar{x}-\mu_{\bar{x}}}{\sigma/\sqrt{n}}=\frac{108.8-100}{15/\sqrt{10}}=1.855
\]</span>
Cela donne le code suivant.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="inf%C3%A9rer.html#cb120-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (<span class="fu">mean</span>(QI) <span class="sc">-</span> <span class="dv">100</span>)<span class="sc">/</span>(<span class="dv">15</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>))</span>
<span id="cb120-2"><a href="inf%C3%A9rer.html#cb120-2" aria-hidden="true" tabindex="-1"></a>z</span>
<span id="cb120-3"><a href="inf%C3%A9rer.html#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.86</span></span></code></pre></div>
<p>La fonction <code>(1 - pnorm(z)) * 100</code>, retourne la probabilité (en pourcentage) d’un résultat plus rare que l’indice obtenu auprès de l’échantillon par rapport à la population. Comme pour l’exemple de Fanny, ce chiffre est une valeur-<span class="math inline">\(p\)</span>, soit la probabilité de l’indice observé par rapport à l’hypothèse nulle. La Figure <a href="inf%C3%A9rer.html#fig:tye">10.6</a> montre l’emplacement de l’échantillon sur la distribution d’échantillonnage. La probabilité de cet échantillon par rapport à l’hypothèse nulle est de 3.178 %, juste en deçà du 5 % fixé. Dans la Figure <a href="inf%C3%A9rer.html#fig:tye">10.6</a>, la moyenne de l’échantillon se retrouve à l’intérieur de la zone de rejet (la zone grise). La conclusion est par conséquent de rejeter l’hypothèse nulle, l’échantillon semble provenir d’une autre distribution (avec des paramètres différents) que celle postulée.</p>
<div class="figure">
<span style="display:block;" id="fig:tye"></span>
<img src="10-Inferer_files/figure-html/tye-1.png" alt="Moyenne de l'échantillon sur la distribution normale" width="672"><p class="caption">
Figure 10.6: Moyenne de l’échantillon sur la distribution normale
</p>
</div>
<p><strong>Qu’en est-il vraiment de ce résultat?</strong> Pour l’expérimentateur, il ne peut aller plus loin, car il ne connaît pas la boîte noire selon laquelle les valeurs de l’échantillon sont générées. Il ne peut que constater que plusieurs (9/10) unités ont un score plus élevé que 100. Par contre, comme il s’agit d’un exemple simulé, la boîte noire est connue. C’est la fonction, <code>round(rnorm(n = 10, mean = 100, sd = 15))</code>, une distribution normale ayant <span class="math inline">\(\mu=100,\sigma=15\)</span> qui est utilisée pour générer les valeurs. L’utilisateur sait qu’il s’agit d’un faux positif (une erreur de Type I) : l’échantillon fait partie des 5 % des échantillons qui risquent de se faire rejeter accidentellement. Si l’utilisateur utilise une autre graine (<code>seed()</code>), la plupart (95%) des moyennes ne sont pas rejetées.</p>
<p>Pour l’instant, seule une boîte noire a été examinée - celle de l’hypothèse nulle. Qu’advient-il du vrai phénomène? Par exemple, si les reptiliens existent vraiment. Comme l’utilisateur est le maître du modèle, il peut spécifier les paramètres à sa convenance. Le QI des reptiliens est conceptualisé pour être distribué comme une distribution normale ayant <span class="math inline">\(\mu_{r}=130, \sigma_r = 15\)</span> où l’indice <span class="math inline">\(r\)</span> ne fait qu’indiquer qu’il s’agit des paramètres de la population reptilienne. Les paramètres humains sont désignés par <span class="math inline">\(h\)</span>, soit <span class="math inline">\(\mu_h = 100,\sigma_h = 15\)</span>.</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu.h</span> <span class="op">&lt;-</span> <span class="fl">100</span> ; <span class="va">sd.h</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span><span class="va">mu.r</span> <span class="op">&lt;-</span> <span class="fl">130</span> ; <span class="va">sd.r</span> <span class="op">&lt;-</span> <span class="fl">15</span></span></code></pre></div>
<p>La Figure <a href="inf%C3%A9rer.html#fig:rh">10.7</a> présente les distributions de ces populations. Trois zones sont ajoutées pour illustrer les concepts statistiques d’erreur de type I, d’erreur de type II et de puissance statistique. Comme les populations sont connues, ces concepts statistiques sont calculables.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:rh"></span>
<img src="10-Inferer_files/figure-html/rh-1.png" alt="Distribution du QI des humains et des reptiliens" width="90%" height="90%"><p class="caption">
Figure 10.7: Distribution du QI des humains et des reptiliens
</p>
</div>
<p>L’erreur de type I (présentée auparavant) représente la probabilité d’émettre un faux positif, souvent représentée par <span class="math inline">\(\alpha\)</span> (alpha). Elle correspond à la probabilité de rejeter l’hypothèse lorsqu’elle est vraie. Dans la Figure <a href="inf%C3%A9rer.html#fig:rh">10.7</a>, il s’agit de la zone noire. Elle correspond à conclure qu’un vrai humain est un reptilien (ce qu’il n’est pas). Ce taux est fixé à l’avance par l’expérimentateur, ici, 5%. C’est le risque qu’il est prêt à prendre. Ainsi, 95% des humains sont correctement identifiés comme humains.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="inf%C3%A9rer.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Erreur de type I (fixé à l'avance)</span></span>
<span id="cb122-2"><a href="inf%C3%A9rer.html#cb122-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span> </span>
<span id="cb122-3"><a href="inf%C3%A9rer.html#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="inf%C3%A9rer.html#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Valeur critique à laquelle l'expérimentateur rejette H0</span></span>
<span id="cb122-5"><a href="inf%C3%A9rer.html#cb122-5" aria-hidden="true" tabindex="-1"></a>v.crit <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">mean =</span> mu.h, <span class="at">sd =</span> sd.h)</span>
<span id="cb122-6"><a href="inf%C3%A9rer.html#cb122-6" aria-hidden="true" tabindex="-1"></a>v.crit</span>
<span id="cb122-7"><a href="inf%C3%A9rer.html#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="dv">125</span></span>
<span id="cb122-8"><a href="inf%C3%A9rer.html#cb122-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-9"><a href="inf%C3%A9rer.html#cb122-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Erreur de type II</span></span>
<span id="cb122-10"><a href="inf%C3%A9rer.html#cb122-10" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(v.crit, <span class="at">mean =</span> mu.r, <span class="at">sd =</span> sd.r)</span>
<span id="cb122-11"><a href="inf%C3%A9rer.html#cb122-11" aria-hidden="true" tabindex="-1"></a>beta</span>
<span id="cb122-12"><a href="inf%C3%A9rer.html#cb122-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.361</span></span>
<span id="cb122-13"><a href="inf%C3%A9rer.html#cb122-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-14"><a href="inf%C3%A9rer.html#cb122-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Puissance statistique</span></span>
<span id="cb122-15"><a href="inf%C3%A9rer.html#cb122-15" aria-hidden="true" tabindex="-1"></a>puissance <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> beta</span>
<span id="cb122-16"><a href="inf%C3%A9rer.html#cb122-16" aria-hidden="true" tabindex="-1"></a>puissance </span>
<span id="cb122-17"><a href="inf%C3%A9rer.html#cb122-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.639</span></span></code></pre></div>
<p>La zone hachurée de la Figure <a href="inf%C3%A9rer.html#fig:rh">10.7</a> correspond à l’<strong>erreur de type II</strong>, souvent représentée par <span class="math inline">\(\beta\)</span> (beta), soit la probabilité de <em>ne pas rejeter</em> l’hypothèse nulle. Autrement dit, c’est la probabilité de ne pas trouver l’effet lorsque celui-ci est vrai. Pour cet exemple, il s’agit d’un reptilien assez sournois (avec un QI suffisamment faible pour sa population) qu’il passe inaperçu auprès des humains, ou, en d’autres termes, de conclure qu’un vrai reptilien est un humain (ce qu’il n’est pas). Cette probabilité est estimée à 36.124%, donc 36.124% des reptiliens passeront inaperçus.</p>
<p>La <strong>puissance</strong>, la zone grise de la Figure <a href="inf%C3%A9rer.html#fig:rh">10.7</a>, correspond à la probabilité de rejeter correctement l’hypothèse nulle. Il s’agit de rejeter l’hypothèse nulle lorsqu’elle est fausse. Cela signifie d’identifier un vrai reptilien correctement. C’est exactement ce que le groupe de chercheur désire réaliser. Elle est estimée à 63.876% en ne prenant qu’une mesure de QI. La puissance est l’une des statistiques qui intéressent le plus l’expérimentateur <em>avant</em> de réaliser son étude, car elle donne une approximation sur la probabilité de trouver un résultat significatif. Par contre, les expérimentateurs ne connaissent que rarement les paramètres de la vraie distribution de l’effet qu’il désire trouver. En langage statistique, il s’agit un paramètre de non-centralité (ou de décentralisation) ou <code>ncp</code> en syntaxe <strong>R</strong>. L’expérimentateur recourt alors à d’habiles approximations éclairées basées sur leurs connaissances du phénomène et en regard des études déjà publiées sur le sujet (ou un sujet similaire), s’il y en a. Ces estimations souffrent tout de même d’être des variables aléatoires (elles respectent elles aussi une distribution d’échantillonnage), et non les paramètres recherchés.</p>
<p>Avant de procéder davantage, une dernière notion est importante à présenter : la direction du test. Dans tous les exemples précédents, l’hypothèse nulle était rejetée si une valeur plus rare était obtenue. Il s’agit d’un test d’hypothèse <strong>unilatérale</strong> (d’un seul côté). Cela facilite grandement la présentation de certains concepts et calculs. Un test peut être unilatérale inférieure, trouver un résultat plus faible qu’une valeur critique; ou unilatérale supérieure, trouver un résultat plus élevé qu’une valeur critique; ou encore <strong>bilatérale</strong>, soit trouver un résultat moins élevée ou plus élevée que des valeurs critiques.</p>
<p>Dans le cas d’un test bilatéral, l’erreur de type I est divisée par 2, <span class="math inline">\(\alpha/2\)</span> pour couvrir l’espace des deux côtés de la distribution. L’espace total est identique même s’il est divisé sur les deux extrêmes. Cela implique des valeurs critiques plus élevées que si le test n’était que d’un côté et par conséquent une puissance statistique un peu plus faible, car l’effet est directionnel. La probabilité de rejeter l’hypothèse dans une direction a été diminuée pour tenir compte de l’autre côté. La Figure <a href="inf%C3%A9rer.html#fig:tt">10.8</a> montre un exemple de chacun de ces types de tests pour <span class="math inline">\(\alpha = .05\)</span>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tt"></span>
<img src="10-Inferer_files/figure-html/tt-1.png" alt="Illustration de l'erreur de type I" width="864"><p class="caption">
Figure 10.8: Illustration de l’erreur de type I
</p>
</div>
<p>Le choix entre unilatérale inférieure, supérieure ou bilatérale repose essentiellement sur la question de recherche de l’expérimentateur. Qu’attend-il ou que veut-il savoir du résultat? L’expérimentateur recourt généralement au test bilatéral afin d’identifier des résultats allant pour son hypothèse ou à l’opposé de son hypothèse. Cela permet notamment d’identifier des devis qui peuvent nuire aux participants. Par exemple, si un expérimentateur développe une intervention pour réduire la consommation de drogues chez les adolescents et n’est concerné que par la probabilité que l’intervention soit efficace, il peut manquer l’effet délétère d’une telle intervention, soit que l’intervention augmente la consommation de drogue. Il est certain que l’expérimentateur souhaite être rapidement mis au courant si ces résultats se dessinent.</p>
</div>
<div id="la-distribution-t" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> La distribution-<span class="math inline">\(t\)</span><a class="anchor" aria-label="anchor" href="#la-distribution-t"><i class="fas fa-link"></i></a>
</h2>
<p>Dans la plupart des cas, l’expérimentateur ne connaît pas la variance de la population. Il recourt alors à la meilleure estimation qui lui est disponible, celle obtenue auprès de l’échantillon. De recourir à une estimation au lieu de la vraie valeur cause un réel problème: l’estimation est une variable aléatoire respectant une distribution d’échantillonnage. La distribution des variances montre une légère asymétrie positive plus flagrante pour les petites tailles d’échantillon, car les variances sont distribuées en distribution-<span class="math inline">\(\chi^2\)</span>.</p>
<div class="figure">
<span style="display:block;" id="fig:illvar"></span>
<img src="10-Inferer_files/figure-html/illvar-1.png" alt="Distribution de la variance en fonction de la taille d'échantillon" width="672"><p class="caption">
Figure 10.9: Distribution de la variance en fonction de la taille d’échantillon
</p>
</div>
<p>Une petite simulation faite à partir d’une distribution normale standardisée par rapport à trois tailles d’échantillon et dont la variance est estimée 10^{4} fois est présentée dans la Figure <a href="inf%C3%A9rer.html#fig:illvar">10.9</a>. Elle montre que l’estimation n’est pas biaisée (elles sont toutes les trois centrées à 1), mais relève l’asymétrie en question pour les petites tailles d’échantillon qui tend à décroître à mesure que <span class="math inline">\(n\)</span> augmente. Autrement dit, une estimation unique (pris d’un échantillon) est plus susceptible d’être sous-estimée. Ne pas tenir compte de cet aspect augmente indûment les valeurs obtenues (à cause du dénominateur plus petit). Ainsi, il est inadéquat d’utiliser une distribution normale lorsque la variance est inconnue. Il faut plutôt opter pour la <strong>distribution-<span class="math inline">\(t\)</span></strong> qui, elle, tient compte de la variabilité de l’estimation de la variance.</p>
<p>La distribution-<span class="math inline">\(t\)</span> est symétrique, comme la distribution normale, mais a des queues plus larges pour tenir compte de la surestimation des valeurs dû à la sous-estimation de la variance. La distribution-<span class="math inline">\(t\)</span> tend vers une distribution normale lorsque <span class="math inline">\(n\)</span> augmente, ce qui est illustré à la Figure <a href="inf%C3%A9rer.html#fig:tnorm">10.10</a>. La ligne pleine noire montre la distribution pour 5 unités, les deux autres lignes, traits et pointillés, pour 30 et 1000 unités respectivement. Il est difficile de distinguer ces deux dernières.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:tnorm"></span>
<img src="10-Inferer_files/figure-html/tnorm-1.png" alt="Comparaison d'une distribution normale à deux distributions-$t$" width="90%" height="90%"><p class="caption">
Figure 10.10: Comparaison d’une distribution normale à deux distributions-<span class="math inline">\(t\)</span>
</p>
</div>
<p>En ayant recours à des échantillons et une estimation de la variance (la variance est inconnue de l’expérimentateur, ce qui est généralement le cas), il faut procéder avec la distribution-<span class="math inline">\(t\)</span>. La procédure est la même que celle utilisée avec les scores-<span class="math inline">\(z\)</span> précédemment, la différence étant que la distribution-<span class="math inline">\(t\)</span> est utilisée au lieu de la distribution normale, car l’écart type est estimé.</p>
</div>
<div id="le-test-t-à-échantillon-unique" class="section level2" number="10.5">
<h2>
<span class="header-section-number">10.5</span> Le test-<span class="math inline">\(t\)</span> à échantillon unique<a class="anchor" aria-label="anchor" href="#le-test-t-%C3%A0-%C3%A9chantillon-unique"><i class="fas fa-link"></i></a>
</h2>
<p>Le test-<span class="math inline">\(t\)</span> à échantillon unique permet de tester la moyenne d’échantillon par rapport à une valeur arbitraire <span class="math inline">\(\mu_0\)</span> (généralement <span class="math inline">\(\mu_0 = 0\)</span>) qui joue le rôle d’hypothèse nulle.</p>
<p><span class="math display">\[ t_{n-1} = \frac{\bar{x}-\mu_0}{(s/\sqrt{n})} \]</span></p>
<p>La distribution-<span class="math inline">\(t\)</span> a un degré de liberté (l’indice de <span class="math inline">\(t\)</span> dans l’équation) qui lui est associé et qui est fixé à <span class="math inline">\(dl = n - 1\)</span>, la taille d’échantillon moins 1. Un degré est perdu à cause de l’estimation de l’écart type de l’échantillon. Qu’en est-il de la probabilité d’obtenir cette moyenne? En recourant à la distribution intégrée de <strong>R</strong>, <code><a href="https://rdrr.io/r/stats/TDist.html">pt()</a></code> il est possible d’obtenir la probabilité d’une valeur-<span class="math inline">\(t\)</span> par rapport à l’hypothèse nulle. La fonction nécessite une valeur-<span class="math inline">\(t\)</span> et le degré de liberté associé, p. ex., <code>pt(t = , df = n - 1)</code>. La valeur produite donne la probabilité d’obtenir un score plus petit jusqu’à la valeur-<span class="math inline">\(t\)</span>. Une astuce permet de calculer aisément la probabilité lorsque la distribution d’échantillonnage est symétrique. Utiliser une valeur absolue permet de considérer les deux côtés de la distribution simultanément. Les valeurs-<span class="math inline">\(t\)</span> négatives sont alors positives. Comme un côté est supprimé, l’espace positif est doublé, le code pour tenir compte de cet astuce est : <code>(1 - pt(abs(t), df = n - 1)) * 2</code> où <code>t</code> est la valeur-<span class="math inline">\(t\)</span> obtenue.</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">mu</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># x est une variable continue</span></span>
<span>  <span class="co"># mu est une moyenne à tester comme hypothèse nulle(H0)</span></span>
<span>  <span class="va">xbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">sdx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">vt</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">xbar</span> <span class="op">-</span> <span class="va">mu</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">sdx</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">dl</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>  <span class="va">vp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">vt</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">dl</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> </span>
<span>  <span class="va">statistique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>valeur.t <span class="op">=</span> <span class="va">vt</span>, </span>
<span>                      dl <span class="op">=</span> <span class="va">dl</span>, </span>
<span>                      valeur.p <span class="op">=</span> <span class="va">vp</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">statistique</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Une fois la fonction créée, il est possible de la tester en la comparant avec la fonction <strong>R</strong> de base <code>test.t()</code>. Le code suivant crée un échantillon de 30 unités avec une moyenne de 1 et un écart type de 1.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="inf%C3%A9rer.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Un exemple de jeu de données</span></span>
<span id="cb124-2"><a href="inf%C3%A9rer.html#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">20</span>)</span>
<span id="cb124-3"><a href="inf%C3%A9rer.html#cb124-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb124-4"><a href="inf%C3%A9rer.html#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérification de la fonction maison</span></span>
<span id="cb124-5"><a href="inf%C3%A9rer.html#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="fu">testt</span>(x)</span>
<span id="cb124-6"><a href="inf%C3%A9rer.html#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="er">$</span>valeur.t</span>
<span id="cb124-7"><a href="inf%C3%A9rer.html#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">3.69</span></span>
<span id="cb124-8"><a href="inf%C3%A9rer.html#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb124-9"><a href="inf%C3%A9rer.html#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>dl</span>
<span id="cb124-10"><a href="inf%C3%A9rer.html#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="dv">29</span></span>
<span id="cb124-11"><a href="inf%C3%A9rer.html#cb124-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb124-12"><a href="inf%C3%A9rer.html#cb124-12" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>valeur.p</span>
<span id="cb124-13"><a href="inf%C3%A9rer.html#cb124-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.000919</span></span>
<span id="cb124-14"><a href="inf%C3%A9rer.html#cb124-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparer avec la fonction R</span></span>
<span id="cb124-15"><a href="inf%C3%A9rer.html#cb124-15" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x)</span>
<span id="cb124-16"><a href="inf%C3%A9rer.html#cb124-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb124-17"><a href="inf%C3%A9rer.html#cb124-17" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   One Sample t<span class="sc">-</span>test</span>
<span id="cb124-18"><a href="inf%C3%A9rer.html#cb124-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb124-19"><a href="inf%C3%A9rer.html#cb124-19" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> data<span class="sc">:</span>  x</span>
<span id="cb124-20"><a href="inf%C3%A9rer.html#cb124-20" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> t <span class="ot">=</span> <span class="dv">4</span>, df <span class="ot">=</span> <span class="dv">29</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">9e-04</span></span>
<span id="cb124-21"><a href="inf%C3%A9rer.html#cb124-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> alternative hypothesis<span class="sc">:</span> true mean is not equal to <span class="dv">0</span></span>
<span id="cb124-22"><a href="inf%C3%A9rer.html#cb124-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb124-23"><a href="inf%C3%A9rer.html#cb124-23" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  <span class="fl">0.31</span> <span class="fl">1.08</span></span>
<span id="cb124-24"><a href="inf%C3%A9rer.html#cb124-24" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> sample estimates<span class="sc">:</span></span>
<span id="cb124-25"><a href="inf%C3%A9rer.html#cb124-25" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mean of x </span>
<span id="cb124-26"><a href="inf%C3%A9rer.html#cb124-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>     <span class="fl">0.696</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:sss"></span>
<img src="10-Inferer_files/figure-html/sss-1.png" alt="Valeur-$t$ de l'échantillon sur la distribution-$t$" width="75%" height="75%"><p class="caption">
Figure 10.11: Valeur-<span class="math inline">\(t\)</span> de l’échantillon sur la distribution-<span class="math inline">\(t\)</span>
</p>
</div>
<p>Qu’est-ce que ces résultats signifient? La Figure <a href="inf%C3%A9rer.html#fig:sss">10.11</a> montre la distribution d’échantillonnage de l’hypothèse nulle, c’est-à-dire l’hypothèse selon laquelle la moyenne de la population est égale à 0. Les zones grises montrent les zones de rejet. Si une valeur-<span class="math inline">\(t\)</span> se retrouve dans ces zones, elle est jugée comme <em>trop rare</em>, il faut alors rejeter l’hypothèse nulle. C’est ce qui s’est produit ici. Rien de surprenant, l’échantillon est tiré d’une distribution normale avec une moyenne de 1 et un écart type de 1.</p>
</div>
<div id="critiques-des-tests-dhypothèses" class="section level2" number="10.6">
<h2>
<span class="header-section-number">10.6</span> Critiques des tests d’hypothèses<a class="anchor" aria-label="anchor" href="#critiques-des-tests-dhypoth%C3%A8ses"><i class="fas fa-link"></i></a>
</h2>
<p>TODO</p>
<p>Le présent ouvrage ne couvre que l’aspect traditionnel ou classique des tests d’hypothèse. Cette approche est remise en question depuis 1950 jusqu’à aujourd’hui. D’excellents ouvrages couvrent les failles et solutions des tests d’hypothèses classiques de façon plus approfondie qu’il ne l’est fait ici.</p>
<ul>
<li>L’hypothèse nulle n’est jamais susceptible d’être vraie.</li>
<li>La conclusion statistique n’est pas celle désirée par l’expérimentateur.</li>
<li>La significativité statistique n’implique pas la significativité pratique.</li>
<li>Les expérimentateurs interprètent incorrectement la valeur-<span class="math inline">\(p\)</span>.</li>
<li>Une valeur-<span class="math inline">\(p\)</span> faible n’est pas garantie de la reproductibilité.</li>
<li>La dichotomisation de la preuve <span class="math inline">\(p&lt;=\alpha\)</span>.</li>
<li>Une saine utilisation de la valeur-<span class="math inline">\(p\)</span> n’accomplit pas grand-chose.</li>
<li>L’obsession de la valeur-<span class="math inline">\(p\)</span> cause plus de problèmes qu’elle n’en résout : <span class="math inline">\(p\)</span>-hacking, triturage de données, abus de variables, comparaison multiple, biais pour les hypothèses originales et surprenantes.</li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="d%C3%A9crire.html"><span class="header-section-number">9</span> Décrire</a></div>
<div class="next"><a href="analyser.html"><span class="header-section-number">11</span> Analyser</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#inf%C3%A9rer"><span class="header-section-number">10</span> Inférer</a></li>
<li><a class="nav-link" href="#le-th%C3%A9or%C3%A8me-central-limite"><span class="header-section-number">10.1</span> Le théorème central limite</a></li>
<li><a class="nav-link" href="#inf%C3%A9rence-avec-la-distribution-normale-sur-une-unit%C3%A9"><span class="header-section-number">10.2</span> Inférence avec la distribution normale sur une unité</a></li>
<li><a class="nav-link" href="#inf%C3%A9rence-avec-la-distribution-normale-sur-un-%C3%A9chantillon"><span class="header-section-number">10.3</span> Inférence avec la distribution normale sur un échantillon</a></li>
<li><a class="nav-link" href="#la-distribution-t"><span class="header-section-number">10.4</span> La distribution-\(t\)</a></li>
<li><a class="nav-link" href="#le-test-t-%C3%A0-%C3%A9chantillon-unique"><span class="header-section-number">10.5</span> Le test-\(t\) à échantillon unique</a></li>
<li><a class="nav-link" href="#critiques-des-tests-dhypoth%C3%A8ses"><span class="header-section-number">10.6</span> Critiques des tests d’hypothèses</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/quantmeth/MQR/blob/master/10-Inferer.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/quantmeth/MQR/edit/master/10-Inferer.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Méthodes quantitatives avec R</strong>" was written by P.-O. Caron. It was last built on 2023-03-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
