<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 12 Simuler | Méthodes quantitatives avec R</title>
<meta name="author" content="P.-O. Caron">
<meta name="description" content="Dans plusieurs contextes statistiques, les informations cruciales nécessaires pour réaliser une analyse statistique ou tirer des résultats spécifiques ne sont pas connues (par exemple, le chapitre...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content=" 12 Simuler | Méthodes quantitatives avec R">
<meta property="og:type" content="book">
<meta property="og:url" content="mqr.teluq.ca/simuler.html">
<meta property="og:description" content="Dans plusieurs contextes statistiques, les informations cruciales nécessaires pour réaliser une analyse statistique ou tirer des résultats spécifiques ne sont pas connues (par exemple, le chapitre...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 12 Simuler | Méthodes quantitatives avec R">
<meta name="twitter:description" content="Dans plusieurs contextes statistiques, les informations cruciales nécessaires pour réaliser une analyse statistique ou tirer des résultats spécifiques ne sont pas connues (par exemple, le chapitre...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- 
    \(
    \newcommand{\EX}{\mathbb{E}}
    \)
    --><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Méthodes quantitatives avec R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bienvenue!</a></li>
<li><a class="" href="pr%C3%A9face.html">Préface</a></li>
<li class="book-part">Rudiments</li>
<li><a class="" href="commencer.html"><span class="header-section-number">1</span> Commencer</a></li>
<li><a class="" href="programmer.html"><span class="header-section-number">2</span> Programmer</a></li>
<li><a class="" href="calculer.html"><span class="header-section-number">3</span> Calculer</a></li>
<li><a class="" href="r%C3%A9diger.html"><span class="header-section-number">4</span> Rédiger</a></li>
<li><a class="" href="exercice-rudiments.html">Exercices</a></li>
<li class="book-part">Jeux de données</li>
<li><a class="" href="entrer.html"><span class="header-section-number">5</span> Entrer</a></li>
<li><a class="" href="importer.html"><span class="header-section-number">6</span> Importer</a></li>
<li><a class="" href="manipuler.html"><span class="header-section-number">7</span> Manipuler</a></li>
<li><a class="" href="visualiser.html"><span class="header-section-number">8</span> Visualiser</a></li>
<li><a class="" href="exercice-gestion.html">Exercices</a></li>
<li class="book-part">Statistiques</li>
<li><a class="" href="d%C3%A9crire.html"><span class="header-section-number">9</span> Décrire</a></li>
<li><a class="" href="inf%C3%A9rer.html"><span class="header-section-number">10</span> Inférer</a></li>
<li><a class="" href="analyser.html"><span class="header-section-number">11</span> Analyser</a></li>
<li><a class="active" href="simuler.html"><span class="header-section-number">12</span> Simuler</a></li>
<li><a class="" href="exercice-analyse.html">Exercices</a></li>
<li class="book-part">Modèles linéaires</li>
<li><a class="" href="comparer.html"><span class="header-section-number">13</span> Comparer</a></li>
<li><a class="" href="pr%C3%A9dire.html"><span class="header-section-number">14</span> Prédire</a></li>
<li><a class="" href="cr%C3%A9er.html"><span class="header-section-number">15</span> Créer</a></li>
<li><a class="" href="m%C3%A9dier.html"><span class="header-section-number">16</span> Médier</a></li>
<li><a class="" href="mod%C3%A9rer.html"><span class="header-section-number">17</span> Modérer</a></li>
<li><a class="" href="exercice-lineaire.html">Exercices</a></li>
<li class="book-part">Analyses factorielles</li>
<li><a class="" href="d%C3%A9composer.html"><span class="header-section-number">18</span> Décomposer</a></li>
<li><a class="" href="explorer.html"><span class="header-section-number">19</span> Explorer</a></li>
<li><a class="" href="r%C3%A9duire.html"><span class="header-section-number">20</span> Réduire</a></li>
<li><a class="" href="exercice-factoriel.html">Exercices</a></li>
<li class="book-part">Annexes</li>
<li><a class="" href="solutions.html">Solutions</a></li>
<li><a class="" href="r%C3%A9f%C3%A9rences.html">Références</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/quantmeth/MQR">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="simuler" class="section level1" number="12">
<h1>
<span class="header-section-number"> 12</span> Simuler<a class="anchor" aria-label="anchor" href="#simuler"><i class="fas fa-link"></i></a>
</h1>
<p>Dans plusieurs contextes statistiques, les informations cruciales nécessaires pour réaliser une analyse statistique ou tirer des résultats spécifiques ne sont pas connues (par exemple, le chapitre <a href="analyser.html#analyser">Analyser</a> présente des analyses soutenues par des théorèmes). Pire, parfois certains postulats sont violés rendant les démarches usuelles caduques. Enfin, dans certains contextes, une analyse formelle pourrait s’avérer fort complexe, voire irrésolvable, alors qu’une analyse plus empirique usant des techniques de rééchantillonnage résoudra ces problèmes simplement et immédiatement.</p>
<p>Jusqu’à présent, les situations connues des analyses statistiques ont été présentées. Maintenant, les techniques de rééchantillonnage, comme le bootstrap et de simulations Monte-Carlo seront présentés.</p>
<div id="les-simulations-monte-carlo" class="section level2" number="12.1">
<h2>
<span class="header-section-number">12.1</span> Les simulations Monte-Carlo<a class="anchor" aria-label="anchor" href="#les-simulations-monte-carlo"><i class="fas fa-link"></i></a>
</h2>
<p>Les simulations Monte-Carlo sont une famille de méthode algorithmique qui permet de calculer une valeur numérique en utilisant des procédés aléatoires. Le nom provient du prestigieux casino de Monte-Carlo à Monaco sur la Côte d’Azur, où des jeux de hasard se jouent constamment, et ayant ainsi une connotation très forte avec le hasard et les nombres aléatoires.</p>
<p>Une simulation de Monte-Carlo prédit une étendue de résultats possibles à partir d’un ensemble de valeurs d’entrée fixes et en tenant compte de l’incertitude inhérente de certaines variables. En d’autres termes, une simulation de Monte-Carlo produit les résultats possibles (sorties) d’un modèle à partir des entrées fixes et d’autres entrées variables. Ces sorties sont calculées encore et encore (des milliers de fois, parfois plus), en utilisant à chaque fois un ensemble différent de nombres aléatoires, générant des sorties probables, mais différentes à chaque fois. Les estimations (et leur tendance) obtenues peuvent alors être interprétées.</p>
<p>Les simulations Monte-Carlo sont particulièrement utiles, car elles permettent, en mathématiques, de calculer des intégrales très complexes; en physique, d’estimer la forme d’un signal ou la sensibilité; en finance, de recréer des conditions permettant de prévoir le marché; et en psychologie, de simuler des processus comportementaux ou cognitifs.</p>
<p>Les simulations Monte-Carlo possèdent trois caractéristiques :</p>
<ol style="list-style-type: decimal">
<li><p>Construire un modèle ayant des variables indépendantes (entrées) et dépendantes (sorties);</p></li>
<li><p>Spécifier les caractéristiques aléatoires des variables indépendantes et définir des valeurs crédibles;</p></li>
<li><p>Rouler les simulations de façon répétitive jusqu’à ce que suffisamment d’itérations soient produites et que les résultats convergent vers une solution.</p></li>
</ol>
<p>Maintenant, ces étapes sont mises en contexte avec un problème.</p>
<div id="le-problème-de-monty-hall" class="section level3" number="12.1.1">
<h3>
<span class="header-section-number">12.1.1</span> Le problème de Monty-Hall<a class="anchor" aria-label="anchor" href="#le-probl%C3%A8me-de-monty-hall"><i class="fas fa-link"></i></a>
</h3>
<p>Rien de mieux pour confronter le sens commun que d’être confronté à un problème contre-intuitif. Les simulations Monte-Carlo nous permettront de vérifier les résultats de façon empirique, parallèlement à ce qu’une analyse formelle fournit.</p>
<p>Le problème de Monty Hall <span class="citation">(attribuables à <a href="r%C3%A9f%C3%A9rences.html#ref-Selvin75" role="doc-biblioref">Selvin, 1975</a>)</span> présente un joueur devant un présentateur (Monty Hall). Trois portes sont offertes au choix du joueur. Derrière l’une d’entre elles se retrouve un magnifique prix : une voiture <em>électrique</em> de luxe. Derrière chacune des deux autres portes se retrouvent un prix citron : une chèvre chacune. Le joueur ne sait pas ce qu’il y derrière les portes. Le joueur peut alors choisir une porte. Évidemment, à ce moment le joueur à une chance sur trois de choisir la voiture.</p>
<div class="figure">
<span style="display:block;" id="fig:MH"></span>
<img src="12-Simuler_files/figure-html/MH-1.png" alt="Illustration du problème de Monty Hall" width="672"><p class="caption">
Figure 12.1: Illustration du problème de Monty Hall
</p>
</div>
<p>Par la suite, le présentateur, qui connaît le contenu derrière les portes, ouvre une porte qui (a) ne cache pas la voiture et (b) que le participant n’a pas choisie. Le joueur peut alors choisir (a) de conserver la porte choisie ou (b) de changer de porte. Quelle option, s’il y en a une, assurera la meilleure probabilité de choisir la voiture? Rester ou changer? Par exemple, suivant l’illustration de la Figure <a href="simuler.html#fig:MH">12.1</a>, le joueur choisit la porte 1, alors le présentateur doit ouvrir la porte 2 (non choisie et ne contient pas la voiture). Le joueur doit-il changer son choix? Ici, la réponse est évidente, car la réponse est connue. Qu’en est-il alors si le joueur avait choisi la porte 3 et le présentateur ouvre l’une des deux autres porte? <em>Le joueur doit-il changer ou rester?</em> La question sous-jacente est qu’elles sont les probabilités de rester et de changer respectivement. Sont-elles différentes?</p>
<p>Comme le résultat n’est pas des plus intuitif (et sans divulgâcher le résultat), une petite simulation s’impose (ou une analyse formelle pour les lecteurs enclins mathématiquement). La situation sera recréée un millier de fois pour vérifier l’option (rester ou changer) qui maximise de gagner la voiture.</p>
<p>En se référant aux trois points caractérisant une simulation Monte-Carlo susmentionné :</p>
<ol style="list-style-type: decimal">
<li><p>Le problème de Monty Hall tel qu’imminemment décrit.</p></li>
<li><p>Les variables indépendantes sont</p></li>
</ol>
<ul>
<li><p>le tirage aléatoire du contenu derrière les portes (distribution uniforme, chaque porte à la même probabilité d’avoir un prix ou non);</p></li>
<li><p>le choix du joueur (distribution uniforme, pourrait être différent), et;</p></li>
<li><p>la porte ouverte par le présentateur,</p></li>
<li><p>l’action de rester ou de changer (les deux options sont étudiées).</p></li>
</ul>
<p>Il y a une variable dépendante :</p>
<ul>
<li>le succès (gagner le prix) ou l’échec (choisir la mauvaise porte).</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>La simulation est reprise 1000 fois.</li>
</ol>
<p>Les étapes de la simulation se déroulent ainsi.</p>
<ol style="list-style-type: decimal">
<li><p>L’attribution des portes (une gagnante et deux perdantes) est faite aléatoirement<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Il est intéressant de noter que, sur le plan de computationnelle, il est inutile de tirer aléatoirement la porte gagnante. Aussi longtemps que le &lt;em&gt;participant&lt;/em&gt; agit comme si elle était tirée au hasard, il n’est pas nécessaire qu’elle le soit. Par contre, une stratégie systématique, comme toujours choisir la porte 1, oblige le recours au tirage aléatoire des portes. Le scénario sera toutefois plus acceptable pour le lecteur capricieux.&lt;/p&gt;"><sup>10</sup></a>.</p></li>
<li><p>Le joueur fait son premier choix.</p></li>
</ol>
<p>Plusieurs modèles peuvent être utilisés, comme systématiquement choisir la même porte, ce qui simplifie la situation et ne change pas les probabilités, car le contenu derrière les portes est aléatoire. Pour rester vrai à la situation, le joueur fait un choix aléatoire.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Le comportement du présentateur s’enclenche, il doit “ouvrir” une porte non choisie et qui ne contient pas le prix.</p></li>
<li><p>Les deux stratégies sont simulées, <em>rester</em> ou <em>changer</em>.</p></li>
<li><p>La simulation enregistre s’il y a eu gain ou non et l’additionne au total de chacun.</p></li>
<li><p>La simulation est reprise un nombre important de fois, ici, 1000 suffit, mais des situations compliquées peuvent demander beaucoup plus d’itérations.</p></li>
</ol>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="simuler.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation du problème de Monty Hall</span></span>
<span id="cb153-2"><a href="simuler.html#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Valeurs possibles des portes</span></span>
<span id="cb153-3"><a href="simuler.html#cb153-3" aria-hidden="true" tabindex="-1"></a>portes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Chèvre"</span>, <span class="st">"Chèvre"</span>, <span class="st">"Voiture"</span>)</span>
<span id="cb153-4"><a href="simuler.html#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de répétitions</span></span>
<span id="cb153-5"><a href="simuler.html#cb153-5" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb153-6"><a href="simuler.html#cb153-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la reproductibilité</span></span>
<span id="cb153-7"><a href="simuler.html#cb153-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7896</span>)</span>
<span id="cb153-8"><a href="simuler.html#cb153-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-9"><a href="simuler.html#cb153-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Valeur initiale des gains</span></span>
<span id="cb153-10"><a href="simuler.html#cb153-10" aria-hidden="true" tabindex="-1"></a>gain.rester <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb153-11"><a href="simuler.html#cb153-11" aria-hidden="true" tabindex="-1"></a>gain.changer <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb153-12"><a href="simuler.html#cb153-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-13"><a href="simuler.html#cb153-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Boucle pour répéter `nreps` fois le scénario</span></span>
<span id="cb153-14"><a href="simuler.html#cb153-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nreps){</span>
<span id="cb153-15"><a href="simuler.html#cb153-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-16"><a href="simuler.html#cb153-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arrangement initial des portes</span></span>
<span id="cb153-17"><a href="simuler.html#cb153-17" aria-hidden="true" tabindex="-1"></a>  tirage <span class="ot">&lt;-</span> <span class="fu">sample</span>(portes)</span>
<span id="cb153-18"><a href="simuler.html#cb153-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-19"><a href="simuler.html#cb153-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Trouver le prix</span></span>
<span id="cb153-20"><a href="simuler.html#cb153-20" aria-hidden="true" tabindex="-1"></a>  prix <span class="ot">&lt;-</span> <span class="fu">which</span>(tirage <span class="sc">%in%</span> <span class="st">"Voiture"</span>)</span>
<span id="cb153-21"><a href="simuler.html#cb153-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-22"><a href="simuler.html#cb153-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Choix aléatoire</span></span>
<span id="cb153-23"><a href="simuler.html#cb153-23" aria-hidden="true" tabindex="-1"></a>  choix1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">length</span>(portes), <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb153-24"><a href="simuler.html#cb153-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-25"><a href="simuler.html#cb153-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sélectionner la porte avec la chèvre (pas un prix) et</span></span>
<span id="cb153-26"><a href="simuler.html#cb153-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># qui n'est pas celle choisie (choix1)</span></span>
<span id="cb153-27"><a href="simuler.html#cb153-27" aria-hidden="true" tabindex="-1"></a>  option <span class="ot">&lt;-</span> <span class="fu">c</span>(choix1, prix)</span>
<span id="cb153-28"><a href="simuler.html#cb153-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-29"><a href="simuler.html#cb153-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(choix1 <span class="sc">!=</span> prix){</span>
<span id="cb153-30"><a href="simuler.html#cb153-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb153-31"><a href="simuler.html#cb153-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Si une porte valide</span></span>
<span id="cb153-32"><a href="simuler.html#cb153-32" aria-hidden="true" tabindex="-1"></a>    monty <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)[<span class="sc">-</span>option]</span>
<span id="cb153-33"><a href="simuler.html#cb153-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb153-34"><a href="simuler.html#cb153-34" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb153-35"><a href="simuler.html#cb153-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb153-36"><a href="simuler.html#cb153-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Si deux portes valides, en choisir une aléatoirement.</span></span>
<span id="cb153-37"><a href="simuler.html#cb153-37" aria-hidden="true" tabindex="-1"></a>    monty <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)[<span class="sc">-</span>option], <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb153-38"><a href="simuler.html#cb153-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb153-39"><a href="simuler.html#cb153-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb153-40"><a href="simuler.html#cb153-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-41"><a href="simuler.html#cb153-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Décision : Reste à choix1</span></span>
<span id="cb153-42"><a href="simuler.html#cb153-42" aria-hidden="true" tabindex="-1"></a>  choix.rester <span class="ot">&lt;-</span> choix1</span>
<span id="cb153-43"><a href="simuler.html#cb153-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-44"><a href="simuler.html#cb153-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Décision : Changer de choix changer</span></span>
<span id="cb153-45"><a href="simuler.html#cb153-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Changer = ne pas prendre la porte initial, ni la porte ouverte</span></span>
<span id="cb153-46"><a href="simuler.html#cb153-46" aria-hidden="true" tabindex="-1"></a>  choix.changer <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)[<span class="sc">-</span><span class="fu">c</span>(choix1, monty)]</span>
<span id="cb153-47"><a href="simuler.html#cb153-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb153-48"><a href="simuler.html#cb153-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Enregistrement des gains</span></span>
<span id="cb153-49"><a href="simuler.html#cb153-49" aria-hidden="true" tabindex="-1"></a>  gain.rester  <span class="ot">&lt;-</span> gain.rester  <span class="sc">+</span> </span>
<span id="cb153-50"><a href="simuler.html#cb153-50" aria-hidden="true" tabindex="-1"></a>                   (tirage[choix.rester]  <span class="sc">==</span> <span class="st">"Voiture"</span>)</span>
<span id="cb153-51"><a href="simuler.html#cb153-51" aria-hidden="true" tabindex="-1"></a>  gain.changer <span class="ot">&lt;-</span> gain.changer <span class="sc">+</span> </span>
<span id="cb153-52"><a href="simuler.html#cb153-52" aria-hidden="true" tabindex="-1"></a>                   (tirage[choix.changer] <span class="sc">==</span> <span class="st">"Voiture"</span>)</span>
<span id="cb153-53"><a href="simuler.html#cb153-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb153-54"><a href="simuler.html#cb153-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-55"><a href="simuler.html#cb153-55" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(gain.rester, gain.changer) <span class="sc">/</span> nreps</span>
<span id="cb153-56"><a href="simuler.html#cb153-56" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      gain.rester gain.changer</span>
<span id="cb153-57"><a href="simuler.html#cb153-57" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>,]       <span class="fl">0.316</span>        <span class="fl">0.684</span></span></code></pre></div>
<p>Une petite digression avant de poursuivre. <em>Il faut être naïf pour croire que le code fonctionne tel que prévu</em>. À cause d’un inconvénient de la fonction <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code>, une approche conditionnelle doit être utilisée. En fait, la fonction échantillonne les éléments de <code>x</code> (premier argument) jusqu’à obtenir <code>size</code> objets. Par contre, si une seule valeur est donnée à <code>x</code> et qu’elle est numérique, alors la fonction utilise les éléments de <code>1:x</code> pour rééchantillonner au lieu de retourner <code>x</code>. Ainsi, si le choix et le prix (porte 2) sont derrière des portes différentes (porte 1 et 2, par exemple), alors une seule valeur est retournée (3), et <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code> utilise <code>1:3</code> au lieu de <code>3</code>. Ces particularités expliquent et justifient l’utilisation d’une formule conditionnelle. En programmation, il faut toujours s’assurer que les fonctions s’accordent avec les attentes. Ce cas est documenté et délibéré (voir <code><a href="https://rdrr.io/r/base/sample.html">?sample</a></code>), mais surprend.</p>
<p>Quelles sont les résultats de cette simulation? Le fait de <em>rester</em> sur le premier choix devrait obtenir 33% de chance de réussir, comme le joueur a initialement une chance sur trois d’avoir la bonne réponse. Qu’en est-il pour <em>changer</em>? Est-ce qu’ouvrir une porte <em>chèvre</em> modifie les probabilités? Les résultats de la simulation montre que <em>rester</em> gagne 31.6% et que <em>changer</em> gagne 68.4%. À long terme, il est plus avantageux de changer.</p>
<p>Une explication simple est de dénombrer les possibilités. Dans le cas où le joueur ne change pas d’idée, il a une chance sur trois, soit : choisir la chèvre 1, et garder la chèvre 1; choisir la chèvre 2, et garder la chèvre 2; et choisir la voiture, et garder la voiture. Si le joueur change d’idée <strong>après l’ouverture des portes</strong>, les chances sont maintenant de deux sur trois, soit choisir la chèvre 1, changer pour le prix; choisir la chèvre 2 et changer pour le prix; ou choisir le prix et changer pour une chèvre.</p>
<p>Une autre façon de rendre se problème plus intuitif est de considérer le problème avec 100 portes au lieu de 3. Le présentateur ouvre les 98 portes qui ne sont pas un prix. Si le joueur choisit une porte et garde, il a effectivement 1% de chance de remporter le prix. Par contre, s’il choisit une porte et que le présentateur lui ouvre toutes les autres portes chèvres, le joueur gagne à tout les coups s’il change, <strong>sauf</strong> s’il a choisi le prix au premier coup. C’est un peu comme si le participant ouvrait les 99 portent, sauf celle qu’il a choisit au début.</p>
<p>Avec quelques modifications de la syntaxe précédente, le code suivant illustre le cas à 100 portes. À noter que l’usage du conditionnelle n’est plus nécessaire au bon fonctionnement de <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code>, car il y a maintenant plus de trois portes.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="simuler.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation du problème de Monty Hall</span></span>
<span id="cb154-2"><a href="simuler.html#cb154-2" aria-hidden="true" tabindex="-1"></a>portes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Voiture"</span>, <span class="fu">rep</span>(<span class="st">"Chèvre"</span>, <span class="dv">99</span>))</span>
<span id="cb154-3"><a href="simuler.html#cb154-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(portes)</span>
<span id="cb154-4"><a href="simuler.html#cb154-4" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb154-5"><a href="simuler.html#cb154-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7896</span>)</span>
<span id="cb154-6"><a href="simuler.html#cb154-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-7"><a href="simuler.html#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Valeur initial des gains</span></span>
<span id="cb154-8"><a href="simuler.html#cb154-8" aria-hidden="true" tabindex="-1"></a>gain.rester <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb154-9"><a href="simuler.html#cb154-9" aria-hidden="true" tabindex="-1"></a>gain.changer <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb154-10"><a href="simuler.html#cb154-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-11"><a href="simuler.html#cb154-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nreps){</span>
<span id="cb154-12"><a href="simuler.html#cb154-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arrangement initial des portes</span></span>
<span id="cb154-13"><a href="simuler.html#cb154-13" aria-hidden="true" tabindex="-1"></a>  tirage <span class="ot">&lt;-</span> <span class="fu">sample</span>(portes)</span>
<span id="cb154-14"><a href="simuler.html#cb154-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb154-15"><a href="simuler.html#cb154-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Trouver le prix</span></span>
<span id="cb154-16"><a href="simuler.html#cb154-16" aria-hidden="true" tabindex="-1"></a>  prix <span class="ot">&lt;-</span> <span class="fu">which</span>(tirage <span class="sc">%in%</span> <span class="st">"Voiture"</span>)</span>
<span id="cb154-17"><a href="simuler.html#cb154-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb154-18"><a href="simuler.html#cb154-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Choix aléatoire</span></span>
<span id="cb154-19"><a href="simuler.html#cb154-19" aria-hidden="true" tabindex="-1"></a>  choix1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(n, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb154-20"><a href="simuler.html#cb154-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb154-21"><a href="simuler.html#cb154-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sélectionner la porte avec la chèvre (pas un prix) et</span></span>
<span id="cb154-22"><a href="simuler.html#cb154-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># qui n'est pas celle choisie (choix1)</span></span>
<span id="cb154-23"><a href="simuler.html#cb154-23" aria-hidden="true" tabindex="-1"></a>  option <span class="ot">&lt;-</span> <span class="fu">c</span>(choix1, prix)</span>
<span id="cb154-24"><a href="simuler.html#cb154-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb154-25"><a href="simuler.html#cb154-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Les autres portes</span></span>
<span id="cb154-26"><a href="simuler.html#cb154-26" aria-hidden="true" tabindex="-1"></a>  monty <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n)[<span class="sc">-</span>option], <span class="at">size =</span> n <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb154-27"><a href="simuler.html#cb154-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb154-28"><a href="simuler.html#cb154-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Décision : Reste à choix1</span></span>
<span id="cb154-29"><a href="simuler.html#cb154-29" aria-hidden="true" tabindex="-1"></a>  choix.rester <span class="ot">&lt;-</span> choix1</span>
<span id="cb154-30"><a href="simuler.html#cb154-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb154-31"><a href="simuler.html#cb154-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Décision : Changer de choix changer</span></span>
<span id="cb154-32"><a href="simuler.html#cb154-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Changer = ne pas prendre la porte initial, ni la porte ouverte</span></span>
<span id="cb154-33"><a href="simuler.html#cb154-33" aria-hidden="true" tabindex="-1"></a>  choix.changer <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n)[<span class="sc">-</span><span class="fu">c</span>(choix1, monty)]</span>
<span id="cb154-34"><a href="simuler.html#cb154-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb154-35"><a href="simuler.html#cb154-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Enregistrement des gains</span></span>
<span id="cb154-36"><a href="simuler.html#cb154-36" aria-hidden="true" tabindex="-1"></a>  gain.rester <span class="ot">&lt;-</span> gain.rester <span class="sc">+</span> </span>
<span id="cb154-37"><a href="simuler.html#cb154-37" aria-hidden="true" tabindex="-1"></a>                  (tirage[choix.rester] <span class="sc">==</span> <span class="st">"Voiture"</span>)</span>
<span id="cb154-38"><a href="simuler.html#cb154-38" aria-hidden="true" tabindex="-1"></a>  gain.changer <span class="ot">&lt;-</span> gain.changer <span class="sc">+</span> </span>
<span id="cb154-39"><a href="simuler.html#cb154-39" aria-hidden="true" tabindex="-1"></a>                  (tirage[choix.changer] <span class="sc">==</span> <span class="st">"Voiture"</span>)</span>
<span id="cb154-40"><a href="simuler.html#cb154-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb154-41"><a href="simuler.html#cb154-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-42"><a href="simuler.html#cb154-42" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(gain.rester,gain.changer)  <span class="sc">/</span> nreps</span>
<span id="cb154-43"><a href="simuler.html#cb154-43" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      gain.rester gain.changer</span>
<span id="cb154-44"><a href="simuler.html#cb154-44" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>,]       <span class="fl">0.009</span>        <span class="fl">0.991</span></span></code></pre></div>
<p>La simulation montre que rester gagne 0.9% et que changer gagne 99.1%.</p>
<p>Des situations fort plus compliquées pourraient être apportées en simulations Monte-Carlo. Le jeu de Black Jack en est un exemple, bien qu’il soit déjà résolu pour des résultats optimaux <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-Millman83" role="doc-biblioref">Millman, 1983</a>)</span>. Peu importe la situation à simuler, il suffit d’avoir la patience de la programmer pour confirmer les résultats analytiques.</p>
<p>Sur le plan pratique pour l’expérimentateur, les simulations Monte-Carlo peuvent être utiles pour calculer des tailles d’échantillons pour des modèles complexes, comme des modèles par équations structurelles compliquées, multiniveaux ou de classes latentes. Il peut être utile également pour imiter des processus cognitifs ou comportementaux. Toutefois, une sous-famille est d’une importance significative pour l’expérimentateur, celle qui sera abordée maintenant, le bootstrap.</p>
</div>
</div>
<div id="le-bootstrap" class="section level2" number="12.2">
<h2>
<span class="header-section-number">12.2</span> Le bootstrap<a class="anchor" aria-label="anchor" href="#le-bootstrap"><i class="fas fa-link"></i></a>
</h2>
<p>Le <em>bootstrap</em> (dont il n’y a pas d’excellente traduction en français) est une des techniques de rééchantillonnage astucieuses permettant des inférences statistiques <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-Efron79" role="doc-biblioref">Efron &amp; Tibshriani, 1979</a>)</span>. Il fait partie de la famille des simulations Monte-Carlo, car il se base sur la réitération multiple d’une statistique à partir d’un jeu de données. Sans vouloir entrer dans les détails, il existe plusieurs types de techniques de bootstrap, qui font elles-mêmes parties d’une plus grande famille, les simulations stochastiques. Y est inclus les simulations de Monte-Carlo (dont le bootstrap fait parti) ou les méthodes numériques bayésiennes.</p>
<p>Cet ouvrage insiste sur le bootstrap non paramétrique, impliquant que les distributions sous-jacentes aux échantillons ne soient pas spécifiées, bien qu’il existe du bootstrap paramétrique. Ce type de bootstrap est certainement la plus utile pour l’expérimentateur.</p>
<p>Dans le bootstrap, l’échantillon initial est considéré comme une pseudopopulation. Il ne nécessite pas d’autre information que celle fournie par l’échantillon. Il permet d’obtenir une distribution d’échantillonnage et tous ses bénéfices. Alors que dans les chapitres <a href="inf%C3%A9rer.html#inf%C3%A9rer">Inférer</a> et <a href="analyser.html#analyser">Analyser</a>, il faut préciser et connaître quelle distribution d’échantillonnage correspond à quelle statistique (p. ex., le score-<span class="math inline">\(z\)</span> d’une unité à la distribution normale; la moyenne d’un échantillon à la distribution <span class="math inline">\(t\)</span> si la variance est inconnue), aucune de ces connaissances n’est nécessaire. L’étendue d’application du bootstrap est immense, surtout pour les concepts statistiques qui offriront plus de défis, ce qui sera vu dans des chapitres ultérieurs.</p>
<p>Comme abordé dans le chapitre <a href="inf%C3%A9rer.html#inf%C3%A9rer">Inférer</a>, la distribution d’échantillonnage permet :</p>
<ul>
<li><p>d’estimer l’indice désiré;</p></li>
<li><p>d’estimer son erreur standard;</p></li>
<li><p>d’estimer ses intervalles de confiance;</p></li>
<li><p>de réaliser un test d’hypothèse;</p></li>
</ul>
<p>tout cela en ignorant les distributions et postulats sous-jacents qui empêchent ou limitent leurs usages. Le bootstrap n’a que deux hypothèses fondamentales : l’échantillon reflète la population et chaque unité est indépendante et identiquement distribuée. Autrement dit, chaque unité provienne bel et bien d’une même boîte (<em>population</em>, voir <a href="inf%C3%A9rer.html#inf%C3%A9rer">Inférer</a>) et le tirage d’une unité n’en influence celle d’une autre.</p>
<p>Le fondement du bootstrap repose sur les étapes suivantes :</p>
<ol style="list-style-type: decimal">
<li><p>Sélectionner avec remise les unités d’un échantillon;</p></li>
<li><p>Calculer et enregistrer l’indice statistique désiré auprès de ce nouvel échantillon;</p></li>
<li><p>Réitérer les deux premières étapes un nombre élevé de fois.</p></li>
</ol>
<p>Ce processus hautement facilité par l’excellente performance des ordinateurs d’aujourd’hui, se réalise très facilement et rapidement. L’exemple suivant se base sur le rééchantillonnage (1000 fois) de la moyenne à partir d’une variable aléatoire tirée d’une distribution uniforme avec un minimum de 5 et d’une maximum de 15.</p>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">158</span><span class="op">)</span></span>
<span><span class="co"># Nombre d'unités</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span></span>
<span><span class="co"># Le nombre de rééchantillonnage</span></span>
<span><span class="va">nreps</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span></span>
<span><span class="co"># Création de la variable</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, min <span class="op">=</span> <span class="fl">5</span>, max <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Création d'une variable vide pour l'enregistrement</span></span>
<span><span class="va">moyenne.X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># L'utilisation d'une boucle permet de réitérer les étapes</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nreps</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># Rééchantillonnage avec remise</span></span>
<span>  <span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Nouvel échantillon</span></span>
<span>  <span class="va">nouveau.X</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">id</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Calculer et enregistrer la moyenne</span></span>
<span>  <span class="va">moyenne.X</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">nouveau.X</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>La fonction <code>sample(, replace = TRUE)</code> rééchantillonne avec remplacement les identifiants des unités. Par simplicité, il est possible d’éliminer la ligne <code>nouveau.X = X[id]</code> en utilisant <code>mean(X[id])</code> ou plus simplement <code>mean(sample(X, replace = TRUE))</code>. Cette utilisation se limite seulement au cas d’un vecteur de données. S’il s’agit d’un jeu de données avec plus d’une variable, alors <code>mean(X[id, ])</code> est utilisée. Noter l’usage de la <code>,</code> entre crochets. De cette façon, toutes les variables des unités identifiées par <code>id</code> sont extraites (voir <a href="manipuler.html#r%C3%A9f%C3%A9rer-%C3%A0-une-variable-dans-un-jeu-de-donn%C3%A9es">Référer à une variable dans un jeu de données</a>).</p>
<p>À partir des informations obtenues, des inférences statistiques sont possibles. Toutes les estimations sont présentées comme un histogramme tel que l’illustre la Figure <a href="simuler.html#fig:histmh2">12.2</a>. Le code se retrouve ci-dessous. Quelques formules pour améliorer la présentation se retrouvent dans la syntaxe. L’utilisation simple de <code><a href="https://rdrr.io/r/graphics/hist.html">hist()</a></code> pourra convenir.</p>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">moyenne.X</span>,              <span class="co"># Données</span></span>
<span>     ylab <span class="op">=</span> <span class="st">" Frequence"</span>,    <span class="co"># Changer l'axe y</span></span>
<span>     main <span class="op">=</span> <span class="st">""</span>,              <span class="co"># Retirer le titre</span></span>
<span>     breaks <span class="op">=</span> <span class="fl">50</span>,            <span class="co"># Nombre de colonnes</span></span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">13</span><span class="op">)</span>          <span class="co"># Définir l'étendu de l'axe x</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:histmh2"></span>
<img src="12-Simuler_files/figure-html/histmh2-1.png" alt="Historgamme des estimations des échantillons" width="672"><p class="caption">
Figure 12.2: Historgamme des estimations des échantillons
</p>
</div>
<p>La distribution de la Figure <a href="simuler.html#fig:histmh2">12.2</a> se désigne comme la distribution d’échantillionnage, comme c’est le cas dans le chapitre sur les inférences <a href="inf%C3%A9rer.html#inf%C3%A9rer">Inférer</a>. Elle agit comme distribution de la <em>population</em> de l’indice. Elle permet d’avoir une estimation plus robuste de l’erreur standard, qui se trouve à être l’écart type des indices rééchantillonnés. Elle est également utilisée pour construire des intervalles de confiance et permet ainsi de faire des tests d’hypothèse comme : l’intervalle de confiance à <span class="math inline">\((1-\alpha) \times 100\)</span> % contient-elle la valeur 0? Comme il est fait avec une hypothèse nulle traditionnelle.</p>
<p>Le cas illustré est trivial au sens où, par le théorème central limite, la distribution des moyennes est déjà connue. Si l’exemple était plutôt sur la médiane, il faudrait obligatoirement procéder par bootstrap pour calculer son erreur type et ses intervalles de confiance, car aucune formule exacte ne permet sa dérivation (il existe bien des approximations cela dit). Le bootstrap est alors des plus appropriés pour calculer l’erreur type et en tirer des intervalles de confiances, voire même en faire des tests d’hypothèses. Plusieurs statistiques auront recours au bootstrap pour dériver ces informations, la plus utilisée étant le coefficient de détermination (voir le chapitre sur la <a href="pr%C3%A9dire.html#pr%C3%A9dire">régression</a>) ou la <a href="m%C3%A9dier.html#m%C3%A9dier">médiation</a> pour tester les effets indirects.</p>
<p>À partir des informations obtenues auprès du rééchantillonnage, il est possible d’obtenir les éléments désirés. Comme le cas est trivial, les indices statistiques seront très similaires. Cela confirmera au lecteur qu’aucun principe ésotérique ne s’est déroulé devant ses yeux en plus de confirmer que les statistiques attendues se produisent effectivement.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="simuler.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Voici la moyenne et l'erreur standard originales</span></span>
<span id="cb157-2"><a href="simuler.html#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X) ; <span class="fu">sd</span>(X)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb157-3"><a href="simuler.html#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">10.2</span></span>
<span id="cb157-4"><a href="simuler.html#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.485</span></span>
<span id="cb157-5"><a href="simuler.html#cb157-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-6"><a href="simuler.html#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="co"># La moyenne et l'erreur standard à partir des rééchantillons</span></span>
<span id="cb157-7"><a href="simuler.html#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(moyenne.X)  ; <span class="fu">sd</span>(moyenne.X)</span>
<span id="cb157-8"><a href="simuler.html#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">10.2</span></span>
<span id="cb157-9"><a href="simuler.html#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.481</span></span></code></pre></div>
<p>La moyenne et l’erreur standard sont très près de la moyenne de l’échantillon et celle de la population (qui est de 10) et de l’erreur type attendue. Il est possible de créer des intervalles de confiances avec la fonction <code>quantile</code> qui prend en argument un vecteur de données et les probabilités désirées. Dans le cas de 95% pour une erreur de type I de 5%, soit <span class="math inline">\(\alpha=.05\)</span>, il s’agit de <span class="math inline">\(.05/2 = .025\)</span> et <span class="math inline">\(1-.05/2= .975\)</span>, laissant au total 5% aux extrémités.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="simuler.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Erreur de type I</span></span>
<span id="cb158-2"><a href="simuler.html#cb158-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb158-3"><a href="simuler.html#cb158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-4"><a href="simuler.html#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Valeurs critiques</span></span>
<span id="cb158-5"><a href="simuler.html#cb158-5" aria-hidden="true" tabindex="-1"></a>crit <span class="ot">&lt;-</span> <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, (<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb158-6"><a href="simuler.html#cb158-6" aria-hidden="true" tabindex="-1"></a>tv <span class="ot">&lt;-</span> <span class="fu">qt</span>(crit, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb158-7"><a href="simuler.html#cb158-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-8"><a href="simuler.html#cb158-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalles basés sur les indices de l'échantillon</span></span>
<span id="cb158-9"><a href="simuler.html#cb158-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X) <span class="sc">+</span> tv <span class="sc">*</span> <span class="fu">sd</span>(X)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb158-10"><a href="simuler.html#cb158-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>]  <span class="fl">9.2</span> <span class="fl">11.2</span></span>
<span id="cb158-11"><a href="simuler.html#cb158-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-12"><a href="simuler.html#cb158-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalles basés sur les indices du rééchantillonnage</span></span>
<span id="cb158-13"><a href="simuler.html#cb158-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(moyenne.X) <span class="sc">+</span> tv <span class="sc">*</span> <span class="fu">sd</span>(moyenne.X)</span>
<span id="cb158-14"><a href="simuler.html#cb158-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>]  <span class="fl">9.22</span> <span class="fl">11.18</span></span>
<span id="cb158-15"><a href="simuler.html#cb158-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-16"><a href="simuler.html#cb158-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalles sur le rééchantillonnage</span></span>
<span id="cb158-17"><a href="simuler.html#cb158-17" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(moyenne.X, crit)</span>
<span id="cb158-18"><a href="simuler.html#cb158-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  <span class="fl">2.5</span><span class="sc">% 97.5%</span> </span>
<span id="cb158-19"><a href="simuler.html#cb158-19" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  <span class="fl">9.26</span> <span class="fl">11.13</span></span></code></pre></div>
<p>Pour réaliser le test d’hypothèse nulle, il suffit de constater si l’intervalle de confiance contient ou non 0. Dans le cas où l’intervalle contient 0, le test n’est pas significatif; l’hypotèse nulle n’est pas rejetée; il est vraisemblable que l’absence d’effet soit vraie. S’il ne contient pas 0, l’hypothèse nulle est rejetée, le test est significatif et il est vraisemblable qu’il y ait un effet. Dans cet exemple, la moyenne est clairement différente de 0, car elle ne contient pas cette valeur.</p>
<div id="meilleures-pratiques" class="section level3" number="12.2.1">
<h3>
<span class="header-section-number">12.2.1</span> Meilleures pratiques<a class="anchor" aria-label="anchor" href="#meilleures-pratiques"><i class="fas fa-link"></i></a>
</h3>
<p><strong>R</strong> n’est pas particulièrement efficace pour réaliser des boucles. Il existe une famille de fonctions <code>apply</code> qui permet d’appliquer une fonction sur une série de vecteurs (comme une liste, un jeu de données ou une matrice). L’appel à l’aide <code><a href="https://rdrr.io/r/base/apply.html">?apply</a></code> donne beaucoup d’informations à ce sujet.</p>
<p>La fonction principale est <code><a href="https://rdrr.io/r/base/apply.html">apply()</a></code>. Elle nécessite le jeu de données (<code>X</code>) sur lequel appliqué la fonction (<code>FUN</code>) et un argument (<code>MARGIN</code>) pour identifier la dimension selon laquelle il faut appliquer la fonction, comme <code>MARGIN = 1</code> produit l’opération par lignes; <code>MARGIN = 2</code> produit l’opération par colonnes.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Il y a aussi des cas plus complexes lorsque le jeu possède plus de deux dimensions, comme &lt;code&gt;MARGIN = c(1,2)&lt;/code&gt; produit l’opération sur une matrice (lignes par colonnes) ou &lt;code&gt;MARGIN = n&lt;/code&gt; produit l’opération sur la n&lt;sup&gt;e&lt;/sup&gt; dimension.&lt;/p&gt;"><sup>11</sup></a></p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="simuler.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Il faut un vecteur de données `vec`, un nombre de répétitions `nreps`</span></span>
<span id="cb159-2"><a href="simuler.html#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="co"># et une fonction `theta` à calculer sur le vecteur</span></span>
<span id="cb159-3"><a href="simuler.html#cb159-3" aria-hidden="true" tabindex="-1"></a>bootstrap <span class="ot">&lt;-</span> <span class="cf">function</span>(vec, nreps, theta){</span>
<span id="cb159-4"><a href="simuler.html#cb159-4" aria-hidden="true" tabindex="-1"></a>  btsp.vec <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(vec, nreps <span class="sc">*</span> <span class="fu">length</span>(vec), <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb159-5"><a href="simuler.html#cb159-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nrow =</span> nreps)</span>
<span id="cb159-6"><a href="simuler.html#cb159-6" aria-hidden="true" tabindex="-1"></a>  btsp.res <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="at">X =</span> btsp.vec, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> theta)</span>
<span id="cb159-7"><a href="simuler.html#cb159-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(btsp.res)</span>
<span id="cb159-8"><a href="simuler.html#cb159-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb159-9"><a href="simuler.html#cb159-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-10"><a href="simuler.html#cb159-10" aria-hidden="true" tabindex="-1"></a><span class="co"># En utilisant les données de l'exemple précédent</span></span>
<span id="cb159-11"><a href="simuler.html#cb159-11" aria-hidden="true" tabindex="-1"></a>btsp <span class="ot">&lt;-</span> <span class="fu">bootstrap</span>(<span class="at">vec =</span> X, <span class="at">nreps =</span> nreps, <span class="at">theta =</span> mean)</span>
<span id="cb159-12"><a href="simuler.html#cb159-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-13"><a href="simuler.html#cb159-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour fin de comparaison :</span></span>
<span id="cb159-14"><a href="simuler.html#cb159-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Voici la moyenne et l'erreur standard de ce bootstrap</span></span>
<span id="cb159-15"><a href="simuler.html#cb159-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(btsp)  ; <span class="fu">sd</span>(btsp)</span>
<span id="cb159-16"><a href="simuler.html#cb159-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">10.2</span></span>
<span id="cb159-17"><a href="simuler.html#cb159-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.484</span></span>
<span id="cb159-18"><a href="simuler.html#cb159-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-19"><a href="simuler.html#cb159-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Voici la moyenne et l'erreur standard à partir du premier bootstrap</span></span>
<span id="cb159-20"><a href="simuler.html#cb159-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(moyenne.X)  ; <span class="fu">sd</span>(moyenne.X)</span>
<span id="cb159-21"><a href="simuler.html#cb159-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">10.2</span></span>
<span id="cb159-22"><a href="simuler.html#cb159-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.481</span></span>
<span id="cb159-23"><a href="simuler.html#cb159-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-24"><a href="simuler.html#cb159-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Et voici la moyenne et l'erreur standard originales</span></span>
<span id="cb159-25"><a href="simuler.html#cb159-25" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X) ; <span class="fu">sd</span>(X)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb159-26"><a href="simuler.html#cb159-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">10.2</span></span>
<span id="cb159-27"><a href="simuler.html#cb159-27" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.485</span></span></code></pre></div>
</div>
<div id="les-packages-1" class="section level3" number="12.2.2">
<h3>
<span class="header-section-number">12.2.2</span> Les packages<a class="anchor" aria-label="anchor" href="#les-packages-1"><i class="fas fa-link"></i></a>
</h3>
<p>Il existe plusieurs packages pour réaliser du bootstrap dans <strong>R</strong>. Il y a <code>bootstrap</code> <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-bootstrap" role="doc-biblioref">Tibshirani &amp; Leisch, 2019</a>)</span> et <code>boot</code> <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-Canty21" role="doc-biblioref">Canty &amp; Ripley, 2021</a>)</span>. Ajouter à cela que plusieurs fonctions <strong>R</strong> possèdent des options de bootstrap intégrées (qu’il faut commander dans les arguments). Plusieurs analyses statistiques recourant aux bootstraps sont déjà implantées. L’aperçu donné dans ce chapitre devrait convaincre le lecteur que, s’il a besoin de bootstrap, il est assez rudimentaire de l’implanter soi-même.</p>
</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="analyser.html"><span class="header-section-number">11</span> Analyser</a></div>
<div class="next"><a href="exercice-analyse.html">Exercices</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#simuler"><span class="header-section-number">12</span> Simuler</a></li>
<li>
<a class="nav-link" href="#les-simulations-monte-carlo"><span class="header-section-number">12.1</span> Les simulations Monte-Carlo</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#le-probl%C3%A8me-de-monty-hall"><span class="header-section-number">12.1.1</span> Le problème de Monty-Hall</a></li></ul>
</li>
<li>
<a class="nav-link" href="#le-bootstrap"><span class="header-section-number">12.2</span> Le bootstrap</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#meilleures-pratiques"><span class="header-section-number">12.2.1</span> Meilleures pratiques</a></li>
<li><a class="nav-link" href="#les-packages-1"><span class="header-section-number">12.2.2</span> Les packages</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/quantmeth/MQR/blob/master/12-Simuler.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/quantmeth/MQR/edit/master/12-Simuler.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Méthodes quantitatives avec R</strong>" was written by P.-O. Caron. It was last built on 2023-08-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
