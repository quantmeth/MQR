<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 17 Réduire | Méthodes quantitatives avec R</title>
<meta name="author" content="P.-O. Caron">
<meta name="description" content="Comme mentionné d’entrer de jeu, l’analyse en composantes principales (ACP) n’est pas une technique de réduction des dimensions. S’il y a \(p\) variables, l’ACP produit \(p\) dimensions....">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content=" 17 Réduire | Méthodes quantitatives avec R">
<meta property="og:type" content="book">
<meta property="og:url" content="mqr.teluq.ca/réduire.html">
<meta property="og:description" content="Comme mentionné d’entrer de jeu, l’analyse en composantes principales (ACP) n’est pas une technique de réduction des dimensions. S’il y a \(p\) variables, l’ACP produit \(p\) dimensions....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 17 Réduire | Méthodes quantitatives avec R">
<meta name="twitter:description" content="Comme mentionné d’entrer de jeu, l’analyse en composantes principales (ACP) n’est pas une technique de réduction des dimensions. S’il y a \(p\) variables, l’ACP produit \(p\) dimensions....">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- 
    \(
    \newcommand{\EX}{\mathbb{E}}
    \)
    --><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Méthodes quantitatives avec R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bienvenue!</a></li>
<li><a class="" href="pr%C3%A9face.html">Préface</a></li>
<li class="book-part">Rudiments</li>
<li><a class="" href="commencer.html"><span class="header-section-number">1</span> Commencer</a></li>
<li><a class="" href="programmer.html"><span class="header-section-number">2</span> Programmer</a></li>
<li><a class="" href="calculer.html"><span class="header-section-number">3</span> Calculer</a></li>
<li><a class="" href="exercice-rudiments.html">Exercices</a></li>
<li class="book-part">Jeux de données</li>
<li><a class="" href="entrer.html"><span class="header-section-number">4</span> Entrer</a></li>
<li><a class="" href="importer.html"><span class="header-section-number">5</span> Importer</a></li>
<li><a class="" href="manipuler.html"><span class="header-section-number">6</span> Manipuler</a></li>
<li><a class="" href="visualiser.html"><span class="header-section-number">7</span> Visualiser</a></li>
<li><a class="" href="exercice-gestion.html">Exercices</a></li>
<li class="book-part">Statistiques</li>
<li><a class="" href="inf%C3%A9rer.html"><span class="header-section-number">8</span> Inférer</a></li>
<li><a class="" href="analyser.html"><span class="header-section-number">9</span> Analyser</a></li>
<li><a class="" href="simuler.html"><span class="header-section-number">10</span> Simuler</a></li>
<li><a class="" href="exercice-analyse.html">Exercices</a></li>
<li class="book-part">Modèles linéaires</li>
<li><a class="" href="pr%C3%A9dire.html"><span class="header-section-number">11</span> Prédire</a></li>
<li><a class="" href="cr%C3%A9er.html"><span class="header-section-number">12</span> Créer</a></li>
<li><a class="" href="m%C3%A9dier.html"><span class="header-section-number">13</span> Médier</a></li>
<li><a class="" href="mod%C3%A9rer.html"><span class="header-section-number">14</span> Modérer</a></li>
<li><a class="" href="exercice-lineaire.html">Exercices</a></li>
<li class="book-part">Analyses factorielles</li>
<li><a class="" href="d%C3%A9composer.html"><span class="header-section-number">15</span> Décomposer</a></li>
<li><a class="" href="explorer.html"><span class="header-section-number">16</span> Explorer</a></li>
<li><a class="active" href="r%C3%A9duire.html"><span class="header-section-number">17</span> Réduire</a></li>
<li><a class="" href="r%C3%A9f%C3%A9rences.html">Références</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/quantmeth/MQR">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="réduire" class="section level1" number="17">
<h1>
<span class="header-section-number"> 17</span> Réduire<a class="anchor" aria-label="anchor" href="#r%C3%A9duire"><i class="fas fa-link"></i></a>
</h1>
<p>Comme mentionné d’entrer de jeu, l’analyse en composantes principales (ACP) n’est pas une technique de réduction des dimensions. S’il y a <span class="math inline">\(p\)</span> variables, l’ACP produit <span class="math inline">\(p\)</span> dimensions. Toutefois, comme les valeurs propres sont des indices de partage commun entre les variables, elle peut être utilisée de cette façon. Elle est presque toujours utiliser pour réduire la dimension d’un jeu de donnée. Il suffit d’ordonner les valeurs propres. La question devient alors à savoir combien de dimensions faut-il retenir pour rendre adéquatement compte des données? Dès lors, l’ACP devient une technique de réduction des dimension, mais comme elle ne répond pas explicitement à cette question, le statisticien use de techniques complémentaires, des règles d’arrêts (<em>stopping rules</em>) pour déterminer le nombre de dimensions.</p>
<p>Ces <strong>règles d’arrêt</strong> sont en général un <em>bricolage</em> du statisticien pour répondre à la question. Bricolage n’est pas à prendre péjorativement, mais seulement comme rappel à la réalité que ces techniques sont souvent créées sans dérivation analytique. Il n’est pas possible de leur faire aveuglément confiance (il ne faudrait jamais faire cela de toute façon). Elles ont une pertinence pratique, mais les conditions selon lesquelles elles flanchent n’est pas connue. Il existe probablement des centaines de techniques ayant leur avantage et inconvénients ou bien des scénarios dans lesquels elles sont plus efficaces que les autres. Il en apparaît des nouvelles chaque années depuis 1950. Comme ces techniques sont des bricolages et qu’elles sont taillées différemment, elles ne résultent pas toutes à la même conclusion. Faire l’étalage de ces règles d’arrêt serait bien inutile. Ainsi, les deux techniques les plus utilisées seront présentées, l’analyse parallèle (<em>parallel analysis</em>) et une deuxième méthode ayant montré un excellent rendement sera présentée, soit le test séquentiel de la prochaine valeur propre (<em>Next eigenvalue sequence test</em>).</p>
<div id="illustration" class="section level2" number="17.1">
<h2>
<span class="header-section-number">17.1</span> Illustration<a class="anchor" aria-label="anchor" href="#illustration"><i class="fas fa-link"></i></a>
</h2>
<p>Qu’est-ce que la réduction de dimension? La réduction de dimension ou la détermination du nombre de dimension se retrouvent dans tous les domaines, que ce soit en psychologie, en biologie, en informatique ou en physique. Cela peut être autant pratique que théorique. En psychologie, les chercheurs s’intéressent à déterminer le nombre de dimension d’un test psychométrique. En écologie, les chercheurs peuvent tenter de représenter la variabilité inter-espère d’un habitat. En ingénierie, les ingénieurs en télécommunication peuvent vouloir extraire informations pertinentes des capteurs électroniques.</p>
<p>La compression d’images, en informatique, est un exemple dont il est possible d’illustrer. La réduction de dimension permet de résumer l’information afin d’en réduire la taille pour ne conserver que le signifiant. Ainsi, les mêmes techniques permettant d’identifier les facteurs psychologiques peuvent être utilisées pour les images, mais l’identification des thèmes de films et bien d’autres.</p>
<p>La Figure <a href="r%C3%A9duire.html#fig:Pigeon">17.1</a> montre un exemple de compression d’une image de pigeon<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Tirée de &lt;a href="https://pixnio.com/fr/faune-animaux/des-oiseaux-fr/pigeons-photos/oiseau-pigeon-tumbler-pigeon-mouche-animal-animal" class="uri"&gt;https://pixnio.com/fr/faune-animaux/des-oiseaux-fr/pigeons-photos/oiseau-pigeon-tumbler-pigeon-mouche-animal-animal&lt;/a&gt;, License CC0&lt;/p&gt;'><sup>26</sup></a>. Elle montre à différents niveaux factoriels de compression la même image. À trois dimensions, le pigeon est difficilement perceptible. Progressivement, le pigeon est plus facilement reconnaissable, mais surtout, à un certain seuil (deuxième et troisième lignes de la Figure <a href="r%C3%A9duire.html#fig:Pigeon">17.1</a>, par exemple), l’image gagne en clarté. Trente dimensions conviennent, les plus difficiles désireront peut-être retenir 125 dimensions. L’image à ce stade est très bien. Nonobstant ces nombres, ce sera toujours mieux, en termes de compression, que les 526 dimensions possibles (de l’image original). Ainsi, à 23.764 % des dimensions, l’image est claire et le pigeon reconnaissable. Cette logique s’applique également pour les facteurs psychologiques.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Pigeon"></span>
<img src="image/Pigeon.pdf" alt="Pigeon compressé à divers niveaux de dimension $k$" height="150%"><p class="caption">
Figure 17.1: Pigeon compressé à divers niveaux de dimension <span class="math inline">\(k\)</span>
</p>
</div>
</div>
<div id="importance-dune-dimension" class="section level2" number="17.2">
<h2>
<span class="header-section-number">17.2</span> Importance d’une dimension<a class="anchor" aria-label="anchor" href="#importance-dune-dimension"><i class="fas fa-link"></i></a>
</h2>
<p>Une technique pour connaître l’importance d’une dimension est d’afficher les valeurs propres. Les valeurs propres les plus élevées impliquent qu’elle sont les plus importantes (les premières) alors que de petites valeurs signalent les moins importantes (du bruit, des résidus, soit les dernières). Il est toutefois plus ardu de déterminer le seuil entre important et non important.</p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Pour la reproductibilité</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">33</span><span class="op">)</span>

<span class="co"># Création de la matrice de recette de fabrication</span>
<span class="va">phi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.9</span>, <span class="fl">.8</span>, <span class="fl">.7</span>,  <span class="fl">0</span>,  <span class="fl">0</span>, <span class="fl">.4</span>,
               <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>, <span class="fl">.6</span>, <span class="fl">.5</span>, <span class="fl">.4</span><span class="op">)</span>, 
             nrow <span class="op">=</span> <span class="fl">6</span>, ncol <span class="op">=</span>  <span class="fl">2</span><span class="op">)</span>

<span class="co"># Identification des variables et facteurs</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"F1"</span>, <span class="st">"F2"</span><span class="op">)</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"i"</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>

<span class="va">R</span> <span class="op">=</span> <span class="va">phi</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="co"># Création du jeu de données</span>
<span class="va">jd</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, 
                    mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">)</span>, 
                    Sigma <span class="op">=</span> <span class="va">R</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">jd</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Une façon d’illustrer les valeurs propres graphiquement est d’utiliser un graphique nommé <em>scree plot</em> ou <em>grahpique des éboulis</em>. La Figure <a href="r%C3%A9duire.html#fig:scree">17.2</a> peut être produite avec la syntaxe ci-dessous. Il s’agit de mettre en axe des <span class="math inline">\(x\)</span> la séquence (<code>idex</code>) des valeurs propres (leur ordre) par rapport à la valeur propre en axe des <span class="math inline">\(y\)</span>. Ce graphique se produit simplement avec <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code>. L’option <code>type = "b"</code> est simplement un type de graphique utilisé, dans ce cas-ci, la combinaison de points et de lignes.</p>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">values</span>,
     type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:scree"></span>
<img src="17-Reduire_files/figure-html/scree-1.png" alt="Les valeurs propres en fonctions de la position de l'axe" width="672"><p class="caption">
Figure 17.2: Les valeurs propres en fonctions de la position de l’axe
</p>
</div>
</div>
<div id="lanalyse-parallèle" class="section level2" number="17.3">
<h2>
<span class="header-section-number">17.3</span> L’analyse parallèle<a class="anchor" aria-label="anchor" href="#lanalyse-parall%C3%A8le"><i class="fas fa-link"></i></a>
</h2>
<p>Avant d’introduire l’analyse parallèle (PA), il est intéressant de présenter le test duquel il est inspiré, soit le <em>test de Kaiser</em> <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-Kaiser" role="doc-biblioref">Kaiser, 1960</a>)</span>. C’est le test utilisé par défaut dans certains logiciel traditionnel, malgré qu’il soit discrédité depuis plusieurs années <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-Achim20" role="doc-biblioref">Achim, 2020</a>; <a href="r%C3%A9f%C3%A9rences.html#ref-Beauducel01" role="doc-biblioref">Beauducel, 2001</a>; <a href="r%C3%A9f%C3%A9rences.html#ref-Turner98" role="doc-biblioref">Turner, 1998</a>)</span>. Ce test se fonde sur l’idée selon laquelle, si les variables ne sont pas corrélées entre elles, donc s’il n’y a pas de facteurs, les valeurs propres seront égales à 1. La logique du test est d’affirmer que, si une valeur propre est supérieure à 1, alors de l’information commune est nécessairement partagée entre deux ou plusieurs variables. Selon le test de Kaiser, le nombre de composantes à retenir correspond au nombre de valeurs propres supérieures à 1.
Asymptotiquement parlant, si <span class="math inline">\(n \to \infty\)</span>, le test est vraie. Par contre, l’ACP capitalise sur l’erreur et en inclut accidentellement dans les premières dimensions. Conséquemment, les premiers axes seront surestimés, alors que les derniers seront sous-estimées.</p>
<p>La solution proposée par <span class="citation">Horn (<a href="r%C3%A9f%C3%A9rences.html#ref-Horn65" role="doc-biblioref">1965</a>)</span> est alors de tenir compte de cette erreur d’échantillonnage accidentelle. Pour ce faire, il propose de rééchantillonner les valeurs propres d’un jeu de données sans aucun facteur (aucune corrélation entre les variables) et ayant les mêmes caractéristiques que le jeu de données cible (même nombre de variables et de participant). Le jeu de données cible correspond au jeu de données de l’expérimentateur. Même s’il n’y a pas de corrélation sur le plan de la population, il y aura accidentellement des corrélations dans un échantillon. Le rééchantillonnage est réitéré sur des milliers de jeu de données artificiel. À chaque fois, les valeurs propres sont enregistrées. Des moyennes en sont retirés à la toute fin. Il s’agit du critère auquel l’hypothèse nulle est rejetée. De la première à la dernière, chaque valeur propre cible est comparée à la valeur propre moyenne correspondante, si la cible est plus élevée, il s’agit d’une dimension à retenir. Dès que la cible est inférieur, le test est arrêté. Le nombre de valeurs propres supérieures aux valeurs propres artificielles correspond au nombre de dimensions à retenir.</p>
<p>Dans la syntaxe ci-dessous, les mêmes caractéristiques que le jeu de données précédent sont utilisés, soit <span class="math inline">\(p = 6\)</span> et <span class="math inline">\(n = 5000\)</span>. À la fin, il sera possible de comparer s’il y a effectivement deux facteurs selon l’AP.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="r%C3%A9duire.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la reproductibilité</span></span>
<span id="cb242-2"><a href="r%C3%A9duire.html#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1019</span>)</span>
<span id="cb242-3"><a href="r%C3%A9duire.html#cb242-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="dv">6</span>        <span class="co"># Nombre de variables</span></span>
<span id="cb242-4"><a href="r%C3%A9duire.html#cb242-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">500</span>      <span class="co"># Nombre de participants </span></span>
<span id="cb242-5"><a href="r%C3%A9duire.html#cb242-5" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">=</span> <span class="dv">1000</span>  <span class="co"># Nombre d'itérations</span></span>
<span id="cb242-6"><a href="r%C3%A9duire.html#cb242-6" aria-hidden="true" tabindex="-1"></a>valeurs.propres <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,           <span class="co"># Création d'une variable</span></span>
<span id="cb242-7"><a href="r%C3%A9duire.html#cb242-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">nrow =</span> p,    <span class="co"># vide pour enregistrer</span></span>
<span id="cb242-8"><a href="r%C3%A9duire.html#cb242-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ncol =</span> reps) <span class="co"># les valeurs propres</span></span>
<span id="cb242-9"><a href="r%C3%A9duire.html#cb242-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la boucle                                        </span></span>
<span id="cb242-10"><a href="r%C3%A9duire.html#cb242-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reps) {</span>
<span id="cb242-11"><a href="r%C3%A9duire.html#cb242-11" aria-hidden="true" tabindex="-1"></a>  score <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n <span class="sc">*</span> p)             <span class="co"># Création de n * p valeurs </span></span>
<span id="cb242-12"><a href="r%C3%A9duire.html#cb242-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># aléatoires non corrélées</span></span>
<span id="cb242-13"><a href="r%C3%A9duire.html#cb242-13" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">=</span> <span class="fu">matrix</span>(score,                    <span class="co"># Formater en matrice le jeu</span></span>
<span id="cb242-14"><a href="r%C3%A9duire.html#cb242-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">nrow =</span> n, <span class="at">ncol =</span> p)       <span class="co"># de données </span></span>
<span id="cb242-15"><a href="r%C3%A9duire.html#cb242-15" aria-hidden="true" tabindex="-1"></a>  ACP <span class="ot">=</span> <span class="fu">svd</span>(<span class="fu">cor</span>(D))                    <span class="co"># Réaliser l'ACP </span></span>
<span id="cb242-16"><a href="r%C3%A9duire.html#cb242-16" aria-hidden="true" tabindex="-1"></a>  valeurs.propres[,i] <span class="ot">=</span> ACP<span class="sc">$</span>d          <span class="co"># Enregistrer les valeurs propres</span></span>
<span id="cb242-17"><a href="r%C3%A9duire.html#cb242-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb242-18"><a href="r%C3%A9duire.html#cb242-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-19"><a href="r%C3%A9duire.html#cb242-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Une fois les valeurs propres obtenues,</span></span>
<span id="cb242-20"><a href="r%C3%A9duire.html#cb242-20" aria-hidden="true" tabindex="-1"></a><span class="co"># les moyennes et quantiles sont calculables</span></span>
<span id="cb242-21"><a href="r%C3%A9duire.html#cb242-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rowMeans</span>(valeurs.propres)        <span class="co"># Une moyenne par ligne (valeur propres)</span></span>
<span id="cb242-22"><a href="r%C3%A9duire.html#cb242-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.150</span> <span class="fl">1.077</span> <span class="fl">1.022</span> <span class="fl">0.973</span> <span class="fl">0.920</span> <span class="fl">0.858</span></span>
<span id="cb242-23"><a href="r%C3%A9duire.html#cb242-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-24"><a href="r%C3%A9duire.html#cb242-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou si le 95e percentile était préféré</span></span>
<span id="cb242-25"><a href="r%C3%A9duire.html#cb242-25" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="at">X =</span> valeurs.propres, </span>
<span id="cb242-26"><a href="r%C3%A9duire.html#cb242-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">FUN =</span> quantile,</span>
<span id="cb242-27"><a href="r%C3%A9duire.html#cb242-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">MARGIN =</span> <span class="dv">1</span>,</span>
<span id="cb242-28"><a href="r%C3%A9duire.html#cb242-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">probs =</span> .<span class="dv">95</span>)</span>
<span id="cb242-29"><a href="r%C3%A9duire.html#cb242-29" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.211</span> <span class="fl">1.118</span> <span class="fl">1.056</span> <span class="fl">1.004</span> <span class="fl">0.957</span> <span class="fl">0.904</span></span></code></pre></div>
<p>Pour connaître le nombre de dimension, il suffit de tester les valeurs propres empiriques et les comparer aux valeurs propres simulées (moyenne ou 95<sup>e</sup> percentile). Le nombre de valeur propre empirique supérieur aux valeurs propres simulés correspond au nombre de composantes à retenir.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="r%C3%A9duire.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Les valeurs propres empiriques</span></span>
<span id="cb243-2"><a href="r%C3%A9duire.html#cb243-2" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>values</span>
<span id="cb243-3"><a href="r%C3%A9duire.html#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">2.333</span> <span class="fl">1.423</span> <span class="fl">0.877</span> <span class="fl">0.566</span> <span class="fl">0.531</span> <span class="fl">0.269</span></span>
<span id="cb243-4"><a href="r%C3%A9duire.html#cb243-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-5"><a href="r%C3%A9duire.html#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="co"># La moyenne des valeurs propres simulées</span></span>
<span id="cb243-6"><a href="r%C3%A9duire.html#cb243-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rowMeans</span>(valeurs.propres)</span>
<span id="cb243-7"><a href="r%C3%A9duire.html#cb243-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.150</span> <span class="fl">1.077</span> <span class="fl">1.022</span> <span class="fl">0.973</span> <span class="fl">0.920</span> <span class="fl">0.858</span></span>
<span id="cb243-8"><a href="r%C3%A9duire.html#cb243-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-9"><a href="r%C3%A9duire.html#cb243-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de valeurs propres empiriques supérieures aux simulées</span></span>
<span id="cb243-10"><a href="r%C3%A9duire.html#cb243-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(res<span class="sc">$</span>values <span class="sc">&gt;</span> <span class="fu">rowMeans</span>(valeurs.propres))</span>
<span id="cb243-11"><a href="r%C3%A9duire.html#cb243-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="dv">2</span></span></code></pre></div>
<p>Ainsi, 2 facteurs sont à retenir. Une façon d’illustrer les résultats de l’analyse parallèle est d’utiliser le graphique de éboulis en y représentant les valeurs propres empiriques comparativement aux simulées. Le nombre de valeurs propres empiriques supérieures aux simulées est le nombre de dimensions à retenir. Ce graphique est produit à la Figure <a href="r%C3%A9duire.html#fig:scree2">17.3</a>. Voici la syntaxe pour produire ce graphique avec <code>ggplot2</code>. La première étape est de mettre en commun les résultats obtenus dans un jeu de données. La variable <code>Index</code> indique l’index de la valeur propres, <code>valeurs.propres</code> contient les valeurs propres et <code>Type</code> indique s’il s’agit de valeurs propres empiriques ou simulées de l’analyse parallèle. Pour le reste, il s’agit de recourir à <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.</p>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">p</span>, <span class="va">p</span><span class="op">)</span>,
           valeurs.propres <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">values</span>, <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">valeurs.propres</span><span class="op">)</span><span class="op">)</span>,
           Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Empirique"</span>,<span class="st">"Simulées"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">p</span><span class="op">)</span>
<span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Index</span>, y <span class="op">=</span> <span class="va">valeurs.propres</span>, color <span class="op">=</span> <span class="va">Type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:scree2"></span>
<img src="17-Reduire_files/figure-html/scree2-1.png" alt="Comparaison des valeurs propres empiriques et simulées" width="672"><p class="caption">
Figure 17.3: Comparaison des valeurs propres empiriques et simulées
</p>
</div>
</div>
<div id="nest" class="section level2" number="17.4">
<h2>
<span class="header-section-number">17.4</span> NEST<a class="anchor" aria-label="anchor" href="#nest"><i class="fas fa-link"></i></a>
</h2>
<p>Le <em>Next Eigenvalue Sequential Test</em> développé par Achim <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-Achim17" role="doc-biblioref">2017</a>, <a href="r%C3%A9f%C3%A9rences.html#ref-Achim20" role="doc-biblioref">2020</a>)</span> est le dernier cri en termes d’estimations du nombre de composante à retenir.</p>
<!-- Il est à mi-chemin entre MAP et AP  -->
<p><em>À terminer</em></p>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NEST</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">N</span><span class="op">=</span><span class="cn">NULL</span>, <span class="va">reps</span> <span class="op">=</span> <span class="fl">1000</span>, 
                 <span class="va">alpha</span> <span class="op">=</span> <span class="fl">.05</span>, <span class="va">convergence</span> <span class="op">=</span> <span class="fl">1e-5</span>, <span class="va">maxit</span> <span class="op">=</span> <span class="fl">500</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span>
  
  <span class="va">ns</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">nv</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">ns</span><span class="op">==</span><span class="va">nv</span><span class="op">)</span><span class="op">{</span>
    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"Error: 'N' is required"</span><span class="op">)</span> 
    <span class="va">ns</span> <span class="op">=</span> <span class="va">N</span>
  <span class="op">}</span><span class="kw">else</span><span class="op">{</span>
    <span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
  <span class="op">}</span> 
  <span class="va">E</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">data</span>, symmetric<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">values</span>
  
  <span class="kw">for</span> <span class="op">(</span><span class="va">nfact</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">nv</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="va">rnk</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">nfact</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">nfact</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span>
      <span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">nv</span><span class="op">)</span>
    <span class="op">}</span><span class="kw">else</span><span class="op">{</span>
      <span class="va">R</span> <span class="op">=</span> <span class="va">data</span>
      <span class="va">pre</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
      <span class="kw">for</span> <span class="op">(</span><span class="va">jj</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">maxit</span><span class="op">)</span><span class="op">{</span>
        <span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">R</span>, symmetric<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
        <span class="kw">if</span> <span class="op">(</span><span class="va">nfact</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span>
          <span class="va">ld</span> <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
          <span class="va">co</span> <span class="op">=</span> <span class="va">ld</span><span class="op">*</span><span class="va">ld</span>
        <span class="op">}</span><span class="kw">else</span><span class="op">{</span>
          <span class="va">ff</span> <span class="op">=</span> <span class="va">nfact</span>
          <span class="kw">while</span> <span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">ff</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span><span class="va">ff</span> <span class="op">=</span> <span class="va">ff</span> <span class="op">-</span> <span class="fl">1</span><span class="op">}</span>
          <span class="va">ld</span> <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">vectors</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="va">ff</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">ff</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
          <span class="va">co</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">ld</span><span class="op">*</span><span class="va">ld</span><span class="op">)</span>
        <span class="op">}</span>
        
        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">co</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span>
          <span class="va">R</span> <span class="op">=</span> <span class="va">R</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">pre</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">)</span>
          <span class="kw">break</span>
        <span class="op">}</span>
        
        <span class="va">diff</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">pre</span> <span class="op">-</span> <span class="va">co</span><span class="op">)</span><span class="op">)</span>
        <span class="kw">if</span> <span class="op">(</span><span class="va">diff</span> <span class="op">&lt;</span> <span class="va">convergence</span><span class="op">)</span> <span class="kw">break</span>
        <span class="va">R</span> <span class="op">=</span> <span class="va">R</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">co</span><span class="op">-</span><span class="va">pre</span><span class="op">)</span>
        <span class="va">pre</span> <span class="op">=</span> <span class="va">co</span>
      <span class="op">}</span>
      
      <span class="kw">if</span> <span class="op">(</span><span class="va">jj</span> <span class="op">&gt;=</span> <span class="va">maxit</span><span class="op">)</span><span class="op">{</span>
        <span class="va">nt</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Warning! Convergence not achieved"</span><span class="op">)</span>
      <span class="op">}</span>
      
      
      <span class="va">model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">ld</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">co</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="va">nd</span> <span class="op">=</span> <span class="va">nfact</span> <span class="op">+</span> <span class="va">nv</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">reps</span><span class="op">)</span><span class="op">{</span>
      <span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">ns</span> <span class="op">*</span> <span class="va">nd</span><span class="op">)</span>, <span class="va">ns</span>, <span class="va">nd</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">model</span><span class="op">)</span>, 
                  symmetric<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">nfact</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span>
      <span class="va">rnk</span> <span class="op">=</span> <span class="va">rnk</span> <span class="op">+</span> <span class="op">(</span><span class="va">res</span> <span class="op">&gt;=</span> <span class="va">E</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">nfact</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="kw">if</span> <span class="op">(</span><span class="va">rnk</span><span class="op">[</span><span class="va">nfact</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">alpha</span><span class="op">*</span><span class="op">(</span><span class="va">reps</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="kw">break</span>
  <span class="op">}</span>
  
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span>OUT <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"NEST"</span>, nfact <span class="op">=</span> <span class="va">nfact</span><span class="op">)</span>   <span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Pour tester</p>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">NEST</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">jd5000</span><span class="op">)</span>, N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">jd5000</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="packages" class="section level2" number="17.5">
<h2>
<span class="header-section-number">17.5</span> Packages<a class="anchor" aria-label="anchor" href="#packages"><i class="fas fa-link"></i></a>
</h2>
<p>La fonction <code><a href="https://rdrr.io/r/base/svd.html">svd()</a></code> a été abordée, mais d’autres fonctions peuvent aussi réaliser l’analyse en composantes principales, soit <code><a href="https://rdrr.io/r/stats/prcomp.html">prcomp()</a></code> et <code><a href="https://rdrr.io/r/base/eigen.html">eigen()</a></code>. Les sorties et arguments seront légèrement différents, mais correspondent aux mêmes analyses.</p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="explorer.html"><span class="header-section-number">16</span> Explorer</a></div>
<div class="next"><a href="r%C3%A9f%C3%A9rences.html">Références</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#r%C3%A9duire"><span class="header-section-number">17</span> Réduire</a></li>
<li><a class="nav-link" href="#illustration"><span class="header-section-number">17.1</span> Illustration</a></li>
<li><a class="nav-link" href="#importance-dune-dimension"><span class="header-section-number">17.2</span> Importance d’une dimension</a></li>
<li><a class="nav-link" href="#lanalyse-parall%C3%A8le"><span class="header-section-number">17.3</span> L’analyse parallèle</a></li>
<li><a class="nav-link" href="#nest"><span class="header-section-number">17.4</span> NEST</a></li>
<li><a class="nav-link" href="#packages"><span class="header-section-number">17.5</span> Packages</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/quantmeth/MQR/blob/master/17-Reduire.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/quantmeth/MQR/edit/master/17-Reduire.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Méthodes quantitatives avec R</strong>" was written by P.-O. Caron. It was last built on 2022-08-29.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
