<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 20 Réduire | Méthodes quantitatives avec R</title>
<meta name="author" content="P.-O. Caron">
<meta name="description" content="Comme mentionné d’entrée de jeu, l’analyse en composantes principales (ACP) n’est pas une technique de réduction des dimensions. S’il y a \(p\) variables, l’ACP produit \(p\) dimensions....">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content=" 20 Réduire | Méthodes quantitatives avec R">
<meta property="og:type" content="book">
<meta property="og:url" content="mqr.teluq.ca/réduire.html">
<meta property="og:description" content="Comme mentionné d’entrée de jeu, l’analyse en composantes principales (ACP) n’est pas une technique de réduction des dimensions. S’il y a \(p\) variables, l’ACP produit \(p\) dimensions....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 20 Réduire | Méthodes quantitatives avec R">
<meta name="twitter:description" content="Comme mentionné d’entrée de jeu, l’analyse en composantes principales (ACP) n’est pas une technique de réduction des dimensions. S’il y a \(p\) variables, l’ACP produit \(p\) dimensions....">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- 
    \(
    \newcommand{\EX}{\mathbb{E}}
    \)
    --><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Méthodes quantitatives avec R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bienvenue!</a></li>
<li><a class="" href="pr%C3%A9face.html">Préface</a></li>
<li class="book-part">Rudiments</li>
<li><a class="" href="commencer.html"><span class="header-section-number">1</span> Commencer</a></li>
<li><a class="" href="programmer.html"><span class="header-section-number">2</span> Programmer</a></li>
<li><a class="" href="calculer.html"><span class="header-section-number">3</span> Calculer</a></li>
<li><a class="" href="r%C3%A9diger.html"><span class="header-section-number">4</span> Rédiger</a></li>
<li><a class="" href="exercice-rudiments.html">Exercices</a></li>
<li class="book-part">Jeux de données</li>
<li><a class="" href="entrer.html"><span class="header-section-number">5</span> Entrer</a></li>
<li><a class="" href="importer.html"><span class="header-section-number">6</span> Importer</a></li>
<li><a class="" href="manipuler.html"><span class="header-section-number">7</span> Manipuler</a></li>
<li><a class="" href="visualiser.html"><span class="header-section-number">8</span> Visualiser</a></li>
<li><a class="" href="exercice-gestion.html">Exercices</a></li>
<li class="book-part">Statistiques</li>
<li><a class="" href="d%C3%A9crire.html"><span class="header-section-number">9</span> Décrire</a></li>
<li><a class="" href="inf%C3%A9rer.html"><span class="header-section-number">10</span> Inférer</a></li>
<li><a class="" href="analyser.html"><span class="header-section-number">11</span> Analyser</a></li>
<li><a class="" href="simuler.html"><span class="header-section-number">12</span> Simuler</a></li>
<li><a class="" href="exercice-analyse.html">Exercices</a></li>
<li class="book-part">Modèles linéaires</li>
<li><a class="" href="comparer.html"><span class="header-section-number">13</span> Comparer</a></li>
<li><a class="" href="pr%C3%A9dire.html"><span class="header-section-number">14</span> Prédire</a></li>
<li><a class="" href="cr%C3%A9er.html"><span class="header-section-number">15</span> Créer</a></li>
<li><a class="" href="m%C3%A9dier.html"><span class="header-section-number">16</span> Médier</a></li>
<li><a class="" href="mod%C3%A9rer.html"><span class="header-section-number">17</span> Modérer</a></li>
<li><a class="" href="exercice-lineaire.html">Exercices</a></li>
<li class="book-part">Analyses factorielles</li>
<li><a class="" href="d%C3%A9composer.html"><span class="header-section-number">18</span> Décomposer</a></li>
<li><a class="" href="explorer.html"><span class="header-section-number">19</span> Explorer</a></li>
<li><a class="active" href="r%C3%A9duire.html"><span class="header-section-number">20</span> Réduire</a></li>
<li><a class="" href="exercice-factoriel.html">Exercices</a></li>
<li class="book-part">Annexes</li>
<li><a class="" href="solutions.html">Solutions</a></li>
<li><a class="" href="r%C3%A9f%C3%A9rences.html">Références</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/quantmeth/MQR">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="réduire" class="section level1" number="20">
<h1>
<span class="header-section-number"> 20</span> Réduire<a class="anchor" aria-label="anchor" href="#r%C3%A9duire"><i class="fas fa-link"></i></a>
</h1>
<p>Comme mentionné d’entrée de jeu, l’analyse en composantes principales (ACP) n’est pas une technique de réduction des dimensions. S’il y a <span class="math inline">\(p\)</span> variables, l’ACP produit <span class="math inline">\(p\)</span> dimensions. Toutefois, comme les valeurs propres sont des indices de partage commun entre les variables, elle peut être utilisée de cette façon. En fait, l’ACP est presque toujours utilisée pour réduire la dimension d’un jeu de données.</p>
<p>Parallèlement, l’<a href="explorer.html#analyse-factorielle-exploratoire">analyse factorielle exploratoire</a> permet de dériver un indice de suffisance du nombre de dimensions (le <span class="math inline">\(\chi^2\)</span>), toutefois, il existe de meilleures techniques pour déterminer le nombre de dimensions à retenir dans une analyse exploratoire.</p>
<p>Cette section porte sur les méthodes afin d’identifier le nombre de dimensions à retenir. C’est un sujet très complexe dont seulement quelques brides seront abordées.</p>
<div id="illustration" class="section level2" number="20.1">
<h2>
<span class="header-section-number">20.1</span> Illustration<a class="anchor" aria-label="anchor" href="#illustration"><i class="fas fa-link"></i></a>
</h2>
<p>Qu’est-ce que la réduction de dimensions? La réduction de dimensions ou la détermination du nombre de dimensions se retrouvent dans tous les domaines, que ce soit en psychologie, en biologie, en informatique ou en physique. Cela peut être autant pratique que théorique. En psychologie, les chercheurs s’intéressent à déterminer le nombre de dimensions d’un test psychométrique. En écologie, les chercheurs peuvent tenter de représenter la variabilité inter-espèces d’un habitat. En ingénierie, les ingénieurs en télécommunication peuvent vouloir extraire l’information pertinente des capteurs électroniques.</p>
<p>La compression d’images, en informatique, est un exemple de réduction dimensionnelle dont il est possible d’illustrer visuellement. La réduction de dimensions permet de résumer l’information afin d’en réduire la taille pour ne conserver que le signifiant. Ainsi, les mêmes techniques permettant d’identifier les facteurs psychologiques peuvent être utilisées pour les images, l’identification des thèmes de films et bien d’autres.</p>
<p>La Figure <a href="r%C3%A9duire.html#fig:Pigeon">20.1</a> montre un exemple de compression d’une image de pigeon<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Tirée de &lt;a href="https://pixnio.com/fr/faune-animaux/des-oiseaux-fr/pigeons-photos/oiseau-pigeon-tumbler-pigeon-mouche-animal-animal" class="uri"&gt;https://pixnio.com/fr/faune-animaux/des-oiseaux-fr/pigeons-photos/oiseau-pigeon-tumbler-pigeon-mouche-animal-animal&lt;/a&gt;, License CC0&lt;/p&gt;'><sup>39</sup></a>. Elle montre à différents niveaux factoriels de compression la même image. À trois dimensions, le pigeon est difficilement perceptible. Progressivement, le pigeon est plus facilement reconnaissable, mais surtout, à un certain seuil (deuxième et troisième lignes de la Figure <a href="r%C3%A9duire.html#fig:Pigeon">20.1</a>, par exemple), l’image gagne en clarté. Trente dimensions conviennent, les plus difficiles désireront peut-être retenir 125 dimensions. L’image à ce stade est très bien. Nonobstant ces nombres, ce sera toujours mieux, en termes de compression, que les 526 dimensions possibles (de l’image originale). Ainsi, à 23.764 % des dimensions, l’image est claire et le pigeon reconnaissable. Cette logique s’applique également pour les facteurs psychologiques.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:Pigeon"></span>
<img src="image/Pigeon.png" alt="Pigeon compressé à divers niveaux de dimension $k$" width="75%" height="75%"><p class="caption">
Figure 20.1: Pigeon compressé à divers niveaux de dimension <span class="math inline">\(k\)</span>
</p>
</div>
</div>
<div id="importance-dune-dimension" class="section level2" number="20.2">
<h2>
<span class="header-section-number">20.2</span> Importance d’une dimension<a class="anchor" aria-label="anchor" href="#importance-dune-dimension"><i class="fas fa-link"></i></a>
</h2>
<p>Une technique pour connaître l’importance d’une dimension est d’afficher les valeurs propres. Les valeurs propres les plus élevées impliquent qu’elles sont les plus importantes (les premières) alors que de petites valeurs signalent les moins importantes (du bruit, des résidus, soit les dernières). Il est toutefois plus ardu de déterminer le seuil entre important et non important.</p>
<p>La structure factorielle et le jeu de données du chapitre <a href="explorer.html#explorer">Explorer</a> sont repris afin d’illustrer le propos.</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pour la reproductibilité</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">44</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Création de la matrice de recette de fabrication</span></span>
<span><span class="va">phi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.9</span>, <span class="fl">.8</span>, <span class="fl">.7</span>,  <span class="fl">0</span>,  <span class="fl">0</span>, <span class="fl">.4</span>,</span>
<span>                <span class="fl">0</span>,  <span class="fl">0</span>,  <span class="fl">0</span>, <span class="fl">.6</span>, <span class="fl">.5</span>, <span class="fl">.4</span><span class="op">)</span>, </span>
<span>             nrow <span class="op">=</span> <span class="fl">6</span>, ncol <span class="op">=</span>  <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Nombre de variables</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Identification des variables et facteurs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"F1"</span>, <span class="st">"F2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"i"</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">R</span> <span class="op">=</span> <span class="va">phi</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Création du jeu de données</span></span>
<span><span class="va">jd</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, </span>
<span>                    mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                    Sigma <span class="op">=</span> <span class="va">R</span><span class="op">)</span></span></code></pre></div>
<p>Voici l’analyse en composante principale.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="r%C3%A9duire.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># L'ACP</span></span>
<span id="cb276-2"><a href="r%C3%A9duire.html#cb276-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cor</span>(jd))</span>
<span id="cb276-3"><a href="r%C3%A9duire.html#cb276-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-4"><a href="r%C3%A9duire.html#cb276-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Les valeurs propres</span></span>
<span id="cb276-5"><a href="r%C3%A9duire.html#cb276-5" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>values</span>
<span id="cb276-6"><a href="r%C3%A9duire.html#cb276-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">2.576</span> <span class="fl">1.699</span> <span class="fl">0.771</span> <span class="fl">0.421</span> <span class="fl">0.328</span> <span class="fl">0.205</span></span></code></pre></div>
<p>Une façon d’illustrer les valeurs propres graphiquement est d’utiliser un graphique nommé <em>scree plot</em> ou <em>graphique des éboulis</em>. La Figure <a href="r%C3%A9duire.html#fig:scree">20.2</a> peut être produite avec la syntaxe ci-dessous. Il s’agit de mettre en axe des <span class="math inline">\(x\)</span> la séquence (<code>Position</code>) des valeurs propres (leur ordre) par rapport à la valeur propre en axe des <span class="math inline">\(y\)</span>. Ce graphique se produit simplement avec <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> ou <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> (voir <a href="visualiser.html#visualiser">Visualiser</a>).</p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Position</span> <span class="op">&lt;-</span>  <span class="fl">1</span><span class="op">:</span><span class="va">p</span></span>
<span><span class="va">vp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Position <span class="op">=</span> <span class="va">Position</span> ,</span>
<span>                 Valeurs.propres <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">values</span><span class="op">)</span>,</span>
<span>                 Test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Empiriques"</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">vp</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Position</span>, </span>
<span>                     y <span class="op">=</span> <span class="va">Valeurs.propres</span>, </span>
<span>                     color <span class="op">=</span> <span class="va">Test</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Valeur propre"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scree"></span>
<img src="20-Reduire_files/figure-html/scree-1.png" alt="Les valeurs propres en fonction de la position de l'axe" width="75%" height="75%"><p class="caption">
Figure 20.2: Les valeurs propres en fonction de la position de l’axe
</p>
</div>
<p>La Figure <a href="r%C3%A9duire.html#fig:scree">20.2</a> est une bonne représentation visuelle des valeurs propres. Elle ne répond pas à la question d’intérêt : combien y a-t-il de dimensions <em>importantes</em>? Elle donne toutefois une idée. Probablement 2 ou 3? La première est indubitable; la valeur propre est très élevée. Les 4<sup>e</sup>, 5<sup>e</sup> et 6<sup>e</sup> sont quant à elles très petites et sont très près. Comment déterminer avec plus de rigueur le nombre de dimensions? C’est là que les règles d’arrêt entre en jeu.</p>
</div>
<div id="les-règles-darrêt" class="section level2" number="20.3">
<h2>
<span class="header-section-number">20.3</span> Les règles d’arrêt<a class="anchor" aria-label="anchor" href="#les-r%C3%A8gles-darr%C3%AAt"><i class="fas fa-link"></i></a>
</h2>
<p>La question est de savoir combien de dimensions il faut retenir pour rendre adéquatement compte des données. Dès lors, l’ACP devient une technique de réduction des dimension. Or, les analyses exploratoires (comme l’<a href="d%C3%A9composer.html#d%C3%A9composer">ACP</a> ou <a href="explorer.html#explorer">l’analyse factorielle exploratoire</a> ne répondent pas explicitement à cette question. Le statisticien use de techniques complémentaires, des <strong>règles d’arrêts</strong> (<em>stopping rules</em>), pour déterminer le nombre de dimensions à retenir.</p>
<p>Ces règles d’arrêt sont en général un <em>bricolage</em> du statisticien pour répondre à la question. Bricolage n’est pas à prendre péjorativement, mais seulement comme un rappel à la réalité : ces techniques sont souvent créées sans aucune dérivation analytique. Il n’est pas possible de leur faire aveuglément confiance (il ne faudrait jamais faire cela de toute façon). Elles ont une pertinence pratique, mais les conditions selon lesquelles elles flanchent ne sont pas ou peu connues. Il existe probablement des centaines de techniques ayant leurs avantages et inconvénients ou bien des scénarios dans lesquels elles sont plus efficaces que les autres. Il en apparaît des nouvelles chaque année depuis 1950. Comme ces techniques sont des bricolages et qu’elles sont taillées différemment, elles ne s’accordent pas toujours sur la même conclusion. Faire l’étalage de ces règles d’arrêt serait bien inutile. Ainsi, trois techniques seront présentées, le test de Kaiser, l’analyse parallèle (<em>parallel analysis</em>) et le test de suffisance de la prochaine valeur propre (<em>Next eigenvalue sufficiency test</em>), une technique récente montrant un excellent rendement. Ces trois règles représentent une même ligne évolutive.</p>
<div id="le-test-de-kaiser" class="section level3" number="20.3.1">
<h3>
<span class="header-section-number">20.3.1</span> Le test de Kaiser<a class="anchor" aria-label="anchor" href="#le-test-de-kaiser"><i class="fas fa-link"></i></a>
</h3>
<p>Historiquement, le premier test est le <em>test de Kaiser</em> <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-Kaiser" role="doc-biblioref">Kaiser, 1960</a>)</span>. C’est la règle d’arrêt utilisée par défaut dans la plupart des logiciels traditionnels. Cela lui permet d’être encore très répandu aujourd’hui, malgré qu’il soit discrédité depuis les années 60 <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-Achim20" role="doc-biblioref">Achim, 2020</a>; <a href="r%C3%A9f%C3%A9rences.html#ref-Beauducel01" role="doc-biblioref">Beauducel, 2001</a>; <a href="r%C3%A9f%C3%A9rences.html#ref-Turner98" role="doc-biblioref">Turner, 1998</a>)</span>.</p>
<p>Le test de Kaiser se fonde sur l’idée selon laquelle, si les variables ne sont pas corrélées entre elles (s’il n’y a pas de facteurs), les valeurs propres seront égales à 1. La logique du test est d’affirmer que, si une valeur propre est supérieure à 1, alors de l’information commune est nécessairement partagée entre deux ou plusieurs variables. Selon le test de Kaiser, le nombre de composantes à retenir correspond au nombre de valeurs propres supérieures à 1.</p>
<p>À titre illustratif, une matrice de corrélation sans aucune corrélation est une matrice d’identité.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="r%C3%A9duire.html#cb278-1" aria-hidden="true" tabindex="-1"></a>mat.cor <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">6</span>)</span>
<span id="cb278-2"><a href="r%C3%A9duire.html#cb278-2" aria-hidden="true" tabindex="-1"></a>mat.cor</span>
<span id="cb278-3"><a href="r%C3%A9duire.html#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>] [,<span class="dv">6</span>]</span>
<span id="cb278-4"><a href="r%C3%A9duire.html#cb278-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb278-5"><a href="r%C3%A9duire.html#cb278-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">2</span>,]    <span class="dv">0</span>    <span class="dv">1</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb278-6"><a href="r%C3%A9duire.html#cb278-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">3</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb278-7"><a href="r%C3%A9duire.html#cb278-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">4</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>    <span class="dv">0</span>    <span class="dv">0</span></span>
<span id="cb278-8"><a href="r%C3%A9duire.html#cb278-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">5</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>    <span class="dv">0</span></span>
<span id="cb278-9"><a href="r%C3%A9duire.html#cb278-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">6</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span></span></code></pre></div>
<p>Les valeurs propres de cette matrice sont toutes égales à 1.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="r%C3%A9duire.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(mat.cor)<span class="sc">$</span>values</span>
<span id="cb279-2"><a href="r%C3%A9duire.html#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span></span></code></pre></div>
<p>Si une seule corrélation est ajoutée, aussi petite soit-elle, alors toutes les plus grandes valeurs propres tendent à capitaliser sur cette variance partagée.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="r%C3%A9duire.html#cb280-1" aria-hidden="true" tabindex="-1"></a>mat.cor[<span class="dv">1</span>, <span class="dv">6</span>] <span class="ot">&lt;-</span> mat.cor[<span class="dv">6</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> .<span class="dv">1</span></span>
<span id="cb280-2"><a href="r%C3%A9duire.html#cb280-2" aria-hidden="true" tabindex="-1"></a>mat.cor</span>
<span id="cb280-3"><a href="r%C3%A9duire.html#cb280-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>] [,<span class="dv">6</span>]</span>
<span id="cb280-4"><a href="r%C3%A9duire.html#cb280-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>,]  <span class="fl">1.0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>  <span class="fl">0.1</span></span>
<span id="cb280-5"><a href="r%C3%A9duire.html#cb280-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">2</span>,]  <span class="fl">0.0</span>    <span class="dv">1</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>  <span class="fl">0.0</span></span>
<span id="cb280-6"><a href="r%C3%A9duire.html#cb280-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">3</span>,]  <span class="fl">0.0</span>    <span class="dv">0</span>    <span class="dv">1</span>    <span class="dv">0</span>    <span class="dv">0</span>  <span class="fl">0.0</span></span>
<span id="cb280-7"><a href="r%C3%A9duire.html#cb280-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">4</span>,]  <span class="fl">0.0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>    <span class="dv">0</span>  <span class="fl">0.0</span></span>
<span id="cb280-8"><a href="r%C3%A9duire.html#cb280-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">5</span>,]  <span class="fl">0.0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>  <span class="fl">0.0</span></span>
<span id="cb280-9"><a href="r%C3%A9duire.html#cb280-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">6</span>,]  <span class="fl">0.1</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>  <span class="fl">1.0</span></span>
<span id="cb280-10"><a href="r%C3%A9duire.html#cb280-10" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen</span>(mat.cor)<span class="sc">$</span>values</span>
<span id="cb280-11"><a href="r%C3%A9duire.html#cb280-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.1</span> <span class="fl">1.0</span> <span class="fl">1.0</span> <span class="fl">1.0</span> <span class="fl">1.0</span> <span class="fl">0.9</span></span></code></pre></div>
<p>Autrement dit, si une valeur propre est supérieure à 1, c’est qu’il y a un facteur.</p>
<p>La Figure <a href="r%C3%A9duire.html#fig:kaiser">20.3</a> illustre le test de Kaiser avec le présent exemple qui suggère deux facteurs (comme simulé).</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">vp</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Position <span class="op">=</span> <span class="va">Position</span>,</span>
<span>                 Valeurs.propres <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 Test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Kaiser"</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">vp</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Position</span>, </span>
<span>                     y <span class="op">=</span> <span class="va">Valeurs.propres</span>, </span>
<span>                     color <span class="op">=</span> <span class="va">Test</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Valeur propre"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:kaiser"></span>
<img src="20-Reduire_files/figure-html/kaiser-1.png" alt="Les valeurs propres en fonctions de la position de l'axe" width="75%" height="75%"><p class="caption">
Figure 20.3: Les valeurs propres en fonctions de la position de l’axe
</p>
</div>
<p>Voici un exemple d’une fonction maison simple pour programmer le test de Kaiser.</p>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kaiser</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">jd</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># Obtenir la matrice de corrélation</span></span>
<span>  <span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">jd</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Extraire uniquement les valeurs propres</span></span>
<span>  <span class="va">eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">R</span>, only.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">values</span></span>
<span>  </span>
<span>  <span class="co"># Les valeurs propres plus grandes que 1</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">eig</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div id="lanalyse-parallèle-de-horn" class="section level3" number="20.3.2">
<h3>
<span class="header-section-number">20.3.2</span> L’analyse parallèle de Horn<a class="anchor" aria-label="anchor" href="#lanalyse-parall%C3%A8le-de-horn"><i class="fas fa-link"></i></a>
</h3>
<p>Asymptotiquement parlant, si <span class="math inline">\(n \to \infty\)</span>, le test est vrai. Par contre, l’ordre des valeurs propres capitalise sur l’erreur, ce qui introduit l’idée selon laquelle les corrélations accidentelles se retrouvent dans les premières dimensions. Même s’il n’y a pas de corrélation sur le plan de la population, il y aura accidentellement des corrélations dans un échantillon. Conséquemment, les premiers axes sont surestimés, alors que les derniers sont sous-estimés.</p>
<p>La solution proposée par <span class="citation">Horn (<a href="r%C3%A9f%C3%A9rences.html#ref-Horn65" role="doc-biblioref">1965</a>)</span> est alors de tenir compte de cette erreur d’échantillonnage accidentelle. Pour ce faire, il propose de rééchantillonner les valeurs propres d’un jeu de données sans aucun facteur (aucune corrélation entre les variables) ayant les mêmes caractéristiques que le jeu de données cible (mêmes nombres de variables et de participants). Le jeu de données cible correspond au jeu de données de l’expérimentateur.</p>
<p>Le rééchantillonnage est réitéré sur des milliers de jeu de données artificiels. À chaque fois, les valeurs propres sont enregistrées. Des valeurs critiques (moyennes ou percentiles) en sont retirées à la toute fin. Il s’agit du critère auquel l’hypothèse nulle est rejetée. De la première à la dernière, chaque valeur propre cible est comparée à la valeur propre moyenne correspondante. Si la cible est plus élevée, il s’agit d’une dimension à retenir. Dès que la cible est inférieure, le test est arrêté. Le nombre de valeurs propres supérieures aux valeurs propres artificielles correspond au nombre de dimensions à retenir.
Dans la syntaxe ci-dessous, les mêmes caractéristiques que le jeu de données précédent sont utilisés, soit <span class="math inline">\(p = 6\)</span> et <span class="math inline">\(n = 5000\)</span>. À la fin, il sera possible de comparer s’il y a effectivement deux facteurs selon l’analyse parallèle.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="r%C3%A9duire.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la reproductibilité</span></span>
<span id="cb283-2"><a href="r%C3%A9duire.html#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1019</span>)</span>
<span id="cb283-3"><a href="r%C3%A9duire.html#cb283-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">6</span>        <span class="co"># Nombre de variables</span></span>
<span id="cb283-4"><a href="r%C3%A9duire.html#cb283-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span>       <span class="co"># Nombre de participants </span></span>
<span id="cb283-5"><a href="r%C3%A9duire.html#cb283-5" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># Nombre d'itérations</span></span>
<span id="cb283-6"><a href="r%C3%A9duire.html#cb283-6" aria-hidden="true" tabindex="-1"></a>valeurs.propres <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,            <span class="co"># Création d'une variable</span></span>
<span id="cb283-7"><a href="r%C3%A9duire.html#cb283-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">nrow =</span> p,     <span class="co"># vide pour enregistrer</span></span>
<span id="cb283-8"><a href="r%C3%A9duire.html#cb283-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ncol =</span> nreps) <span class="co"># les valeurs propres</span></span>
<span id="cb283-9"><a href="r%C3%A9duire.html#cb283-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-10"><a href="r%C3%A9duire.html#cb283-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'une matrice de corrélation vide</span></span>
<span id="cb283-11"><a href="r%C3%A9duire.html#cb283-11" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">diag</span>(p)</span>
<span id="cb283-12"><a href="r%C3%A9duire.html#cb283-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-13"><a href="r%C3%A9duire.html#cb283-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la boucle                                        </span></span>
<span id="cb283-14"><a href="r%C3%A9duire.html#cb283-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nreps) {</span>
<span id="cb283-15"><a href="r%C3%A9duire.html#cb283-15" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> n,            <span class="co"># Création de n * p valeurs</span></span>
<span id="cb283-16"><a href="r%C3%A9duire.html#cb283-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, p),   <span class="co"># aléatoires accidentellement</span></span>
<span id="cb283-17"><a href="r%C3%A9duire.html#cb283-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Sigma =</span> R)        <span class="co"># corrélées</span></span>
<span id="cb283-18"><a href="r%C3%A9duire.html#cb283-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb283-19"><a href="r%C3%A9duire.html#cb283-19" aria-hidden="true" tabindex="-1"></a>  ACP <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cor</span>(D),                 <span class="co"># Réaliser l'ACP</span></span>
<span id="cb283-20"><a href="r%C3%A9duire.html#cb283-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">only.values =</span> <span class="cn">TRUE</span>)        </span>
<span id="cb283-21"><a href="r%C3%A9duire.html#cb283-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb283-22"><a href="r%C3%A9duire.html#cb283-22" aria-hidden="true" tabindex="-1"></a>  valeurs.propres[,i] <span class="ot">&lt;-</span> ACP<span class="sc">$</span>values    <span class="co"># Enregistrer les valeurs propres</span></span>
<span id="cb283-23"><a href="r%C3%A9duire.html#cb283-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb283-24"><a href="r%C3%A9duire.html#cb283-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-25"><a href="r%C3%A9duire.html#cb283-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Une fois les valeurs propres obtenues,</span></span>
<span id="cb283-26"><a href="r%C3%A9duire.html#cb283-26" aria-hidden="true" tabindex="-1"></a><span class="co"># les moyennes et quantiles sont calculables</span></span>
<span id="cb283-27"><a href="r%C3%A9duire.html#cb283-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-28"><a href="r%C3%A9duire.html#cb283-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Une moyenne par ligne (valeurs propres)</span></span>
<span id="cb283-29"><a href="r%C3%A9duire.html#cb283-29" aria-hidden="true" tabindex="-1"></a><span class="fu">rowMeans</span>(valeurs.propres)</span>
<span id="cb283-30"><a href="r%C3%A9duire.html#cb283-30" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.495</span> <span class="fl">1.242</span> <span class="fl">1.057</span> <span class="fl">0.899</span> <span class="fl">0.739</span> <span class="fl">0.568</span></span>
<span id="cb283-31"><a href="r%C3%A9duire.html#cb283-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-32"><a href="r%C3%A9duire.html#cb283-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Le 95e percentile (si préféré)</span></span>
<span id="cb283-33"><a href="r%C3%A9duire.html#cb283-33" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(<span class="at">X =</span> valeurs.propres, </span>
<span id="cb283-34"><a href="r%C3%A9duire.html#cb283-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">FUN =</span> quantile,</span>
<span id="cb283-35"><a href="r%C3%A9duire.html#cb283-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">MARGIN =</span> <span class="dv">1</span>,</span>
<span id="cb283-36"><a href="r%C3%A9duire.html#cb283-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">probs =</span> .<span class="dv">95</span>)</span>
<span id="cb283-37"><a href="r%C3%A9duire.html#cb283-37" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.723</span> <span class="fl">1.388</span> <span class="fl">1.163</span> <span class="fl">0.998</span> <span class="fl">0.858</span> <span class="fl">0.700</span></span></code></pre></div>
<p>Pour connaître le nombre de dimensions, il suffit de tester les valeurs propres empiriques et les comparer aux valeurs propres simulées (moyenne ou 95<sup>e</sup> percentile). Le nombre de valeur propre empirique supérieur aux valeurs propres simulés correspond au nombre de composantes à retenir.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="r%C3%A9duire.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Les valeurs propres empiriques</span></span>
<span id="cb284-2"><a href="r%C3%A9duire.html#cb284-2" aria-hidden="true" tabindex="-1"></a>res<span class="sc">$</span>values</span>
<span id="cb284-3"><a href="r%C3%A9duire.html#cb284-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">2.576</span> <span class="fl">1.699</span> <span class="fl">0.771</span> <span class="fl">0.421</span> <span class="fl">0.328</span> <span class="fl">0.205</span></span>
<span id="cb284-4"><a href="r%C3%A9duire.html#cb284-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-5"><a href="r%C3%A9duire.html#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="co"># La moyenne des valeurs propres simulées</span></span>
<span id="cb284-6"><a href="r%C3%A9duire.html#cb284-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rowMeans</span>(valeurs.propres)</span>
<span id="cb284-7"><a href="r%C3%A9duire.html#cb284-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.495</span> <span class="fl">1.242</span> <span class="fl">1.057</span> <span class="fl">0.899</span> <span class="fl">0.739</span> <span class="fl">0.568</span></span>
<span id="cb284-8"><a href="r%C3%A9duire.html#cb284-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-9"><a href="r%C3%A9duire.html#cb284-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de valeurs propres empiriques supérieures aux simulées</span></span>
<span id="cb284-10"><a href="r%C3%A9duire.html#cb284-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(res<span class="sc">$</span>values <span class="sc">&gt;</span> <span class="fu">rowMeans</span>(valeurs.propres))</span>
<span id="cb284-11"><a href="r%C3%A9duire.html#cb284-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="dv">2</span></span></code></pre></div>
<p>Ainsi, 2 facteurs sont à retenir. Une façon d’illustrer les résultats de l’analyse parallèle est d’utiliser le graphique des éboulis en y représentant les valeurs propres empiriques comparativement aux simulées. Le nombre de valeurs propres empiriques supérieures aux simulées est le nombre de dimensions à retenir. Ce graphique est produit à la Figure <a href="r%C3%A9duire.html#fig:scree2">20.4</a>. Voici la syntaxe pour produire ce graphique avec <code>ggplot2</code>. La première étape est de mettre en commun les résultats obtenus dans un jeu de données. La variable <code>Position</code> indique l’ordre de la valeur propre, <code>valeurs.propres</code> contient les valeurs propres et <code>Test</code> indique s’il s’agit de valeurs propres empiriques ou simulées de l’analyse parallèle. Pour le reste, il s’agit de recourir à <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.</p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">vp</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Position <span class="op">=</span> <span class="va">Position</span>,</span>
<span>                 Valeurs.propres <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">valeurs.propres</span><span class="op">)</span>,</span>
<span>                 Test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Analyse parallèle"</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">vp</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Position</span>, </span>
<span>                     y <span class="op">=</span> <span class="va">Valeurs.propres</span>, </span>
<span>                     color <span class="op">=</span> <span class="va">Test</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Valeur propre"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scree2"></span>
<img src="20-Reduire_files/figure-html/scree2-1.png" alt="Comparaison des valeurs propres empiriques et simulées" width="75%" height="75%"><p class="caption">
Figure 20.4: Comparaison des valeurs propres empiriques et simulées
</p>
</div>
<p>Voici une fonction pour programmer l’analyse parallèle.</p>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analyse.parallele</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">jd</span>, </span>
<span>                              <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">jd</span><span class="op">)</span>, </span>
<span>                              <span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">jd</span><span class="op">)</span>, </span>
<span>                              <span class="va">nreps</span> <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                              <span class="va">alpha</span> <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span><span class="op">{</span></span>
<span> </span>
<span>  <span class="co"># Extraire uniquement les valeurs propres</span></span>
<span>  <span class="va">eig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">jd</span><span class="op">)</span>, only.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">values</span></span>
<span></span>
<span>  <span class="co"># Création d'une variable vide pour enregistrer</span></span>
<span><span class="va">valeurs.propres</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,            </span>
<span>                         nrow <span class="op">=</span> <span class="va">p</span>,     </span>
<span>                         ncol <span class="op">=</span> <span class="va">nreps</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Création d'une matrice de corrélation vide</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Création de la boucle                                        </span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nreps</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">D</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>,            <span class="co"># Création de n * p valeurs</span></span>
<span>                     mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>,   <span class="co"># aléatoires accidentellement</span></span>
<span>                     Sigma <span class="op">=</span> <span class="va">R</span><span class="op">)</span>        <span class="co"># corrélées</span></span>
<span>  </span>
<span>  <span class="va">ACP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span>,                 <span class="co"># Réaliser l'ACP</span></span>
<span>               only.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>        </span>
<span>  </span>
<span>  <span class="va">valeurs.propres</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ACP</span><span class="op">$</span><span class="va">values</span>    <span class="co"># Enregistrer les valeurs propres</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Le 95e percentile</span></span>
<span><span class="va">vp.crit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">valeurs.propres</span>, </span>
<span>                 FUN <span class="op">=</span> <span class="va">quantile</span>,</span>
<span>                 MARGIN <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 probs <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Les valeurs propres empiriques plus grandes </span></span>
<span><span class="co"># que celles simulées</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">eig</span> <span class="op">&gt;</span> <span class="va">vp.crit</span><span class="op">)</span> </span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div id="test-de-suffisance-de-la-prochaine-valeur-propre-dachim" class="section level3" number="20.3.3">
<h3>
<span class="header-section-number">20.3.3</span> Test de suffisance de la prochaine valeur propre d’Achim<a class="anchor" aria-label="anchor" href="#test-de-suffisance-de-la-prochaine-valeur-propre-dachim"><i class="fas fa-link"></i></a>
</h3>
<p>L’un des problèmes de l’analyse parallèle est que, bien qu’elle tient compte de l’erreur d’échantillonnage, elle ne tient pas compte de la logique séquentielle des tests d’hypothèses des valeurs propres <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-Beauducel01" role="doc-biblioref">Beauducel, 2001</a>; <a href="r%C3%A9f%C3%A9rences.html#ref-Turner98" role="doc-biblioref">Turner, 1998</a>)</span>. Précisément, le test d’hypothèses sous-jacent, en termes de <span class="math inline">\(k\)</span> dimensions à retenir, est
<span class="math display">\[
H_0 : k = 0 \\
H_1 : k \geq1
\]</span></p>
<p>Autrement dit, il n’y a pas de facteurs, ou bien il y a plus d’un facteur. Une fois la première dimension déterminée par l’analyse parallèle, il est inadéquat de tester les suivantes avec la même matrice de corrélation. Il faut tenir compte de cette nouvelle information : il y a au moins <span class="math inline">\(k\)</span> dimensions.</p>
<p>Le <strong>Test de suffisance de la prochaine valeur propre</strong> (<em>Next Eigenvalue Sufficiency Test</em>, NEST) développé par Achim <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-Achim17" role="doc-biblioref">2017</a>, <a href="r%C3%A9f%C3%A9rences.html#ref-Achim20" role="doc-biblioref">2020</a>)</span> est le dernier cri en termes d’estimation du nombre de composantes à retenir. En plus de tenir compte pour l’erreur d’échantillonnage, comme l’analyse parallèle, il tient compte aussi de la logique séquentielle du test d’hypothèse. Plus précisément, le test utilise une matrice de corrélation contenant les <span class="math inline">\(k\)</span> dimensions déterminées auparavant. Lorsque <span class="math inline">\(k=0\)</span>, le test est équivalent à l’analyse parallèle, mais uniquement pour la première valeur propre. Une fois l’hypothèse nulle rejetée, <span class="math inline">\(k\)</span> est incrémenté, une nouvelle matrice de corrélation basée sur ces <span class="math inline">\(k\)</span> facteurs est calculées, et un nouveau rééchantillonnage des valeurs propres est entrepris. Le test s’arrête lorsque la <span class="math inline">\(k+1\)</span> valeur propre (l’hypothèse nulle) n’est pas rejetée, pour donner <span class="math inline">\(k\)</span> dimensions.</p>
<p>La syntaxe suivante illustre de façon simplifiée le test NEST. Elle utilise plusieurs éléments déjà présentés.</p>
<ul>
<li><p>Elle est basée sur <a href="r%C3%A9duire.html#lanalyse-parall%C3%A8le-de-horn">l’analyse parallèle</a>. Le changement principal est que la matrice de corrélation change pour différente valeur de <span class="math inline">\(k\)</span>, alors qu’elle reste toujours identique pour l’analyse parallèle, <code>R = diag(p)</code>, peu importe <span class="math inline">\(k\)</span>.</p></li>
<li><p>Comme l’analyse parallèle, la fonction utilise une forme de rééchantillonnage qui est en fait du <a href="simuler.html#le-bootstrap">bootstrap</a>.</p></li>
<li><p>Elle utilise <code><a href="https://rdrr.io/r/stats/factanal.html">factanal()</a></code> (voir <a href="explorer.html#explorer">Explorer</a>) pour reconstruire la matrice de corrélation à <span class="math inline">\(k\)</span> facteurs.</p></li>
</ul>
<div class="sourceCode" id="cb287"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat.cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">jd</span><span class="op">)</span>  <span class="co"># Matrice de corrélation du jeu de données</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">mat.cor</span><span class="op">)</span>  <span class="co"># Nombre de variables (6)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">jd</span><span class="op">)</span>       <span class="co"># Nombre de participants (50)</span></span>
<span><span class="va">nreps</span> <span class="op">&lt;-</span> <span class="fl">1000</span>       <span class="co"># Nombre d'itérations</span></span>
<span></span>
<span><span class="co"># Test séquentiel des valeurs propres</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">p</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> <span class="co"># Pour 0 à (p-1) dimensions</span></span>
<span>  </span>
<span>  <span class="co"># Déterminer la matrice de corrélation pour k dimensions</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">k</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>      <span class="co"># Pour tester 0 dimension (analyse parallèle)</span></span>
<span>    </span>
<span>    <span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>    <span class="co"># Matrice de corrélation à 0 dimension</span></span>
<span>    </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>          <span class="co"># Pour tester k dimensions</span></span>
<span>    </span>
<span>    <span class="va">fa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/factanal.html">factanal</a></span><span class="op">(</span>covmat <span class="op">=</span> <span class="va">mat.cor</span>, n.obs <span class="op">=</span> <span class="va">n</span>, factors <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span>    <span class="va">R</span> <span class="op">&lt;-</span> <span class="va">fa</span><span class="op">$</span><span class="va">loadings</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">fa</span><span class="op">$</span><span class="va">loadings</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span>    <span class="co"># Matrice de corrélation à k dimensions</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Rééchantillonnage des valeurs propres</span></span>
<span>  <span class="co"># Création d'une variable vide pour enregistrer</span></span>
<span>  <span class="va">valeurs.propres</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,            </span>
<span>                           nrow <span class="op">=</span> <span class="va">p</span>,     </span>
<span>                           ncol <span class="op">=</span> <span class="va">nreps</span><span class="op">)</span> </span>
<span>  </span>
<span>  <span class="co"># Création de la boucle                                        </span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nreps</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="co"># Création de n * p valeurs aléatoires corrélées</span></span>
<span>    <span class="va">D</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>,            </span>
<span>                       mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>,   </span>
<span>                       Sigma <span class="op">=</span> <span class="va">R</span><span class="op">)</span></span>
<span>    </span>
<span>     <span class="co"># Réaliser l'ACP</span></span>
<span>    <span class="va">ACP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span>,                </span>
<span>                only.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  </span>
<span>    </span>
<span>     <span class="co"># Enregistrer les valeurs propres</span></span>
<span>    <span class="va">valeurs.propres</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ACP</span><span class="op">$</span><span class="va">values</span>   </span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Tester la k+1 valeurs propres à alpha = .05</span></span>
<span>  <span class="va">vp.crit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">valeurs.propres</span><span class="op">[</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span>,<span class="op">]</span>, probs <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Valeur propre empirique k testée à la valeur simulée</span></span>
<span>  <span class="co"># Si la valeur propre est plus élevée, NEST continue,</span></span>
<span>  <span class="co"># si la valeur propre est plus petite, NEST arrête.</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="va">k</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">vp.crit</span><span class="op">)</span><span class="op">)</span><span class="op">{</span><span class="kw">break</span><span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Nombre de facteurs à retenir</span></span>
<span><span class="va">nfactors</span> <span class="op">=</span> <span class="va">k</span></span></code></pre></div>
<p>La sortie ici, <code>nfactors</code> représente le nombre de dimensions à retenir.</p>
<div id="le-package-rnest" class="section level4" number="20.3.3.1">
<h4>
<span class="header-section-number">20.3.3.1</span> Le package Rnest<a class="anchor" aria-label="anchor" href="#le-package-rnest"><i class="fas fa-link"></i></a>
</h4>
<p>Il existe une version préliminaire d’un package permettant de réaliser facilement NEST en plus de fournir quelques fonctions utiles. Le package est <code>Rnest</code> <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-Rnest" role="doc-biblioref">Caron, 2023</a>)</span>. Il est disponible par GitHub et est importable sur <strong>R</strong> avec la syntaxe suivante.</p>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"quantmeth/Rnest"</span><span class="op">)</span></span></code></pre></div>
<p>Comme à l’habitude, il faut l’appeler dans l’environnement.</p>
<div class="sourceCode" id="cb289"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">Rnest</span><span class="op">)</span></span></code></pre></div>
<p>La fonction principale est <code><a href="https://rdrr.io/pkg/Rnest/man/nest.html">nest()</a></code>. Elle prend en argument un jeu de données ou une matrice de corrélation avec le nombre de participants. D’autres options sont possibles, comme le seuil critique (<code>alpha</code>), le nombre de répétitions (<code>nreps</code>), et la méthode d’extraction des dimensions (<code>"ml"</code>, <em>maximum likelihood</em>; <code>"paf"</code>, <em>principal axis factoring</em>; <code>"mrfa"</code>, <em>minimum rank factor analysis</em>)</p>
<p>Voici la fonction avec le présent exemple.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="r%C3%A9duire.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nest</span>(jd)</span>
<span id="cb290-2"><a href="r%C3%A9duire.html#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> At <span class="dv">95</span>% confidence, Nest Eigenvalue Sufficiency <span class="fu">Test</span> (NEST) suggests <span class="dv">2</span> factors.</span></code></pre></div>
<p>Voici la sortie des valeurs propres comparées aux deux autres règles d’arrêt illustrée à la Figure <a href="r%C3%A9duire.html#fig:scree3">20.5</a>.</p>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Réorganisation du jeu de données contenant</span></span>
<span><span class="co"># les valeurs propres</span></span>
<span><span class="va">vp.nest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Rnest/man/nest.html">nest</a></span><span class="op">(</span><span class="va">jd</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">vp.nest</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">vp</span><span class="op">)</span></span>
<span><span class="va">vp.nest</span><span class="op">$</span><span class="va">Test</span> <span class="op">&lt;-</span> <span class="st">"NEST"</span> </span>
<span><span class="va">vp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">vp</span>, <span class="va">vp.nest</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">vp</span>,</span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Position</span>, </span>
<span>                     y <span class="op">=</span> <span class="va">Valeurs.propres</span>, </span>
<span>                     color <span class="op">=</span> <span class="va">Test</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Valeur propre"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scree3"></span>
<img src="20-Reduire_files/figure-html/scree3-1.png" alt="Comparaison des valeurs propres empiriques et simulées (analyses parallèle et nest)" width="75%" height="75%"><p class="caption">
Figure 20.5: Comparaison des valeurs propres empiriques et simulées (analyses parallèle et nest)
</p>
</div>
<p>Un bel avantage du package est sa possibilité de créer un graphique pour différentes valeurs critiques <code>alpha</code>. La Figure <a href="r%C3%A9duire.html#fig:screenest">20.6</a> illustre la sortie.</p>
<div class="sourceCode" id="cb292"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Rnest/man/nest.html">nest</a></span><span class="op">(</span><span class="va">jd</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.01</span>, <span class="fl">.025</span>, <span class="fl">.05</span>, <span class="fl">.10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:screenest"></span>
<img src="20-Reduire_files/figure-html/screenest-1.png" alt="Graphique produit par `nest` de `Rnest`" width="75%" height="75%"><p class="caption">
Figure 20.6: Graphique produit par <code>nest</code> de <code>Rnest</code>
</p>
</div>
</div>
</div>
<div id="comparaisons-des-règles-darrêts" class="section level3" number="20.3.4">
<h3>
<span class="header-section-number">20.3.4</span> Comparaisons des règles d’arrêts<a class="anchor" aria-label="anchor" href="#comparaisons-des-r%C3%A8gles-darr%C3%AAts"><i class="fas fa-link"></i></a>
</h3>
<p>À ce stage, les trois règles d’arrêt ont sorti le même nombre de facteurs. Elles semblent ne devenir qu’inutilement alambiqué. Il revient à l’exemple original d’être très simples : des loadings assez saillants, des valeurs propres élevées et une structure simple et orthogonale. Voici un exemple plus complexe.</p>
<p>Le package <code>Rnest</code> founir une matrice de corrélation basée sur 4 facteurs corrélées. La matrice se nomme <code>ex_4factors_corr</code> et la Figure <a href="r%C3%A9duire.html#fig:structcp">20.7</a> représente la structure factorielle sous-jacente de cette matrice de corrélation. Il s’agit de quatre facteurs avec trois items chacun avec des loadings respectif de .9, .9 et .3 et deux paires de corrélation interfacteur de .7.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:structcp"></span>
<img src="image/factstruct3.png" alt="Structure factorielle de `ex_4factors_corr`" width="50%" height="50%"><p class="caption">
Figure 20.7: Structure factorielle de <code>ex_4factors_corr</code>
</p>
</div>
<p>À partir de cette matrice, il est possible de créer un jeu de données pour 2500 participants.</p>
<div class="sourceCode" id="cb293"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">jd2</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2500</span>,</span>
<span>                     mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ex_4factors_corr</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     Sigma <span class="op">=</span> <span class="va">ex_4factors_corr</span><span class="op">)</span></span></code></pre></div>
<p>La Figure <a href="r%C3%A9duire.html#fig:scree4">20.8</a> les valeurs propres du jeu de données.</p>
<div class="figure">
<span style="display:block;" id="fig:scree4"></span>
<img src="20-Reduire_files/figure-html/scree4-1.png" alt="Les valeurs propres de `ex_4factors_corr`" width="672"><p class="caption">
Figure 20.8: Les valeurs propres de <code>ex_4factors_corr</code>
</p>
</div>
<p>Il s’agit d’une structure très difficile pour les règles d’arrêt basées sur les valeurs propres, comme le test de Kaiser, l’analyse parallèle et NEST. Voici les tests comparés.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="r%C3%A9duire.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kaiser</span>(jd2)</span>
<span id="cb294-2"><a href="r%C3%A9duire.html#cb294-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="dv">3</span></span>
<span id="cb294-3"><a href="r%C3%A9duire.html#cb294-3" aria-hidden="true" tabindex="-1"></a><span class="fu">analyse.parallele</span>(jd2)</span>
<span id="cb294-4"><a href="r%C3%A9duire.html#cb294-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="dv">2</span></span>
<span id="cb294-5"><a href="r%C3%A9duire.html#cb294-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nest</span>(jd2)<span class="sc">$</span>nfactors</span>
<span id="cb294-6"><a href="r%C3%A9duire.html#cb294-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>     nfactors</span>
<span id="cb294-7"><a href="r%C3%A9duire.html#cb294-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">95</span>%        <span class="dv">4</span></span></code></pre></div>
<p>Ici NEST montre clairement sa supériorité en étant sensible aux petites valeurs propres. Il trouve bien quatre facteurs, alors que le test en trouve <em>accidentellement</em> trois (à cause de l’erreur d’échantillonnage) et l’analyse parallèle en trouve deux.</p>
</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="explorer.html"><span class="header-section-number">19</span> Explorer</a></div>
<div class="next"><a href="exercice-factoriel.html">Exercices</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#r%C3%A9duire"><span class="header-section-number">20</span> Réduire</a></li>
<li><a class="nav-link" href="#illustration"><span class="header-section-number">20.1</span> Illustration</a></li>
<li><a class="nav-link" href="#importance-dune-dimension"><span class="header-section-number">20.2</span> Importance d’une dimension</a></li>
<li>
<a class="nav-link" href="#les-r%C3%A8gles-darr%C3%AAt"><span class="header-section-number">20.3</span> Les règles d’arrêt</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#le-test-de-kaiser"><span class="header-section-number">20.3.1</span> Le test de Kaiser</a></li>
<li><a class="nav-link" href="#lanalyse-parall%C3%A8le-de-horn"><span class="header-section-number">20.3.2</span> L’analyse parallèle de Horn</a></li>
<li><a class="nav-link" href="#test-de-suffisance-de-la-prochaine-valeur-propre-dachim"><span class="header-section-number">20.3.3</span> Test de suffisance de la prochaine valeur propre d’Achim</a></li>
<li><a class="nav-link" href="#comparaisons-des-r%C3%A8gles-darr%C3%AAts"><span class="header-section-number">20.3.4</span> Comparaisons des règles d’arrêts</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/quantmeth/MQR/blob/master/20-Reduire.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/quantmeth/MQR/edit/master/20-Reduire.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Méthodes quantitatives avec R</strong>" was written by P.-O. Caron. It was last built on 2023-08-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
