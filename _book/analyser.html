<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 11 Analyser | Méthodes quantitatives avec R</title>
<meta name="author" content="P.-O. Caron">
<meta name="description" content="En continuation de l’introduction des théories des tests d’hypothèses (voir Inférer) et l’aperçu donnée par le test-\(t\) à échantillon unique, cette section poursuit la présentation en...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content=" 11 Analyser | Méthodes quantitatives avec R">
<meta property="og:type" content="book">
<meta property="og:url" content="mqr.teluq.ca/analyser.html">
<meta property="og:description" content="En continuation de l’introduction des théories des tests d’hypothèses (voir Inférer) et l’aperçu donnée par le test-\(t\) à échantillon unique, cette section poursuit la présentation en...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 11 Analyser | Méthodes quantitatives avec R">
<meta name="twitter:description" content="En continuation de l’introduction des théories des tests d’hypothèses (voir Inférer) et l’aperçu donnée par le test-\(t\) à échantillon unique, cette section poursuit la présentation en...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- 
    \(
    \newcommand{\EX}{\mathbb{E}}
    \)
    --><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Méthodes quantitatives avec R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bienvenue!</a></li>
<li><a class="" href="pr%C3%A9face.html">Préface</a></li>
<li class="book-part">Rudiments</li>
<li><a class="" href="commencer.html"><span class="header-section-number">1</span> Commencer</a></li>
<li><a class="" href="programmer.html"><span class="header-section-number">2</span> Programmer</a></li>
<li><a class="" href="calculer.html"><span class="header-section-number">3</span> Calculer</a></li>
<li><a class="" href="r%C3%A9diger.html"><span class="header-section-number">4</span> Rédiger</a></li>
<li><a class="" href="exercice-rudiments.html">Exercices</a></li>
<li class="book-part">Jeux de données</li>
<li><a class="" href="entrer.html"><span class="header-section-number">5</span> Entrer</a></li>
<li><a class="" href="importer.html"><span class="header-section-number">6</span> Importer</a></li>
<li><a class="" href="manipuler.html"><span class="header-section-number">7</span> Manipuler</a></li>
<li><a class="" href="visualiser.html"><span class="header-section-number">8</span> Visualiser</a></li>
<li><a class="" href="exercice-gestion.html">Exercices</a></li>
<li class="book-part">Statistiques</li>
<li><a class="" href="d%C3%A9crire.html"><span class="header-section-number">9</span> Décrire</a></li>
<li><a class="" href="inf%C3%A9rer.html"><span class="header-section-number">10</span> Inférer</a></li>
<li><a class="active" href="analyser.html"><span class="header-section-number">11</span> Analyser</a></li>
<li><a class="" href="simuler.html"><span class="header-section-number">12</span> Simuler</a></li>
<li><a class="" href="exercice-analyse.html">Exercices</a></li>
<li class="book-part">Modèles linéaires</li>
<li><a class="" href="comparer.html"><span class="header-section-number">13</span> Comparer</a></li>
<li><a class="" href="pr%C3%A9dire.html"><span class="header-section-number">14</span> Prédire</a></li>
<li><a class="" href="cr%C3%A9er.html"><span class="header-section-number">15</span> Créer</a></li>
<li><a class="" href="m%C3%A9dier.html"><span class="header-section-number">16</span> Médier</a></li>
<li><a class="" href="mod%C3%A9rer.html"><span class="header-section-number">17</span> Modérer</a></li>
<li><a class="" href="exercice-lineaire.html">Exercices</a></li>
<li class="book-part">Analyses factorielles</li>
<li><a class="" href="d%C3%A9composer.html"><span class="header-section-number">18</span> Décomposer</a></li>
<li><a class="" href="explorer.html"><span class="header-section-number">19</span> Explorer</a></li>
<li><a class="" href="r%C3%A9duire.html"><span class="header-section-number">20</span> Réduire</a></li>
<li><a class="" href="exercice-factoriel.html">Exercices</a></li>
<li class="book-part">Annexes</li>
<li><a class="" href="solutions.html">Solutions</a></li>
<li><a class="" href="r%C3%A9f%C3%A9rences.html">Références</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/quantmeth/MQR">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="analyser" class="section level1" number="11">
<h1>
<span class="header-section-number"> 11</span> Analyser<a class="anchor" aria-label="anchor" href="#analyser"><i class="fas fa-link"></i></a>
</h1>
<p>En continuation de l’introduction des théories des tests d’hypothèses (voir <a href="inf%C3%A9rer.html#inf%C3%A9rer">Inférer</a>) et l’aperçu donnée par <a href="inf%C3%A9rer.html#le-test-t-%C3%A0-%C3%A9chantillon-unique">le test-<span class="math inline">\(t\)</span> à échantillon unique</a>, cette section poursuit la présentation en introduisant des analyses statistiques de bases comme les différences de moyennes, l’association linéaire et les tests pour données nominales. Les tests-<span class="math inline">\(t\)</span> indépendant et dépendant, la covariance, la corrélation ainsi que le test du <span class="math inline">\(\chi2\)</span> pour table de contingence sont présentées.</p>
<div id="les-différences-de-moyennes" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Les différences de moyennes<a class="anchor" aria-label="anchor" href="#les-diff%C3%A9rences-de-moyennes"><i class="fas fa-link"></i></a>
</h2>
<div id="le-test-t-indépendant" class="section level3" number="11.1.1">
<h3>
<span class="header-section-number">11.1.1</span> Le test-<span class="math inline">\(t\)</span> indépendant<a class="anchor" aria-label="anchor" href="#le-test-t-ind%C3%A9pendant"><i class="fas fa-link"></i></a>
</h3>
<p>En général, l’expérimentateur ne s’intéresse pas à comparer une moyenne à une valeur arbitraire, comme c’était le cas avec <a href="inf%C3%A9rer.html#le-test-t-%C3%A0-%C3%A9chantillon-unique">le test-<span class="math inline">\(t\)</span> à échantillon unique</a>. Cela peut lui être assez trivial. Il s’intéresse plutôt à comparer une moyenne à une autre moyenne, soit une différence entre deux groupes indépendants, par exemple, quelle est la différence entre un groupe traitement et un groupe contrôle?</p>
<p>En se basant sur le test <span class="math inline">\(t\)</span> à échantillon unique, la valeur-<span class="math inline">\(t\)</span> pour deux moyennes se calcule selon l’équation <a href="analyser.html#eq:test2">(11.1)</a></p>
<p><span class="math display" id="eq:test2">\[\begin{equation}
t_{n-2} = \frac{\bar{x_1}-\bar{x_2}}{\sqrt{\frac{s^2_{1}}{n_1}+\frac{s^2_{2}}{n_2}}}
\tag{11.1}
\end{equation}\]</span></p>
<p>où l’indice de la valeur-<span class="math inline">\(t\)</span> est le nombre de degrés de liberté <span class="math inline">\(n-2\)</span>. Comme deux variances sont estimées, deux degrés de libertés sont imputés, ce qui octroi <span class="math inline">\(n-2\)</span> degrés. En plus de considérer <span class="math inline">\(\bar{x_2}\)</span> la valeur <em>arbitaire</em> de comparaison (l’ordre de <span class="math inline">\(\bar{x_2}\)</span> et <span class="math inline">\(\bar{x^1}\)</span> est arbitraire), les deux écarts types sont également considérés au dénominateur.</p>
<p>Une fois le calcul réalisé, la logique du test d’hypothèse est la même, à l’exception de l’hypothèse nulle qui correspond maintenant à l’absence de différence entre les deux moyennes.</p>
<p>Voici un exemple de programmation du test-<span class="math inline">\(t\)</span> pour deux groupes indépendants.</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testt.ind</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># x1 est une variable continue associée au groupe 1</span></span>
<span>  <span class="co"># x2 est une variable continue associée au groupe 2</span></span>
<span>  </span>
<span>  <span class="co"># Calcul des moyennes</span></span>
<span>  <span class="va">x1bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> ; <span class="va">x2bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calcul des variances</span></span>
<span>  <span class="va">x1var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> ; <span class="va">x2var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calcul des tailles d'échantillon</span></span>
<span>  <span class="va">nx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> ; <span class="va">nx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Valeur-t, degrés de liberté et valeur-p</span></span>
<span>  <span class="va">vt</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x1bar</span> <span class="op">-</span> <span class="va">x2bar</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">x1var</span> <span class="op">/</span> <span class="va">nx1</span> <span class="op">+</span> <span class="va">x2var</span> <span class="op">/</span> <span class="va">nx2</span><span class="op">)</span></span>
<span>  <span class="va">dl</span> <span class="op">&lt;-</span> <span class="va">nx1</span> <span class="op">+</span> <span class="va">nx2</span> <span class="op">-</span> <span class="fl">2</span></span>
<span>  <span class="va">vp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">vt</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">dl</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> </span>
<span>  <span class="va">statistique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>valeur.t <span class="op">=</span> <span class="va">vt</span>, dl <span class="op">=</span> <span class="va">dl</span>, valeur.p <span class="op">=</span> <span class="va">vp</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">statistique</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Pour générer un exemple de données, le code ci-après crée un échantillon de 15 unités réparties en deux groupes, le premier groupe (<code>gr0</code>) est tiré d’une distribution normale ayant une moyenne de 1 et un écart type de 1, le deuxième groupe (<code>gr1</code>), une moyenne de 0 et un écart type de 1. La syntaxe illustre la création de deux variables pour créer les deux groupes. Il est aussi possible d’envisager la création sur en termes d’équation linéaire, comme l’équation <a href="analyser.html#eq:el1">(11.2)</a>,</p>
<p><span class="math display" id="eq:el1">\[\begin{equation}
y = \mu_0 + \mu_1x_1 + \epsilon
\tag{11.2}
\end{equation}\]</span></p>
<p>où <span class="math inline">\(y\)</span> est le score observé des unités et les autres variables construisent ce score, <span class="math inline">\(\mu_0\)</span> correspond à la moyenne du groupe référent de population (le groupe <em>contrôle</em> en quelque sorte.), <span class="math inline">\(\mu_1\)</span> réfère à la différence de moyenne entre les deux groupes identifiés par <span class="math inline">\(x_1\)</span> qui réfère à l’assignation au groupe, soit 0 pour le groupe <em>contrôle</em> et 1 pour le groupe <em>différent</em>. Pour ce même exemple, <span class="math inline">\(\mu_1 = -1\)</span>. Par le produit <span class="math inline">\(\mu_1x_1\)</span>, le groupe <em>contrôle</em> associé à la valeur 0 n’a pas de modification de la moyenne, <span class="math inline">\(-1*0=0\)</span> alors le groupe <em>différent</em> associé à la valeur 1, <span class="math inline">\(-1*1=-1\)</span>. Enfin, <span class="math inline">\(\epsilon\)</span> correspond à la variabilité entre les unités. Cette façon de programmer la création des variables illustre bien l’association linéaire qui existe même dans les différences de moyennes et sera très utile pour des modèles plus compliqués.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="analyser.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Un exemple de jeu de données programmé de deux façons</span></span>
<span id="cb129-2"><a href="analyser.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Méthode 1</span></span>
<span id="cb129-3"><a href="analyser.html#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb129-4"><a href="analyser.html#cb129-4" aria-hidden="true" tabindex="-1"></a>gr0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">15</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb129-5"><a href="analyser.html#cb129-5" aria-hidden="true" tabindex="-1"></a>gr1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">15</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb129-6"><a href="analyser.html#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="analyser.html#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Méthode 2</span></span>
<span id="cb129-8"><a href="analyser.html#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb129-9"><a href="analyser.html#cb129-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-10"><a href="analyser.html#cb129-10" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">15</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">15</span>)) <span class="co"># Appartenance au groupe (0 et 1)</span></span>
<span id="cb129-11"><a href="analyser.html#cb129-11" aria-hidden="true" tabindex="-1"></a>e  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># Erreur interindividuel</span></span>
<span id="cb129-12"><a href="analyser.html#cb129-12" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># La moyenne du groupe référent</span></span>
<span id="cb129-13"><a href="analyser.html#cb129-13" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="co"># Le deuxième groupe a une différence de moyenne de -1</span></span>
<span id="cb129-14"><a href="analyser.html#cb129-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-15"><a href="analyser.html#cb129-15" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> mu0 <span class="sc">+</span> mu1 <span class="sc">*</span> x1 <span class="sc">+</span> e</span>
<span id="cb129-16"><a href="analyser.html#cb129-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-17"><a href="analyser.html#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Présenter quelques participants; retirer les crochets pour voir tous</span></span>
<span id="cb129-18"><a href="analyser.html#cb129-18" aria-hidden="true" tabindex="-1"></a>(<span class="fu">cbind</span>(<span class="at">method1 =</span> <span class="fu">c</span>(gr0, gr1), <span class="at">method2 =</span> y))[<span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>,]</span>
<span id="cb129-19"><a href="analyser.html#cb129-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>       method1 method2</span>
<span id="cb129-20"><a href="analyser.html#cb129-20" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">1</span>,]  <span class="fl">2.7300</span>  <span class="fl">2.7300</span></span>
<span id="cb129-21"><a href="analyser.html#cb129-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">2</span>,] <span class="sc">-</span><span class="fl">0.0822</span> <span class="sc">-</span><span class="fl">0.0822</span></span>
<span id="cb129-22"><a href="analyser.html#cb129-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">3</span>,]  <span class="fl">0.7272</span>  <span class="fl">0.7272</span></span>
<span id="cb129-23"><a href="analyser.html#cb129-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">4</span>,]  <span class="fl">1.1820</span>  <span class="fl">1.1820</span></span>
<span id="cb129-24"><a href="analyser.html#cb129-24" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">5</span>,]  <span class="fl">2.5085</span>  <span class="fl">2.5085</span></span>
<span id="cb129-25"><a href="analyser.html#cb129-25" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">6</span>,]  <span class="fl">2.6045</span>  <span class="fl">2.6045</span></span>
<span id="cb129-26"><a href="analyser.html#cb129-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">7</span>,] <span class="sc">-</span><span class="fl">1.8415</span> <span class="sc">-</span><span class="fl">1.8415</span></span>
<span id="cb129-27"><a href="analyser.html#cb129-27" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">8</span>,]  <span class="fl">1.6233</span>  <span class="fl">1.6233</span></span>
<span id="cb129-28"><a href="analyser.html#cb129-28" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>  [<span class="dv">9</span>,]  <span class="fl">0.1314</span>  <span class="fl">0.1314</span></span>
<span id="cb129-29"><a href="analyser.html#cb129-29" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">10</span>,]  <span class="fl">1.4811</span>  <span class="fl">1.4811</span></span>
<span id="cb129-30"><a href="analyser.html#cb129-30" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">11</span>,]  <span class="fl">1.5133</span>  <span class="fl">1.5133</span></span></code></pre></div>
<p>Les données sont identiques.</p>
<p>Une fois la fonction créée, il est possible de la tester et de la comparer avec la fonction <strong>R</strong> de base <code>test.t()</code>.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="analyser.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérification de la fonction maison</span></span>
<span id="cb130-2"><a href="analyser.html#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">testt.ind</span>(gr0, gr1)</span>
<span id="cb130-3"><a href="analyser.html#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="er">$</span>valeur.t</span>
<span id="cb130-4"><a href="analyser.html#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">3.4</span></span>
<span id="cb130-5"><a href="analyser.html#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb130-6"><a href="analyser.html#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>dl</span>
<span id="cb130-7"><a href="analyser.html#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="dv">28</span></span>
<span id="cb130-8"><a href="analyser.html#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb130-9"><a href="analyser.html#cb130-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>valeur.p</span>
<span id="cb130-10"><a href="analyser.html#cb130-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.00205</span></span>
<span id="cb130-11"><a href="analyser.html#cb130-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-12"><a href="analyser.html#cb130-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparer avec la fonction R</span></span>
<span id="cb130-13"><a href="analyser.html#cb130-13" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(gr0, gr1, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb130-14"><a href="analyser.html#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb130-15"><a href="analyser.html#cb130-15" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Two Sample t<span class="sc">-</span>test</span>
<span id="cb130-16"><a href="analyser.html#cb130-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb130-17"><a href="analyser.html#cb130-17" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> data<span class="sc">:</span>  gr0 and gr1</span>
<span id="cb130-18"><a href="analyser.html#cb130-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> t <span class="ot">=</span> <span class="dv">3</span>, df <span class="ot">=</span> <span class="dv">28</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.002</span></span>
<span id="cb130-19"><a href="analyser.html#cb130-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> alternative hypothesis<span class="sc">:</span> true difference <span class="cf">in</span> means is not equal to <span class="dv">0</span></span>
<span id="cb130-20"><a href="analyser.html#cb130-20" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb130-21"><a href="analyser.html#cb130-21" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  <span class="fl">0.54</span> <span class="fl">2.18</span></span>
<span id="cb130-22"><a href="analyser.html#cb130-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> sample estimates<span class="sc">:</span></span>
<span id="cb130-23"><a href="analyser.html#cb130-23" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mean of x mean of y </span>
<span id="cb130-24"><a href="analyser.html#cb130-24" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>     <span class="fl">1.332</span>    <span class="sc">-</span><span class="fl">0.029</span></span></code></pre></div>
<p>Les équations et codes précédents ne sont adéquats que si les variances sont égales entre les deux groupes. Cette notion est quelque peu trahie par la spécification dans la fonction <strong>R</strong> de l’argument <code>var.equal = TRUE</code> qui par défaut est <code>FALSE</code>. Pour un test-<span class="math inline">\(t\)</span> indépendant suivant les règles de l’art, il faut appliquer une correction (approximation de Welsh) aux degrés de liberté. Les degrés de liberté deviennent moins élégants et respectent l’équation <a href="analyser.html#eq:welsh">(11.3)</a>.</p>
<p><span class="math display" id="eq:welsh">\[\begin{equation}
dl=\frac{\left(\frac{s^2_1}{n_1}+\frac{s^2_2}{n_2}\right)^2}{\frac{\left(\frac{s^2_1}{n_1}\right)^2}{n_1-1}+\frac{\left(\frac{s^2_2}{n_2}\right)^2}{n_2-1}}
\tag{11.3}
\end{equation}\]</span></p>
<p>En apportant cette correction au code initial.</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testt.ind2</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># x1 est une variable continue associée au groupe 1</span></span>
<span>  <span class="co"># x2 est une variable continue associée au groupe 2</span></span>
<span>  <span class="va">x1bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> ; <span class="va">x2bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>  <span class="co"># Les moyennes</span></span>
<span>  <span class="va">x1var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> ; <span class="va">x2var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>    <span class="co"># Les variances</span></span>
<span>  <span class="va">nx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> ; <span class="va">nx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>  <span class="co"># Les tailles</span></span>
<span>  </span>
<span>  <span class="co"># L'erreur type </span></span>
<span>  <span class="va">et</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">x1var</span> <span class="op">/</span> <span class="va">nx1</span> <span class="op">+</span> <span class="va">x2var</span> <span class="op">/</span> <span class="va">nx2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Valeur-t</span></span>
<span>  <span class="va">vt</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x1bar</span> <span class="op">-</span> <span class="va">x2bar</span><span class="op">)</span> <span class="op">/</span> <span class="va">et</span></span>
<span>  </span>
<span>  <span class="co"># Correction des degrés de liberté</span></span>
<span>  <span class="va">dl</span> <span class="op">&lt;-</span> <span class="va">et</span><span class="op">^</span><span class="fl">4</span> <span class="op">/</span> </span>
<span>    <span class="op">(</span><span class="op">(</span><span class="va">x1var</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="va">nx1</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">nx1</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="op">(</span><span class="va">x2var</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="va">nx2</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">nx2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Valeur-p</span></span>
<span>  <span class="va">vp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">vt</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">dl</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> </span>
<span>  </span>
<span>  <span class="va">statistique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>valeur.t <span class="op">=</span> <span class="va">vt</span>, dl <span class="op">=</span> <span class="va">dl</span>, valeur.p <span class="op">=</span> <span class="va">vp</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">statistique</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Le voici comparé à la fonction <strong>R</strong> de base.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="analyser.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(gr0, gr1) <span class="co"># Absence de l'argument var.equal = TRUE</span></span>
<span id="cb132-2"><a href="analyser.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb132-3"><a href="analyser.html#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Welch Two Sample t<span class="sc">-</span>test</span>
<span id="cb132-4"><a href="analyser.html#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb132-5"><a href="analyser.html#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> data<span class="sc">:</span>  gr0 and gr1</span>
<span id="cb132-6"><a href="analyser.html#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> t <span class="ot">=</span> <span class="dv">3</span>, df <span class="ot">=</span> <span class="dv">27</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.002</span></span>
<span id="cb132-7"><a href="analyser.html#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> alternative hypothesis<span class="sc">:</span> true difference <span class="cf">in</span> means is not equal to <span class="dv">0</span></span>
<span id="cb132-8"><a href="analyser.html#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb132-9"><a href="analyser.html#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  <span class="fl">0.539</span> <span class="fl">2.182</span></span>
<span id="cb132-10"><a href="analyser.html#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> sample estimates<span class="sc">:</span></span>
<span id="cb132-11"><a href="analyser.html#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mean of x mean of y </span>
<span id="cb132-12"><a href="analyser.html#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>     <span class="fl">1.332</span>    <span class="sc">-</span><span class="fl">0.029</span></span>
<span id="cb132-13"><a href="analyser.html#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="fu">testt.ind2</span>(gr0, gr1)</span>
<span id="cb132-14"><a href="analyser.html#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="er">$</span>valeur.t</span>
<span id="cb132-15"><a href="analyser.html#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">3.4</span></span>
<span id="cb132-16"><a href="analyser.html#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb132-17"><a href="analyser.html#cb132-17" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>dl</span>
<span id="cb132-18"><a href="analyser.html#cb132-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">26.9</span></span>
<span id="cb132-19"><a href="analyser.html#cb132-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb132-20"><a href="analyser.html#cb132-20" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>valeur.p</span>
<span id="cb132-21"><a href="analyser.html#cb132-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.00213</span></span></code></pre></div>
<p>Les sorties sont identiques.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:disttt"></span>
<img src="11-Analyser_files/figure-html/disttt-1.png" alt="Valeur-$t$ de la différence de moyenne sur la distribution-$t$" width="75%" height="75%"><p class="caption">
Figure 11.1: Valeur-<span class="math inline">\(t\)</span> de la différence de moyenne sur la distribution-<span class="math inline">\(t\)</span>
</p>
</div>
<p>La Figure <a href="analyser.html#fig:disttt">11.1</a> illustre où se situe la moyenne de l’échantillon par rapport à la distribution d’échantillonnage de l’hypothèse nulle. Comme la valeur se retrouve dans la zone de rejet ou, de façon équivalente, la valeur-<span class="math inline">\(p\)</span> est plus petite que la valeur <span class="math inline">\(\alpha\)</span> fixée à .05, on rejette l’hypothèse nulle, il y a vraisemblablement une différence entre les groupes. C’est bien l’intention derrière la création des données.</p>
</div>
<div id="rapporter-un-test-t-indépendant" class="section level3" number="11.1.2">
<h3>
<span class="header-section-number">11.1.2</span> Rapporter un test-<span class="math inline">\(t\)</span> indépendant<a class="anchor" aria-label="anchor" href="#rapporter-un-test-t-ind%C3%A9pendant"><i class="fas fa-link"></i></a>
</h3>
<p>Voici comment il est possible de rapporter les résultats. La syntaxe pour commander l’analyse est la suivante si les groupes sont dans deux vecteurs séparés.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="analyser.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(gr0, gr1) <span class="co"># Absence de l'argument var.equal = TRUE</span></span>
<span id="cb133-2"><a href="analyser.html#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb133-3"><a href="analyser.html#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Welch Two Sample t<span class="sc">-</span>test</span>
<span id="cb133-4"><a href="analyser.html#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb133-5"><a href="analyser.html#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> data<span class="sc">:</span>  gr0 and gr1</span>
<span id="cb133-6"><a href="analyser.html#cb133-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> t <span class="ot">=</span> <span class="dv">3</span>, df <span class="ot">=</span> <span class="dv">27</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.002</span></span>
<span id="cb133-7"><a href="analyser.html#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> alternative hypothesis<span class="sc">:</span> true difference <span class="cf">in</span> means is not equal to <span class="dv">0</span></span>
<span id="cb133-8"><a href="analyser.html#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb133-9"><a href="analyser.html#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  <span class="fl">0.539</span> <span class="fl">2.182</span></span>
<span id="cb133-10"><a href="analyser.html#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> sample estimates<span class="sc">:</span></span>
<span id="cb133-11"><a href="analyser.html#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mean of x mean of y </span>
<span id="cb133-12"><a href="analyser.html#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>     <span class="fl">1.332</span>    <span class="sc">-</span><span class="fl">0.029</span></span></code></pre></div>
<p>Il est également possible d’utiliser la formule si, dans le jeu de données, une variable permet de distinguer les deux groupes et que la variable continue (variable à comparer) se trouve dans une seule variable.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="analyser.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre les variables en jeu de données</span></span>
<span id="cb134-2"><a href="analyser.html#cb134-2" aria-hidden="true" tabindex="-1"></a>jd.ti <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">VD =</span> <span class="fu">c</span>(gr0, gr1),</span>
<span id="cb134-3"><a href="analyser.html#cb134-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">VI =</span> x1)</span>
<span id="cb134-4"><a href="analyser.html#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(VD <span class="sc">~</span> VI, <span class="at">data =</span> jd.ti)</span>
<span id="cb134-5"><a href="analyser.html#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb134-6"><a href="analyser.html#cb134-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Welch Two Sample t<span class="sc">-</span>test</span>
<span id="cb134-7"><a href="analyser.html#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb134-8"><a href="analyser.html#cb134-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> data<span class="sc">:</span>  VD by VI</span>
<span id="cb134-9"><a href="analyser.html#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> t <span class="ot">=</span> <span class="dv">3</span>, df <span class="ot">=</span> <span class="dv">27</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.002</span></span>
<span id="cb134-10"><a href="analyser.html#cb134-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> alternative hypothesis<span class="sc">:</span> true difference <span class="cf">in</span> means between group <span class="dv">0</span> and group <span class="dv">1</span> is not equal to <span class="dv">0</span></span>
<span id="cb134-11"><a href="analyser.html#cb134-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb134-12"><a href="analyser.html#cb134-12" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  <span class="fl">0.539</span> <span class="fl">2.182</span></span>
<span id="cb134-13"><a href="analyser.html#cb134-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> sample estimates<span class="sc">:</span></span>
<span id="cb134-14"><a href="analyser.html#cb134-14" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mean <span class="cf">in</span> group <span class="dv">0</span> mean <span class="cf">in</span> group <span class="dv">1</span> </span>
<span id="cb134-15"><a href="analyser.html#cb134-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>           <span class="fl">1.332</span>          <span class="sc">-</span><span class="fl">0.029</span></span></code></pre></div>
<blockquote>
<p>La présente étude compare deux groupes sur une échelle de mesure psychologique. Le test-<span class="math inline">\(t\)</span> indépendant suggère que la différence entre les groupes est significative, <span class="math inline">\(t(26.912) =3.398, p = 0.002\)</span>.</p>
</blockquote>
</div>
<div id="le-test-t-dépendant" class="section level3" number="11.1.3">
<h3>
<span class="header-section-number">11.1.3</span> Le test-<span class="math inline">\(t\)</span> dépendant<a class="anchor" aria-label="anchor" href="#le-test-t-d%C3%A9pendant"><i class="fas fa-link"></i></a>
</h3>
<p>Un autre test-<span class="math inline">\(t\)</span> est celui permettant de comparer deux de temps de mesure sur les mêmes participants. L’hypothèse est de vérifier si <span class="math inline">\(\mu_1 = \mu_2\)</span>, soit la moyenne du temps 1 est égale à la moyenne du temps 2. Une habile manipulation mathématique permet de poser cette hypothèse en hypothèse nulle, <span class="math inline">\(\mu_1-\mu_2=0\)</span>. Il est intéressant de noter que la différence entre deux variables est normalement distribuée si la variance est connue ou distribuée en <span class="math inline">\(t\)</span> si la variance est inconnue.</p>
<p>Ce test est utile lorsqu’il faut tester si les participants se sont améliorés ou détériorés entre deux temps de mesure. Pour calculer la valeur-<span class="math inline">\(t\)</span>,</p>
<p><span class="math display">\[ t_{dl_1} = \frac{\bar{x_1}-\bar{x_2}}{\sigma_d/\sqrt{n}} \]</span></p>
<p>avec <span class="math inline">\(n-1\)</span> degrés de liberté à cause de l’estimation de l’écart type des différences. Les étapes subséquentes sont identiques au test-<span class="math inline">\(t\)</span> à groupe unique.</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testt.dep</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temps1</span>, <span class="va">temps2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># Temps est une variable continue mesurée </span></span>
<span>  <span class="co"># à deux occasions auprès des mêmes participants</span></span>
<span>  </span>
<span>  <span class="co"># Calculer la différence</span></span>
<span>  <span class="va">difference</span> <span class="op">&lt;-</span> <span class="va">temps1</span> <span class="op">-</span> <span class="va">temps2</span></span>
<span>  <span class="va">dbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">difference</span><span class="op">)</span> <span class="co"># La moyenne des différences</span></span>
<span>  <span class="va">dvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">difference</span><span class="op">)</span>  <span class="co"># L'écart type des différences</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">difference</span><span class="op">)</span>  <span class="co"># Taille d'échantillon</span></span>
<span>  </span>
<span>  <span class="co"># Valeur-t, degrés de liberté et valeur-p</span></span>
<span>  <span class="va">vt</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">dbar</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">dvar</span> <span class="op">/</span> <span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">dl</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>                   </span>
<span>  <span class="va">vp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">vt</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">dl</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> </span>
<span>  <span class="va">statistique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>valeur.t <span class="op">=</span> <span class="va">vt</span>, dl <span class="op">=</span> <span class="va">dl</span>, valeur.p <span class="op">=</span> <span class="va">vp</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">statistique</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Pour créer le jeu de données, les étapes sont similaires au test-<span class="math inline">\(t\)</span> indépendant pour des temps de mesure indépendants (sans corrélation) où seules les populations des temps de mesure sont définis. Il est possible de spécifier une corrélation entre les deux de mesures. Cela sera introduit dans la section <a href="analyser.html#la-corr%C3%A9lation">La corrélation</a>.</p>
<p>Dans le jeu de données suivant, 25 personnes sont mesurées à deux temps de reprises. Il n’y a pas de corrélation entre les temps de mesure. La variance des temps de mesure est de 1. La différence de moyenne est de 2. La syntaxe simule la situation suivante, le <code>temps1</code> correspond à la mesure initiale et <code>difference</code> correspond à la différence entre les temps de mesure. La somme de ces deux scores donnent la mesure au <code>temps2</code>. Cela montre assez simplement que la différence entre <code>temps2 - temps1</code> permet de retrouver le vecteur de <code>difference</code>.</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Un exemple de jeu de données</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">148</span><span class="op">)</span></span>
<span><span class="va">temps1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">difference</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">temps2</span> <span class="op">&lt;-</span> <span class="va">temps1</span> <span class="op">+</span> <span class="va">difference</span></span></code></pre></div>
<p>La fonction base de <strong>R</strong> est encore <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code>, mais il faudra spécifier l’argument <code>paired = TRUE</code> pour commander un test apparié (une autre appellation pour un test-<span class="math inline">\(t\)</span> dépendant).</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="analyser.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(temps1, temps2, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb137-2"><a href="analyser.html#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb137-3"><a href="analyser.html#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Paired t<span class="sc">-</span>test</span>
<span id="cb137-4"><a href="analyser.html#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb137-5"><a href="analyser.html#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> data<span class="sc">:</span>  temps1 and temps2</span>
<span id="cb137-6"><a href="analyser.html#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> t <span class="ot">=</span> <span class="sc">-</span><span class="dv">3</span>, df <span class="ot">=</span> <span class="dv">24</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.004</span></span>
<span id="cb137-7"><a href="analyser.html#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> alternative hypothesis<span class="sc">:</span> true mean difference is not equal to <span class="dv">0</span></span>
<span id="cb137-8"><a href="analyser.html#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb137-9"><a href="analyser.html#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  <span class="sc">-</span><span class="fl">2.172</span> <span class="sc">-</span><span class="fl">0.465</span></span>
<span id="cb137-10"><a href="analyser.html#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> sample estimates<span class="sc">:</span></span>
<span id="cb137-11"><a href="analyser.html#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mean difference </span>
<span id="cb137-12"><a href="analyser.html#cb137-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>           <span class="sc">-</span><span class="fl">1.32</span></span>
<span id="cb137-13"><a href="analyser.html#cb137-13" aria-hidden="true" tabindex="-1"></a><span class="fu">testt.dep</span>(temps1, temps2)</span>
<span id="cb137-14"><a href="analyser.html#cb137-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="er">$</span>valeur.t</span>
<span id="cb137-15"><a href="analyser.html#cb137-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="sc">-</span><span class="fl">3.19</span></span>
<span id="cb137-16"><a href="analyser.html#cb137-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb137-17"><a href="analyser.html#cb137-17" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>dl</span>
<span id="cb137-18"><a href="analyser.html#cb137-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="dv">24</span></span>
<span id="cb137-19"><a href="analyser.html#cb137-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb137-20"><a href="analyser.html#cb137-20" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>valeur.p</span>
<span id="cb137-21"><a href="analyser.html#cb137-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.00395</span></span></code></pre></div>
<p>Les sorties sont identiques.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:testtttt"></span>
<img src="11-Analyser_files/figure-html/testtttt-1.png" alt="Valeur-$t$ de moyenne de différences sur la distribution-$t$" width="75%" height="75%"><p class="caption">
Figure 11.2: Valeur-<span class="math inline">\(t\)</span> de moyenne de différences sur la distribution-<span class="math inline">\(t\)</span>
</p>
</div>
<p>La Figure <a href="analyser.html#fig:testtttt">11.2</a> montre où se situe la différence de moyenne par rapport à la distribution d’échantillonnage de l’hypothèse nulle. Comme la valeur se retrouve dans la valeur-<span class="math inline">\(p\)</span> est plus petite que la valeur <span class="math inline">\(\alpha\)</span> fixée à .05, on rejette l’hypothèse nulle; il y a vraisemblablement une différence entre les temps de mesure, ce qui était l’intention derrière la création des données.</p>
<div id="autres-syntaxes-possibles" class="section level4" number="11.1.3.1">
<h4>
<span class="header-section-number">11.1.3.1</span> Autres syntaxes possibles<a class="anchor" aria-label="anchor" href="#autres-syntaxes-possibles"><i class="fas fa-link"></i></a>
</h4>
<p>Il y a plusieurs façons de réaliser un test-<span class="math inline">\(t\)</span> dépendant. La première option est celle décrite précédemment.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="analyser.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Technique précédent avec deux vecteurs</span></span>
<span id="cb138-2"><a href="analyser.html#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> temps1, <span class="at">y =</span> temps2, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-3"><a href="analyser.html#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb138-4"><a href="analyser.html#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Paired t<span class="sc">-</span>test</span>
<span id="cb138-5"><a href="analyser.html#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb138-6"><a href="analyser.html#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> data<span class="sc">:</span>  temps1 and temps2</span>
<span id="cb138-7"><a href="analyser.html#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> t <span class="ot">=</span> <span class="sc">-</span><span class="dv">3</span>, df <span class="ot">=</span> <span class="dv">24</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.004</span></span>
<span id="cb138-8"><a href="analyser.html#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> alternative hypothesis<span class="sc">:</span> true mean difference is not equal to <span class="dv">0</span></span>
<span id="cb138-9"><a href="analyser.html#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb138-10"><a href="analyser.html#cb138-10" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  <span class="sc">-</span><span class="fl">2.172</span> <span class="sc">-</span><span class="fl">0.465</span></span>
<span id="cb138-11"><a href="analyser.html#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> sample estimates<span class="sc">:</span></span>
<span id="cb138-12"><a href="analyser.html#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mean difference </span>
<span id="cb138-13"><a href="analyser.html#cb138-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>           <span class="sc">-</span><span class="fl">1.32</span></span></code></pre></div>
<p>La second option utilise la formule et le jeu de données. La fonction <code><a href="https://rdrr.io/r/stats/Pair.html">Pair()</a></code> n’a que seule objectif d’informer la fonction <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> que les vecteurs qu’elle inclut sont pairés, ce qui permet d’utiliser la formule <code>Pair(temps1, temps2) ~ 1</code>.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="analyser.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec la formule et les variables dans le même jeu de données</span></span>
<span id="cb139-2"><a href="analyser.html#cb139-2" aria-hidden="true" tabindex="-1"></a>jd.td <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">temps1 =</span> temps1,</span>
<span id="cb139-3"><a href="analyser.html#cb139-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">temps2 =</span> temps2)</span>
<span id="cb139-4"><a href="analyser.html#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">Pair</span>(temps1, temps2) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> jd.td)</span>
<span id="cb139-5"><a href="analyser.html#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb139-6"><a href="analyser.html#cb139-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Paired t<span class="sc">-</span>test</span>
<span id="cb139-7"><a href="analyser.html#cb139-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb139-8"><a href="analyser.html#cb139-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> data<span class="sc">:</span>  <span class="fu">Pair</span>(temps1, temps2)</span>
<span id="cb139-9"><a href="analyser.html#cb139-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> t <span class="ot">=</span> <span class="sc">-</span><span class="dv">3</span>, df <span class="ot">=</span> <span class="dv">24</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.004</span></span>
<span id="cb139-10"><a href="analyser.html#cb139-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> alternative hypothesis<span class="sc">:</span> true mean difference is not equal to <span class="dv">0</span></span>
<span id="cb139-11"><a href="analyser.html#cb139-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb139-12"><a href="analyser.html#cb139-12" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  <span class="sc">-</span><span class="fl">2.172</span> <span class="sc">-</span><span class="fl">0.465</span></span>
<span id="cb139-13"><a href="analyser.html#cb139-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> sample estimates<span class="sc">:</span></span>
<span id="cb139-14"><a href="analyser.html#cb139-14" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mean difference </span>
<span id="cb139-15"><a href="analyser.html#cb139-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>           <span class="sc">-</span><span class="fl">1.32</span></span></code></pre></div>
<p>Pour la troisième option, comme l’équation sur le test-<span class="math inline">\(t\)</span> dépendant le suggère, un test-<span class="math inline">\(t\)</span> dépendant revient à faire <a href="inf%C3%A9rer.html#le-test-t-%C3%A0-%C3%A9chantillon-unique">un test-<span class="math inline">\(t\)</span> à échantillon unique</a> avec la différence entre les deux temps de mesure.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="analyser.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec la différence des deux vecteurs</span></span>
<span id="cb140-2"><a href="analyser.html#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(temps2 <span class="sc">-</span> temps1)</span>
<span id="cb140-3"><a href="analyser.html#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb140-4"><a href="analyser.html#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   One Sample t<span class="sc">-</span>test</span>
<span id="cb140-5"><a href="analyser.html#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb140-6"><a href="analyser.html#cb140-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> data<span class="sc">:</span>  temps2 <span class="sc">-</span> temps1</span>
<span id="cb140-7"><a href="analyser.html#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> t <span class="ot">=</span> <span class="dv">3</span>, df <span class="ot">=</span> <span class="dv">24</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.004</span></span>
<span id="cb140-8"><a href="analyser.html#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> alternative hypothesis<span class="sc">:</span> true mean is not equal to <span class="dv">0</span></span>
<span id="cb140-9"><a href="analyser.html#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb140-10"><a href="analyser.html#cb140-10" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  <span class="fl">0.465</span> <span class="fl">2.172</span></span>
<span id="cb140-11"><a href="analyser.html#cb140-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> sample estimates<span class="sc">:</span></span>
<span id="cb140-12"><a href="analyser.html#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mean of x </span>
<span id="cb140-13"><a href="analyser.html#cb140-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      <span class="fl">1.32</span></span></code></pre></div>
<p>Une quatrième option, si le temps est une colonne dans le jeu de données, alors le même style de formule peut être utilisé comme <a href="analyser.html#le-test-t-ind%C3%A9pendant">Le test-<span class="math inline">\(t\)</span> indépendant</a> toujours en indiquant <code>paired = TRUE</code>.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="analyser.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec la formule et les variables dans le même jeu de données</span></span>
<span id="cb141-2"><a href="analyser.html#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Le temps est une seule variable</span></span>
<span id="cb141-3"><a href="analyser.html#cb141-3" aria-hidden="true" tabindex="-1"></a>jd.td2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">mesure =</span> <span class="fu">c</span>(temps1, temps2),</span>
<span id="cb141-4"><a href="analyser.html#cb141-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">temps =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">each =</span> <span class="dv">25</span>))</span>
<span id="cb141-5"><a href="analyser.html#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(mesure <span class="sc">~</span> temps, <span class="at">data =</span> jd.td2, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb141-6"><a href="analyser.html#cb141-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb141-7"><a href="analyser.html#cb141-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Paired t<span class="sc">-</span>test</span>
<span id="cb141-8"><a href="analyser.html#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb141-9"><a href="analyser.html#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> data<span class="sc">:</span>  mesure by temps</span>
<span id="cb141-10"><a href="analyser.html#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> t <span class="ot">=</span> <span class="sc">-</span><span class="dv">3</span>, df <span class="ot">=</span> <span class="dv">24</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.004</span></span>
<span id="cb141-11"><a href="analyser.html#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> alternative hypothesis<span class="sc">:</span> true mean difference is not equal to <span class="dv">0</span></span>
<span id="cb141-12"><a href="analyser.html#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb141-13"><a href="analyser.html#cb141-13" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  <span class="sc">-</span><span class="fl">2.172</span> <span class="sc">-</span><span class="fl">0.465</span></span>
<span id="cb141-14"><a href="analyser.html#cb141-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> sample estimates<span class="sc">:</span></span>
<span id="cb141-15"><a href="analyser.html#cb141-15" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> mean difference </span>
<span id="cb141-16"><a href="analyser.html#cb141-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>           <span class="sc">-</span><span class="fl">1.32</span></span></code></pre></div>
</div>
</div>
<div id="rapporter-un-test-t-dépendant" class="section level3" number="11.1.4">
<h3>
<span class="header-section-number">11.1.4</span> Rapporter un test-<span class="math inline">\(t\)</span> dépendant<a class="anchor" aria-label="anchor" href="#rapporter-un-test-t-d%C3%A9pendant"><i class="fas fa-link"></i></a>
</h3>
<p>Voici comment rapporter dans un article.</p>
<blockquote>
<p>Un groupe de participants est mesuré à deux reprises sur une même mesure psychologique. Le test-<span class="math inline">\(t\)</span> dépendant suggère que la différence entre les temps de mesure est significative, <span class="math inline">\(t(24) =-3.188, p = 0.002\)</span>.</p>
</blockquote>
</div>
</div>
<div id="lassociation-linéaire" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> L’association linéaire<a class="anchor" aria-label="anchor" href="#lassociation-lin%C3%A9aire"><i class="fas fa-link"></i></a>
</h2>
<div id="la-covariance" class="section level3" number="11.2.1">
<h3>
<span class="header-section-number">11.2.1</span> La covariance<a class="anchor" aria-label="anchor" href="#la-covariance"><i class="fas fa-link"></i></a>
</h3>
<p>La covariance représente une mesure du degré auquel une variable augmente lorsque l’autre augmente. Elle correspond au produit moyen entre deux variables centrées (dont les moyennes sont soustraites). On retrouve la covariance sous la forme de l’équation <a href="analyser.html#eq:cov101">(11.4)</a>.</p>
<p><span class="math display" id="eq:cov101">\[\begin{equation}
\text{cov}_{xy} = \sigma_{xy}=\frac{1}{n-1}\sum_{i=1}^n(x_i-\bar{x})(y_i-\bar{y})
\tag{11.4}
\end{equation}\]</span></p>
<p>La covariance est une extension multivariée de la variance. La variance est le produit d’une variable <strong>centrée</strong> avec elle-même (le carré de la variable), <span class="math display">\[\sigma^2=\frac{1}{n-1}\sum_{i=1}^nx_ix_i\]</span>.</p>
<p>En transformant <span class="math inline">\(x\)</span> et <span class="math inline">\(y\)</span> pour qu’elles soient <strong>centrées</strong>, l’aspect de produit entre les deux variables devient évident dans l’expression de la covariance.
<span class="math display">\[\text{cov}_{xy} = \frac{1}{n-1}\sum_{i=1}^nxy\]</span>
La programmation de la covariance peut se traduire ainsi.</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covariance</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># X est une data.frame ou matrice de n sujets par p variables</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="co"># centrer variables</span></span>
<span>  <span class="va">xc</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">yc</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  <span class="va">prod.xy</span> <span class="op">&lt;-</span> <span class="va">xc</span> <span class="op">*</span> <span class="va">yc</span></span>
<span>  <span class="va">cov.xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">prod.xy</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">cov.xy</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>La fonction de base <code><a href="https://rdrr.io/r/stats/cor.html">cov()</a></code> est plus efficace (plus robuste et plus simple) que la fonction maison précédente. La fonction <code><a href="https://rdrr.io/r/stats/cor.html">cov()</a></code> peut tenir compte de plus de deux variables.
La covariance indique la direction de la covariation entre les deux variables, positives ou négatives, mais n’indique pas la force de la relation. Bien qu’une covariance de 0 indique l’absence de colinéarité, une covariance de 120 n’est pas nécessairement plus forte qu’une covariance de 1. La mesure est intrinsèquement influencée par les unités l’échelle de mesure. Il serait aberrant de considérer le système métrique comme moins efficace, car ces mesures sont moins variables que les mesures impériales. (Il y a plusieurs raisons de préférer le système métrique, mais ce n’en est pas une!)</p>
</div>
<div id="la-corrélation" class="section level3" number="11.2.2">
<h3>
<span class="header-section-number">11.2.2</span> La corrélation<a class="anchor" aria-label="anchor" href="#la-corr%C3%A9lation"><i class="fas fa-link"></i></a>
</h3>
<p>La corrélation représente le degré d’association linéaire entre deux variables. Une façon simple de concevoir la corrélation est comme une covariance standardisée. Elle varie entre -1 et 1, ces deux dernières valeurs impliquant, respectivement, une relation parfaitement négative et positive entre les deux variables. En plus d’indiquer la direction de la relation, la corrélation suggère une force à ce lien. Lorsque la valeur de la corrélation est nulle, <span class="math inline">\(r=0\)</span>, un diagramme de dispersion ne montre qu’un nuage de point épars (sans structure). Plus la corrélation augmente (en terme absolu), plus le nuage tends vers une ligne droite. La Figure <a href="analyser.html#fig:corimage">11.3</a> montre différentes valeurs de corrélation et un exemple de nuage de points qui lui est associé.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:corimage"></span>
<img src="11-Analyser_files/figure-html/corimage-1.png" alt="Illustrations de diagrammes de dispersion associé en fonction de corrélations" width="50%" height="50%"><p class="caption">
Figure 11.3: Illustrations de diagrammes de dispersion associé en fonction de corrélations
</p>
</div>
<p>En statistiques, la corrélation est souvent représentée par la lettre grecque <span class="math inline">\(\rho\)</span> (rho) ou l’usuel <span class="math inline">\(r\)</span> lorsqu’il s’agit d’une estimation à partir d’un échantillon.</p>
<p>Il y a plusieurs méthodes pour calculer la corrélation. Une première est de considérer la corrélation comme le produit de variables standardisées (autrement dit, score-<span class="math inline">\(z\)</span>). Pour la covariance, la moyenne était soustraite de la variable, c’est-à-dire des variables centrées. Pour la corrélation, on divise pas l’écart type également pour obtenir des variables standardisées.</p>
<p>En admettant que <span class="math inline">\(x\)</span> et <span class="math inline">\(y\)</span> sont déjà <strong>standardisée</strong>, <span class="math inline">\(z_x,z_y\)</span>, comme c’était le cas pour la covariance, l’aspect de produit entre les deux variables est conservé.
<span class="math display">\[\text{cor}_{xy} = r_{xy}= \frac{1}{n-1}\sum_{i=1}^nz_xz_y\]</span></p>
<p>Il est possible de calculer directement la corrélation à partir de la covariance, soit en divisant par le produit des écarts types des variables.</p>
<p><span class="math display">\[r_{xy} = \frac{\text{cov}_{xy}}{\sigma_x\sigma_y}\]</span></p>
<p>Voici trois options de programmation de la corrélation. La première et la deuxième sont basées sur la covariance. Dans la première, la covariance est calculée de nouveau dans la fonction. La deuxième quant à elle profite avantageusement de l’existence d’une fonction maison qui calcule directement la covariance. La troisième recourt au produit de variables standardisées.</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Option 1 : Calcul complet</span></span>
<span><span class="va">correlation1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># La taille d'échantillon</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Centrer les variables</span></span>
<span>  <span class="va">xc</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">yc</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Produit des variables</span></span>
<span>  <span class="va">prod.xy</span> <span class="op">&lt;-</span> <span class="va">xc</span> <span class="op">*</span> <span class="va">yc</span></span>
<span>  </span>
<span>  <span class="co"># La somme des produits divisée par n - 1</span></span>
<span>  <span class="va">cov.xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">prod.xy</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>  <span class="co"># La covariance</span></span>
<span>  </span>
<span>  <span class="co"># Diviser par les écarts types</span></span>
<span>  <span class="va">cor.xy</span> <span class="op">&lt;-</span> <span class="va">cov.xy</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">cor.xy</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Option 2 : Basé sur la covariance</span></span>
<span><span class="va">correlation2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Calculer la covariance</span></span>
<span>  <span class="va">cov.xy</span> <span class="op">&lt;-</span> <span class="fu">covariance</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Diviser par les écarts types</span></span>
<span>  <span class="va">cor.xy</span> <span class="op">&lt;-</span> <span class="va">cov.xy</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">cor.xy</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Option 3 : Basé sur des variables standardisées</span></span>
<span><span class="va">correlation3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># La taille d'échantillon</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Centrer et réduire les variables</span></span>
<span>  <span class="va">xs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">ys</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># La somme des produits divisé par n - 1</span></span>
<span>  <span class="va">cor.xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xs</span> <span class="op">*</span> <span class="va">ys</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">cor.xy</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Évidemment, <strong>R</strong> possède une fonction de base pour le calcul d’une corrélation entre deux variables ou d’une matrice de corrélation (à partir d’un jeu de données de deux variables ou plus). Il s’agit de <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code>. Ces trois fonctions maison en plus de la fonction <strong>R</strong> sont comparées ci-dessous. Pour ce faire, un jeu de données est créé possédant les caractéristiques désirées. Dans ce cas-ci, la taille d’échantillon est fixée à <span class="math inline">\(n=10000\)</span> pour assurer une bonne précision dans l’échantillon et une corrélation <span class="math inline">\(r=.7\)</span>.</p>
<p>Une façon simple de produire des données à partir d’une matrice de corrélation (ou de covariance) est d’utiliser la fonction <code>mvrnorm()</code> du package <code>MASS</code>. Elle évite pour l’instant d’introduire les manipulations mathématiques nécessaires (ce sera donc pour l’instant l’une de ces boîtes noires ayant la confiance de l’utilisateur, mais élucider dans le chapitre <a href="cr%C3%A9er.html#cr%C3%A9er">Créer</a>).</p>
<p>La fonction <code>mvrnorm()</code> pour <em>MultiVariate Random NORMmal</em> nécessite trois arguments :</p>
<ul>
<li><p>la taille d’échantillon <code>n</code>;</p></li>
<li><p>les moyennes <code>mu</code> des <span class="math inline">\(p\)</span> variables, et;</p></li>
<li><p>la matrice de covariance <code>Sigma</code> (la corrélation est un cas particulier de la covariance où les variables sont standardisées).</p></li>
</ul>
<p>Le lecteur avisé aura noté la ressemblance de nomenclature entre <code>mvrnorm()</code> (multivariée) et
<code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> (univariée). Enfin, la dernière étape est de produire une matrice de covariance <span class="math inline">\(p \times p\)</span>. La fonction <code><a href="https://rdrr.io/r/base/matrix.html">matrix()</a></code> prend une variable de données, dans cet exemple , <code>c(1, r, r, 1)</code> qu’elle répartit ligne par colonne (voir <a href="programmer.html#cr%C3%A9er-une-matrice">Créer une matrice</a>. Comme <span class="math inline">\(p=2\)</span>, cela crée une matrice <span class="math inline">\(2 \times 2\)</span>.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="analyser.html#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la reproductibilité</span></span>
<span id="cb144-2"><a href="analyser.html#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">820</span>)</span>
<span id="cb144-3"><a href="analyser.html#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="analyser.html#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Taille d'échantillon importante pour réduire l'erreur d'échantillonnage</span></span>
<span id="cb144-5"><a href="analyser.html#cb144-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb144-6"><a href="analyser.html#cb144-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-7"><a href="analyser.html#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="co"># La corrélation désirée</span></span>
<span id="cb144-8"><a href="analyser.html#cb144-8" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> .<span class="dv">70</span></span>
<span id="cb144-9"><a href="analyser.html#cb144-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-10"><a href="analyser.html#cb144-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'une matrice de corrélation</span></span>
<span id="cb144-11"><a href="analyser.html#cb144-11" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, r, r, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb144-12"><a href="analyser.html#cb144-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-13"><a href="analyser.html#cb144-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Création des données </span></span>
<span id="cb144-14"><a href="analyser.html#cb144-14" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> n, </span>
<span id="cb144-15"><a href="analyser.html#cb144-15" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), </span>
<span id="cb144-16"><a href="analyser.html#cb144-16" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">Sigma =</span> R))</span>
<span id="cb144-17"><a href="analyser.html#cb144-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(donnees) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>) <span class="co"># Ajouter des noms de colonnes</span></span>
<span id="cb144-18"><a href="analyser.html#cb144-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-19"><a href="analyser.html#cb144-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Voici la matrice de corrélation</span></span>
<span id="cb144-20"><a href="analyser.html#cb144-20" aria-hidden="true" tabindex="-1"></a>R</span>
<span id="cb144-21"><a href="analyser.html#cb144-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      [,<span class="dv">1</span>] [,<span class="dv">2</span>]</span>
<span id="cb144-22"><a href="analyser.html#cb144-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>,]  <span class="fl">1.0</span>  <span class="fl">0.7</span></span>
<span id="cb144-23"><a href="analyser.html#cb144-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">2</span>,]  <span class="fl">0.7</span>  <span class="fl">1.0</span></span>
<span id="cb144-24"><a href="analyser.html#cb144-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-25"><a href="analyser.html#cb144-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Voici une visualisation partielle des données</span></span>
<span id="cb144-26"><a href="analyser.html#cb144-26" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(donnees)</span>
<span id="cb144-27"><a href="analyser.html#cb144-27" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>        x      y</span>
<span id="cb144-28"><a href="analyser.html#cb144-28" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">1</span>  <span class="fl">0.635</span>  <span class="fl">0.914</span></span>
<span id="cb144-29"><a href="analyser.html#cb144-29" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">-</span><span class="fl">0.193</span>  <span class="fl">0.360</span></span>
<span id="cb144-30"><a href="analyser.html#cb144-30" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">3</span> <span class="sc">-</span><span class="fl">0.602</span> <span class="sc">-</span><span class="fl">1.213</span></span>
<span id="cb144-31"><a href="analyser.html#cb144-31" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">4</span> <span class="sc">-</span><span class="fl">0.841</span> <span class="sc">-</span><span class="fl">0.986</span></span>
<span id="cb144-32"><a href="analyser.html#cb144-32" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">5</span> <span class="sc">-</span><span class="fl">0.105</span> <span class="sc">-</span><span class="fl">1.771</span></span>
<span id="cb144-33"><a href="analyser.html#cb144-33" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">6</span> <span class="sc">-</span><span class="fl">2.147</span> <span class="sc">-</span><span class="fl">1.590</span></span>
<span id="cb144-34"><a href="analyser.html#cb144-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-35"><a href="analyser.html#cb144-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifications des variables</span></span>
<span id="cb144-36"><a href="analyser.html#cb144-36" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(donnees<span class="sc">$</span>x); <span class="fu">mean</span>(donnees<span class="sc">$</span>y); <span class="fu">sd</span>(donnees<span class="sc">$</span>x); <span class="fu">sd</span>(donnees<span class="sc">$</span>y)</span>
<span id="cb144-37"><a href="analyser.html#cb144-37" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="sc">-</span><span class="fl">0.00578</span></span>
<span id="cb144-38"><a href="analyser.html#cb144-38" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="sc">-</span><span class="fl">0.00531</span></span>
<span id="cb144-39"><a href="analyser.html#cb144-39" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.999</span></span>
<span id="cb144-40"><a href="analyser.html#cb144-40" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">1.01</span></span>
<span id="cb144-41"><a href="analyser.html#cb144-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-42"><a href="analyser.html#cb144-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Les résultats sont près des attentes</span></span>
<span id="cb144-43"><a href="analyser.html#cb144-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifications de la corrélations</span></span>
<span id="cb144-44"><a href="analyser.html#cb144-44" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(donnees<span class="sc">$</span>x, donnees<span class="sc">$</span>y)</span>
<span id="cb144-45"><a href="analyser.html#cb144-45" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.699</span></span>
<span id="cb144-46"><a href="analyser.html#cb144-46" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation1</span>(donnees<span class="sc">$</span>x, donnees<span class="sc">$</span>y)</span>
<span id="cb144-47"><a href="analyser.html#cb144-47" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.699</span></span>
<span id="cb144-48"><a href="analyser.html#cb144-48" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation2</span>(donnees<span class="sc">$</span>x, donnees<span class="sc">$</span>y)</span>
<span id="cb144-49"><a href="analyser.html#cb144-49" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.699</span></span>
<span id="cb144-50"><a href="analyser.html#cb144-50" aria-hidden="true" tabindex="-1"></a><span class="fu">correlation3</span>(donnees<span class="sc">$</span>x, donnees<span class="sc">$</span>y)</span>
<span id="cb144-51"><a href="analyser.html#cb144-51" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.699</span></span></code></pre></div>
<p>Les résultats sont près des attentes et identiques.</p>
<p>Pour tester la probabilité d’obtenir cette valeur, la corrélation <span class="math inline">\(r\)</span> peut se transformer monotonement en valeur-<span class="math inline">\(t\)</span> avec l’équation <a href="analyser.html#eq:r2t">(11.5)</a>, ce qui permet de calculer des valeurs-<span class="math inline">\(p\)</span>.</p>
<p><span class="math display" id="eq:r2t">\[\begin{equation}
t_{n-2} = \frac{r}{(\frac{\sqrt{1-r^2}}{\sqrt{n-2}})}
\tag{11.5}
\end{equation}\]</span></p>
<p>L’équation <a href="analyser.html#eq:r2t">(11.5)</a> se traduit simplement en code <strong>R</strong>.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="analyser.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d'une matrice de corrélation </span></span>
<span id="cb145-2"><a href="analyser.html#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Il pourrait également s'agir d'un vecteur ou d'un scalaire.</span></span>
<span id="cb145-3"><a href="analyser.html#cb145-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">1</span>, .<span class="dv">5</span>, .<span class="dv">4</span>,</span>
<span id="cb145-4"><a href="analyser.html#cb145-4" aria-hidden="true" tabindex="-1"></a>               .<span class="dv">5</span>,  <span class="dv">1</span>, .<span class="dv">3</span>,</span>
<span id="cb145-5"><a href="analyser.html#cb145-5" aria-hidden="true" tabindex="-1"></a>               .<span class="dv">4</span>, .<span class="dv">3</span>,  <span class="dv">1</span>), </span>
<span id="cb145-6"><a href="analyser.html#cb145-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb145-7"><a href="analyser.html#cb145-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-8"><a href="analyser.html#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre d'unités (valeur arbitraire ici)</span></span>
<span id="cb145-9"><a href="analyser.html#cb145-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb145-10"><a href="analyser.html#cb145-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-11"><a href="analyser.html#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Valeurs-t</span></span>
<span id="cb145-12"><a href="analyser.html#cb145-12" aria-hidden="true" tabindex="-1"></a>vt <span class="ot">&lt;-</span> r <span class="sc">*</span> <span class="fu">sqrt</span>(n <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> r <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb145-13"><a href="analyser.html#cb145-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-14"><a href="analyser.html#cb145-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Valeurs-p</span></span>
<span id="cb145-15"><a href="analyser.html#cb145-15" aria-hidden="true" tabindex="-1"></a>vp <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(vt), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>)) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb145-16"><a href="analyser.html#cb145-16" aria-hidden="true" tabindex="-1"></a>vt ; vp</span>
<span id="cb145-17"><a href="analyser.html#cb145-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      [,<span class="dv">1</span>]  [,<span class="dv">2</span>]  [,<span class="dv">3</span>]</span>
<span id="cb145-18"><a href="analyser.html#cb145-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>,]  <span class="cn">Inf</span> <span class="fl">1.633</span> <span class="fl">1.234</span></span>
<span id="cb145-19"><a href="analyser.html#cb145-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">2</span>,] <span class="fl">1.63</span>   <span class="cn">Inf</span> <span class="fl">0.889</span></span>
<span id="cb145-20"><a href="analyser.html#cb145-20" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">3</span>,] <span class="fl">1.23</span> <span class="fl">0.889</span>   <span class="cn">Inf</span></span>
<span id="cb145-21"><a href="analyser.html#cb145-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>       [,<span class="dv">1</span>]  [,<span class="dv">2</span>]  [,<span class="dv">3</span>]</span>
<span id="cb145-22"><a href="analyser.html#cb145-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>,] <span class="fl">0.000</span> <span class="fl">0.141</span> <span class="fl">0.252</span></span>
<span id="cb145-23"><a href="analyser.html#cb145-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">2</span>,] <span class="fl">0.141</span> <span class="fl">0.000</span> <span class="fl">0.400</span></span>
<span id="cb145-24"><a href="analyser.html#cb145-24" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">3</span>,] <span class="fl">0.252</span> <span class="fl">0.400</span> <span class="fl">0.000</span></span></code></pre></div>
<p>Dans le code ci-dessous, l’équation <a href="analyser.html#eq:r2t">(11.5)</a> précédente est subtilement réarrangée pour être plus simple et élégante quoiqu’équivalente.</p>
<p><span class="math display" id="eq:r2t2">\[\begin{equation}
t_{n-2} = \frac{r}{(\frac{\sqrt{1-r^2}}{\sqrt{n-2}})} = \frac{r\sqrt{n-2}}{\sqrt{1-r^2}}
\tag{11.6}
\end{equation}\]</span></p>
<p>L’équation <a href="analyser.html#eq:r2t">(11.5)</a> a l’avantage de montrer la relation entre l’estimateur et l’erreur type alors que l’équation <a href="analyser.html#eq:r2t2">(11.6)</a> est moins encombrante.</p>
</div>
<div id="rapporter-une-corrélation" class="section level3" number="11.2.3">
<h3>
<span class="header-section-number">11.2.3</span> Rapporter une corrélation<a class="anchor" aria-label="anchor" href="#rapporter-une-corr%C3%A9lation"><i class="fas fa-link"></i></a>
</h3>
<p>Voici comment rapporter la corrélation dans un article. Plusieurs options sont possibles. Pour une seule corrélation, <strong>R</strong> permet d’obtenir la corrélation et la valeur-<span class="math inline">\(p\)</span> avec la fonction <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code>. Il est possible de rédiger la syntaxe ainsi.</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">$</span><span class="va">x</span>, <span class="va">donnees</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p>ou encore comme ceci.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="analyser.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(<span class="sc">~</span> y <span class="sc">+</span> x, <span class="at">data =</span> donnees)</span>
<span id="cb147-2"><a href="analyser.html#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb147-3"><a href="analyser.html#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Pearson<span class="st">'s product-moment correlation</span></span>
<span id="cb147-4"><a href="analyser.html#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; </span></span>
<span id="cb147-5"><a href="analyser.html#cb147-5" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; data:  y and x</span></span>
<span id="cb147-6"><a href="analyser.html#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; t = 98, df = 9998, p-value &lt;2e-16</span></span>
<span id="cb147-7"><a href="analyser.html#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb147-8"><a href="analyser.html#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; 95 percent confidence interval:</span></span>
<span id="cb147-9"><a href="analyser.html#cb147-9" aria-hidden="true" tabindex="-1"></a><span class="st">&gt;  0.689 0.709</span></span>
<span id="cb147-10"><a href="analyser.html#cb147-10" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; sample estimates:</span></span>
<span id="cb147-11"><a href="analyser.html#cb147-11" aria-hidden="true" tabindex="-1"></a><span class="st">&gt;   cor </span></span>
<span id="cb147-12"><a href="analyser.html#cb147-12" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; 0.699</span></span></code></pre></div>
<p>En général, la matrice corrélation complète est intéressante à rapporter. Cela se fait rapidement et simplement avec la fonction <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code>. Toutefois, elle ne rapporte pas les valeurs-<span class="math inline">\(p\)</span> et n’est pas agrémentée d’étoiles scintillantes. Plusieurs packages et fonctions sont envisageables, mais <code>psych</code> avec sa fonction <code>corr.test</code> est l’une des plus pertinentes. Voici un exemple avec le jeu de données <code>mtcars</code> (disponible dans <strong>R</strong> de base).</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="analyser.html#cb148-1" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">corr.test</span>(mtcars)</span>
<span id="cb148-2"><a href="analyser.html#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Call<span class="sc">:</span>psych<span class="sc">::</span><span class="fu">corr.test</span>(<span class="at">x =</span> mtcars)</span>
<span id="cb148-3"><a href="analyser.html#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Correlation matrix </span>
<span id="cb148-4"><a href="analyser.html#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>        mpg   cyl  disp    hp  drat    wt  qsec    vs    am</span>
<span id="cb148-5"><a href="analyser.html#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mpg   <span class="fl">1.00</span> <span class="sc">-</span><span class="fl">0.85</span> <span class="sc">-</span><span class="fl">0.85</span> <span class="sc">-</span><span class="fl">0.78</span>  <span class="fl">0.68</span> <span class="sc">-</span><span class="fl">0.87</span>  <span class="fl">0.42</span>  <span class="fl">0.66</span>  <span class="fl">0.60</span></span>
<span id="cb148-6"><a href="analyser.html#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> cyl  <span class="sc">-</span><span class="fl">0.85</span>  <span class="fl">1.00</span>  <span class="fl">0.90</span>  <span class="fl">0.83</span> <span class="sc">-</span><span class="fl">0.70</span>  <span class="fl">0.78</span> <span class="sc">-</span><span class="fl">0.59</span> <span class="sc">-</span><span class="fl">0.81</span> <span class="sc">-</span><span class="fl">0.52</span></span>
<span id="cb148-7"><a href="analyser.html#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> disp <span class="sc">-</span><span class="fl">0.85</span>  <span class="fl">0.90</span>  <span class="fl">1.00</span>  <span class="fl">0.79</span> <span class="sc">-</span><span class="fl">0.71</span>  <span class="fl">0.89</span> <span class="sc">-</span><span class="fl">0.43</span> <span class="sc">-</span><span class="fl">0.71</span> <span class="sc">-</span><span class="fl">0.59</span></span>
<span id="cb148-8"><a href="analyser.html#cb148-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> hp   <span class="sc">-</span><span class="fl">0.78</span>  <span class="fl">0.83</span>  <span class="fl">0.79</span>  <span class="fl">1.00</span> <span class="sc">-</span><span class="fl">0.45</span>  <span class="fl">0.66</span> <span class="sc">-</span><span class="fl">0.71</span> <span class="sc">-</span><span class="fl">0.72</span> <span class="sc">-</span><span class="fl">0.24</span></span>
<span id="cb148-9"><a href="analyser.html#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> drat  <span class="fl">0.68</span> <span class="sc">-</span><span class="fl">0.70</span> <span class="sc">-</span><span class="fl">0.71</span> <span class="sc">-</span><span class="fl">0.45</span>  <span class="fl">1.00</span> <span class="sc">-</span><span class="fl">0.71</span>  <span class="fl">0.09</span>  <span class="fl">0.44</span>  <span class="fl">0.71</span></span>
<span id="cb148-10"><a href="analyser.html#cb148-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> wt   <span class="sc">-</span><span class="fl">0.87</span>  <span class="fl">0.78</span>  <span class="fl">0.89</span>  <span class="fl">0.66</span> <span class="sc">-</span><span class="fl">0.71</span>  <span class="fl">1.00</span> <span class="sc">-</span><span class="fl">0.17</span> <span class="sc">-</span><span class="fl">0.55</span> <span class="sc">-</span><span class="fl">0.69</span></span>
<span id="cb148-11"><a href="analyser.html#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> qsec  <span class="fl">0.42</span> <span class="sc">-</span><span class="fl">0.59</span> <span class="sc">-</span><span class="fl">0.43</span> <span class="sc">-</span><span class="fl">0.71</span>  <span class="fl">0.09</span> <span class="sc">-</span><span class="fl">0.17</span>  <span class="fl">1.00</span>  <span class="fl">0.74</span> <span class="sc">-</span><span class="fl">0.23</span></span>
<span id="cb148-12"><a href="analyser.html#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> vs    <span class="fl">0.66</span> <span class="sc">-</span><span class="fl">0.81</span> <span class="sc">-</span><span class="fl">0.71</span> <span class="sc">-</span><span class="fl">0.72</span>  <span class="fl">0.44</span> <span class="sc">-</span><span class="fl">0.55</span>  <span class="fl">0.74</span>  <span class="fl">1.00</span>  <span class="fl">0.17</span></span>
<span id="cb148-13"><a href="analyser.html#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> am    <span class="fl">0.60</span> <span class="sc">-</span><span class="fl">0.52</span> <span class="sc">-</span><span class="fl">0.59</span> <span class="sc">-</span><span class="fl">0.24</span>  <span class="fl">0.71</span> <span class="sc">-</span><span class="fl">0.69</span> <span class="sc">-</span><span class="fl">0.23</span>  <span class="fl">0.17</span>  <span class="fl">1.00</span></span>
<span id="cb148-14"><a href="analyser.html#cb148-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> gear  <span class="fl">0.48</span> <span class="sc">-</span><span class="fl">0.49</span> <span class="sc">-</span><span class="fl">0.56</span> <span class="sc">-</span><span class="fl">0.13</span>  <span class="fl">0.70</span> <span class="sc">-</span><span class="fl">0.58</span> <span class="sc">-</span><span class="fl">0.21</span>  <span class="fl">0.21</span>  <span class="fl">0.79</span></span>
<span id="cb148-15"><a href="analyser.html#cb148-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> carb <span class="sc">-</span><span class="fl">0.55</span>  <span class="fl">0.53</span>  <span class="fl">0.39</span>  <span class="fl">0.75</span> <span class="sc">-</span><span class="fl">0.09</span>  <span class="fl">0.43</span> <span class="sc">-</span><span class="fl">0.66</span> <span class="sc">-</span><span class="fl">0.57</span>  <span class="fl">0.06</span></span>
<span id="cb148-16"><a href="analyser.html#cb148-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>       gear  carb</span>
<span id="cb148-17"><a href="analyser.html#cb148-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mpg   <span class="fl">0.48</span> <span class="sc">-</span><span class="fl">0.55</span></span>
<span id="cb148-18"><a href="analyser.html#cb148-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> cyl  <span class="sc">-</span><span class="fl">0.49</span>  <span class="fl">0.53</span></span>
<span id="cb148-19"><a href="analyser.html#cb148-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> disp <span class="sc">-</span><span class="fl">0.56</span>  <span class="fl">0.39</span></span>
<span id="cb148-20"><a href="analyser.html#cb148-20" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> hp   <span class="sc">-</span><span class="fl">0.13</span>  <span class="fl">0.75</span></span>
<span id="cb148-21"><a href="analyser.html#cb148-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> drat  <span class="fl">0.70</span> <span class="sc">-</span><span class="fl">0.09</span></span>
<span id="cb148-22"><a href="analyser.html#cb148-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> wt   <span class="sc">-</span><span class="fl">0.58</span>  <span class="fl">0.43</span></span>
<span id="cb148-23"><a href="analyser.html#cb148-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> qsec <span class="sc">-</span><span class="fl">0.21</span> <span class="sc">-</span><span class="fl">0.66</span></span>
<span id="cb148-24"><a href="analyser.html#cb148-24" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> vs    <span class="fl">0.21</span> <span class="sc">-</span><span class="fl">0.57</span></span>
<span id="cb148-25"><a href="analyser.html#cb148-25" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> am    <span class="fl">0.79</span>  <span class="fl">0.06</span></span>
<span id="cb148-26"><a href="analyser.html#cb148-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> gear  <span class="fl">1.00</span>  <span class="fl">0.27</span></span>
<span id="cb148-27"><a href="analyser.html#cb148-27" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> carb  <span class="fl">0.27</span>  <span class="fl">1.00</span></span>
<span id="cb148-28"><a href="analyser.html#cb148-28" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Sample Size </span>
<span id="cb148-29"><a href="analyser.html#cb148-29" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="dv">32</span></span>
<span id="cb148-30"><a href="analyser.html#cb148-30" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Probability <span class="fu">values</span> (Entries above the diagonal are adjusted <span class="cf">for</span> multiple tests.) </span>
<span id="cb148-31"><a href="analyser.html#cb148-31" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>       mpg cyl disp   hp drat   wt qsec   vs   am gear carb</span>
<span id="cb148-32"><a href="analyser.html#cb148-32" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> mpg  <span class="fl">0.00</span>   <span class="dv">0</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.22</span> <span class="fl">0.00</span> <span class="fl">0.01</span> <span class="fl">0.10</span> <span class="fl">0.02</span></span>
<span id="cb148-33"><a href="analyser.html#cb148-33" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> cyl  <span class="fl">0.00</span>   <span class="dv">0</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.01</span> <span class="fl">0.00</span> <span class="fl">0.04</span> <span class="fl">0.08</span> <span class="fl">0.04</span></span>
<span id="cb148-34"><a href="analyser.html#cb148-34" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> disp <span class="fl">0.00</span>   <span class="dv">0</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.20</span> <span class="fl">0.00</span> <span class="fl">0.01</span> <span class="fl">0.02</span> <span class="fl">0.30</span></span>
<span id="cb148-35"><a href="analyser.html#cb148-35" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> hp   <span class="fl">0.00</span>   <span class="dv">0</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.17</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">1.00</span> <span class="fl">1.00</span> <span class="fl">0.00</span></span>
<span id="cb148-36"><a href="analyser.html#cb148-36" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> drat <span class="fl">0.00</span>   <span class="dv">0</span> <span class="fl">0.00</span> <span class="fl">0.01</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">1.00</span> <span class="fl">0.19</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">1.00</span></span>
<span id="cb148-37"><a href="analyser.html#cb148-37" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> wt   <span class="fl">0.00</span>   <span class="dv">0</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">1.00</span> <span class="fl">0.02</span> <span class="fl">0.00</span> <span class="fl">0.01</span> <span class="fl">0.20</span></span>
<span id="cb148-38"><a href="analyser.html#cb148-38" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> qsec <span class="fl">0.02</span>   <span class="dv">0</span> <span class="fl">0.01</span> <span class="fl">0.00</span> <span class="fl">0.62</span> <span class="fl">0.34</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">1.00</span> <span class="fl">1.00</span> <span class="fl">0.00</span></span>
<span id="cb148-39"><a href="analyser.html#cb148-39" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> vs   <span class="fl">0.00</span>   <span class="dv">0</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.01</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">1.00</span> <span class="fl">1.00</span> <span class="fl">0.02</span></span>
<span id="cb148-40"><a href="analyser.html#cb148-40" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> am   <span class="fl">0.00</span>   <span class="dv">0</span> <span class="fl">0.00</span> <span class="fl">0.18</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.21</span> <span class="fl">0.36</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">1.00</span></span>
<span id="cb148-41"><a href="analyser.html#cb148-41" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> gear <span class="fl">0.01</span>   <span class="dv">0</span> <span class="fl">0.00</span> <span class="fl">0.49</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.24</span> <span class="fl">0.26</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">1.00</span></span>
<span id="cb148-42"><a href="analyser.html#cb148-42" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> carb <span class="fl">0.00</span>   <span class="dv">0</span> <span class="fl">0.03</span> <span class="fl">0.00</span> <span class="fl">0.62</span> <span class="fl">0.01</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.75</span> <span class="fl">0.13</span> <span class="fl">0.00</span></span>
<span id="cb148-43"><a href="analyser.html#cb148-43" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb148-44"><a href="analyser.html#cb148-44" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>  To see confidence intervals of the correlations, print with the short<span class="ot">=</span><span class="cn">FALSE</span> option</span></code></pre></div>
<p>La syntaxe retourne les corrélations, la taille d’échantillon et les valeurs-<span class="math inline">\(p\)</span>. La sortie contient encore plus d’informations, mais elle n’imprime que les usuelles. Il ne reste qu’à rédiger les corrélations les plus pertinents à rapporter (selon la théorie du domaine concerné).</p>
<blockquote>
<p>La matrice de corrélation des variables présentés. Parmi les corrélations d’intérêt, un lien remarquable est celui entre <code>qsec</code> et <code>mpg</code> qui est significatif, <span class="math inline">\(r(10) = 0.42, p\ =\ = 0.42\)</span>.</p>
</blockquote>
</div>
</div>
<div id="les-données-nominales" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Les données nominales<a class="anchor" aria-label="anchor" href="#les-donn%C3%A9es-nominales"><i class="fas fa-link"></i></a>
</h2>
<p>Jusqu’à présent, deux types d’association de données ont été présenté : une variable nominale (identifiant des groupes) avec une variable continue (différences de moyenne) et deux variables continues (association linéaire). Dans cette section, l’association entre deux variables nominales est présentée. Une façon de représenter l’association entre deux variables nominales est le tableau de contingence, soit l’illustration d’une distribution d’une variable (en ligne) pour chaque catégorie de l’autre (en colonne). En voici, un exemple.</p>
<div class="inline-table"><table class=" lightable-classic table" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;'>
<caption>
<span id="tab:TCCV">Table 11.1: </span>Tableau de contingence de la relation entre posséder une voiture et le climatoscepticisme
</caption>
<thead>
<tr>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Climatosceptique
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Voiture
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
non
</th>
<th style="text-align:center;">
oui
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
non
</td>
<td style="text-align:center;">
87
</td>
<td style="text-align:center;">
104
</td>
</tr>
<tr>
<td style="text-align:left;">
oui
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
52
</td>
</tr>
</tbody>
</table></div>
<p>Le tableau <a href="analyser.html#tab:TCCV">11.1</a> présente deux variables nominales (<code>climatosceptique</code>, à la verticale, et posséder une <code>voiture</code>, à l’horizontale) ayant chacune deux catégories (<code>oui</code> et <code>non</code>). Il montre les proportions <strong>observées</strong>. Ces variables sont-elles associées? Pour traiter cette question, les proportions attendues jouent un rôle crucial. En fait, l’hypothèse nulle sous la table de contingence postule que toutes les proportions du tableau de contingence sont indépendantes. Mathématiquement, il s’agit de postuler que les proportions d’une variable (en ligne ou en colonne) n’influencent pas celles de l’autre variable. Pour obtenir les proportions <strong>théoriques</strong>, les totaux des lignes et colonnes sont calculés ainsi que le grand total. La fréquence attendue d’une cellule est obtenue en calculant, pour chaque cellule, le produit de sa colonne et de sa ligne respective divisé par le grand total.</p>
<p><span class="math display" id="eq:chi1">\[\begin{equation}
t_{ij} = \frac{\text{total}_i \times \text{total}_j}{\sum \text{total}}
\tag{11.7}
\end{equation}\]</span></p>
<p>L’équation <a href="analyser.html#eq:chi1">(11.7)</a> ci-dessus illustre l’idée sous-jacente à la proportion attendue, <span class="math inline">\(t\)</span> d’une cellule de ligne, <span class="math inline">\(i\)</span>, et colonne <span class="math inline">\(j\)</span>.</p>
<div class="inline-table"><table class=" lightable-classic table" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;'>
<caption>
<span id="tab:TCCV2">Table 11.2: </span>Tableau de contingence étendu avec les totaux
</caption>
<thead>
<tr>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Climatosceptique
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Voiture
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Total
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
non
</th>
<th style="text-align:center;">
oui
</th>
<th style="text-align:center;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
non
</td>
<td style="text-align:center;">
87
</td>
<td style="text-align:center;">
104
</td>
<td style="text-align:center;">
191
</td>
</tr>
<tr>
<td style="text-align:left;">
oui
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
52
</td>
<td style="text-align:center;">
59
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:center;">
94
</td>
<td style="text-align:center;">
156
</td>
<td style="text-align:center;">
250
</td>
</tr>
</tbody>
</table></div>
<div id="le-chi2-pour-table-de-contingence" class="section level3" number="11.3.1">
<h3>
<span class="header-section-number">11.3.1</span> Le <span class="math inline">\(\chi^2\)</span> pour table de contingence<a class="anchor" aria-label="anchor" href="#le-chi2-pour-table-de-contingence"><i class="fas fa-link"></i></a>
</h3>
<p>Maintenant que la question statistique et que l’hypothèse nulle sont posées, comment mesurer le degré selon lequel les données s’écartent des attentes <em>théoriques</em>. Le <span class="math inline">\(\chi^2\)</span> (khi-carré) permet de calculer une telle mesure. Le <span class="math inline">\(\chi^2\)</span> correspond à la distance entre une valeur observée et théorique au carré, pondérée par la valeur théorique.
<span class="math display">\[ \chi^2_v = \sum_{i=1}^{l}\sum_{j=1}^c(\frac{(o_{ij}-t_{ij})^2}{t_{ij}})\]</span>
où <span class="math inline">\(o\)</span> correspond aux valeurs observées, <span class="math inline">\(t\)</span> réfère aux valeurs théoriques, <span class="math inline">\(v\)</span> représente les degrés de liberté et <span class="math inline">\(i\)</span> et <span class="math inline">\(j\)</span> les lignes et colonnes respectivement. Le degré de liberté est
<span class="math display">\[v = (n_{\text{ligne}}-1)(n_{\text{colonne}}-1)\]</span></p>
<p>Si l’hypothèse nulle est vraie, les valeurs observées et théoriques devraient être très près. Le carré permet de calculer une distance euclidienne et le dénominateur pondère la distance. Comme l’<a href="comparer.html#comparer">analyse de variance</a>, le test de <span class="math inline">\(\chi^2\)</span> pour table de contingence est global, il n’informe pas d’où provient la dépendance, mais bien s’il y a au moins une dépendance.</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">khicarre</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">obs</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># Obs est une table de contingence</span></span>
<span>  <span class="co"># Somme colonne</span></span>
<span>  <span class="va">SC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Somme ligne</span></span>
<span>  <span class="va">SL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Grand total</span></span>
<span>  <span class="va">TT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span></span>
<span>  <span class="co"># Proportion théoriques</span></span>
<span>  <span class="va">theo</span> <span class="op">&lt;-</span> <span class="va">SL</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">SC</span><span class="op">)</span> <span class="op">/</span> <span class="va">TT</span></span>
<span>  <span class="co"># khi carré</span></span>
<span>  <span class="va">khi2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">obs</span> <span class="op">-</span> <span class="va">theo</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">/</span> <span class="va">theo</span><span class="op">)</span></span>
<span>  <span class="va">dl</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">SL</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">SC</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">vp</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="va">khi2</span>, <span class="va">dl</span><span class="op">)</span></span>
<span>  <span class="co"># Sortie</span></span>
<span>  <span class="va">statistiques</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>khi2 <span class="op">=</span> <span class="va">khi2</span>, dl <span class="op">=</span> <span class="va">dl</span>, valeur.p <span class="op">=</span> <span class="va">vp</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">statistiques</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Il y a plusieurs techniques pour créer une base de données, l’essentiel étant de lier les proportions désirées. Ici, une variable sexe est créée avec 50-50% de chance d’être l’un ou l’autre sexe. Par la suite, une proportion différente liée au sexe est utilisée pour générer la fréquence de consommation de tabac. La syntaxe sert principalement à identifier les valeurs <code>homme</code> et <code>femme</code> de la première variable pour en associer une valeur <code>tabac</code>.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="analyser.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54</span>)</span>
<span id="cb150-2"><a href="analyser.html#cb150-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb150-3"><a href="analyser.html#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="analyser.html#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Première variable</span></span>
<span id="cb150-5"><a href="analyser.html#cb150-5" aria-hidden="true" tabindex="-1"></a>sexe <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"homme"</span>,<span class="st">"femme"</span>), </span>
<span id="cb150-6"><a href="analyser.html#cb150-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> n, </span>
<span id="cb150-7"><a href="analyser.html#cb150-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb150-8"><a href="analyser.html#cb150-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">5</span>,.<span class="dv">5</span>))</span>
<span id="cb150-9"><a href="analyser.html#cb150-9" aria-hidden="true" tabindex="-1"></a>tabac <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb150-10"><a href="analyser.html#cb150-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-11"><a href="analyser.html#cb150-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions conditionnelles</span></span>
<span id="cb150-12"><a href="analyser.html#cb150-12" aria-hidden="true" tabindex="-1"></a>tabac[sexe <span class="sc">==</span> <span class="st">"femme"</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"fumeur"</span>,<span class="st">"non-fumeur"</span>), </span>
<span id="cb150-13"><a href="analyser.html#cb150-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="fu">sum</span>(sexe <span class="sc">==</span> <span class="st">"femme"</span>), </span>
<span id="cb150-14"><a href="analyser.html#cb150-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb150-15"><a href="analyser.html#cb150-15" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">8</span>))</span>
<span id="cb150-16"><a href="analyser.html#cb150-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-17"><a href="analyser.html#cb150-17" aria-hidden="true" tabindex="-1"></a>tabac[sexe <span class="sc">==</span> <span class="st">"homme"</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"fumeur"</span>,<span class="st">"non-fumeur"</span>), </span>
<span id="cb150-18"><a href="analyser.html#cb150-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size =</span> <span class="fu">sum</span>(sexe <span class="sc">==</span> <span class="st">"homme"</span>), </span>
<span id="cb150-19"><a href="analyser.html#cb150-19" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb150-20"><a href="analyser.html#cb150-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">9</span>))</span>
<span id="cb150-21"><a href="analyser.html#cb150-21" aria-hidden="true" tabindex="-1"></a><span class="co">#base données</span></span>
<span id="cb150-22"><a href="analyser.html#cb150-22" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(sexe, tabac)</span>
<span id="cb150-23"><a href="analyser.html#cb150-23" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(donnees)</span>
<span id="cb150-24"><a href="analyser.html#cb150-24" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>        tabac</span>
<span id="cb150-25"><a href="analyser.html#cb150-25" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> sexe    fumeur non<span class="sc">-</span>fumeur</span>
<span id="cb150-26"><a href="analyser.html#cb150-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>   femme      <span class="dv">8</span>         <span class="dv">38</span></span>
<span id="cb150-27"><a href="analyser.html#cb150-27" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>   homme      <span class="dv">4</span>         <span class="dv">50</span></span></code></pre></div>
<p>La fonction <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> de <strong>R</strong> génère une table de contingence. La fonction maison et deux méthodes de base <strong>R</strong> sont présentées et produisent les mêmes résultats pour le <span class="math inline">\(\chi^2\)</span>. Un autre, le test exact de Fisher est également présenté. Celui-ci est plus robuste, mais peut requérir plus intensive des ressources de l’ordinateur pour les grosses tables de contingences.</p>
<p>Le test du <span class="math inline">\(\chi^2\)</span> est sujet à certains problèmes qu’il est important de considérer sans quoi l’interprétation peut être faussée. Si la taille d’échantillon (le nombre d’unités d’observation observées est trop faible), alors le test est biaisé. Par exemple, trois lancers de pile ou face ne sont pas suffisants pour tester une hypothèse de khi-carré, le nombre de résultats différents est de 2, ce qui ne donne pas une approximation satisfaisante de la distribution d’échantillonnage. La convention est de dire qu’une fréquence théorique est trop petite si elle est plus petite que 5. Si ce n’est pas cas, des corrections ou d’autres options doivent être considérées.</p>
<p>Dans le présent exemple, bien que les fréquences attendues respectent les critères usuels, il peut être utile d’envisager un test plus robuste comme le test exact de Fisher ou le <span class="math inline">\(\chi^2\)</span> avec correction de continuité. Le premier se commande avec la fonction <code><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test()</a></code> et le second est la fonction par défaut de <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code>. C’est deux fonctions prennet comme argument une table de contigence (la sortir de <code><a href="https://rdrr.io/r/base/table.html">table()</a></code>) ou deux variables nominales. Pour montrer l’équivalence entre la fonction <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code> et la fonction maison, l’option de correction est désactivée avec l’argument <code>correct = FALSE</code>.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="analyser.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Table de contingence</span></span>
<span id="cb151-2"><a href="analyser.html#cb151-2" aria-hidden="true" tabindex="-1"></a>TC <span class="ot">&lt;-</span> <span class="fu">table</span>(donnees)</span>
<span id="cb151-3"><a href="analyser.html#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction maison</span></span>
<span id="cb151-4"><a href="analyser.html#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">khicarre</span>(TC)</span>
<span id="cb151-5"><a href="analyser.html#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="er">$</span>khi2</span>
<span id="cb151-6"><a href="analyser.html#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">2.34</span></span>
<span id="cb151-7"><a href="analyser.html#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb151-8"><a href="analyser.html#cb151-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>dl</span>
<span id="cb151-9"><a href="analyser.html#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="dv">1</span></span>
<span id="cb151-10"><a href="analyser.html#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb151-11"><a href="analyser.html#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>valeur.p</span>
<span id="cb151-12"><a href="analyser.html#cb151-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.126</span></span>
<span id="cb151-13"><a href="analyser.html#cb151-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-14"><a href="analyser.html#cb151-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction de base</span></span>
<span id="cb151-15"><a href="analyser.html#cb151-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(TC)</span>
<span id="cb151-16"><a href="analyser.html#cb151-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Number of cases <span class="cf">in</span> table<span class="sc">:</span> <span class="dv">100</span> </span>
<span id="cb151-17"><a href="analyser.html#cb151-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Number of factors<span class="sc">:</span> <span class="dv">2</span> </span>
<span id="cb151-18"><a href="analyser.html#cb151-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Test <span class="cf">for</span> independence of all factors<span class="sc">:</span></span>
<span id="cb151-19"><a href="analyser.html#cb151-19" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Chisq <span class="ot">=</span> <span class="fl">2.3</span>, df <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb151-20"><a href="analyser.html#cb151-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-21"><a href="analyser.html#cb151-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Autre fonction de base</span></span>
<span id="cb151-22"><a href="analyser.html#cb151-22" aria-hidden="true" tabindex="-1"></a>resultat <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(TC, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb151-23"><a href="analyser.html#cb151-23" aria-hidden="true" tabindex="-1"></a><span class="co"># ou encore</span></span>
<span id="cb151-24"><a href="analyser.html#cb151-24" aria-hidden="true" tabindex="-1"></a>resultat <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(donnees<span class="sc">$</span>sexe, donnees<span class="sc">$</span>tabac, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb151-25"><a href="analyser.html#cb151-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Leur sortie</span></span>
<span id="cb151-26"><a href="analyser.html#cb151-26" aria-hidden="true" tabindex="-1"></a>resultat</span>
<span id="cb151-27"><a href="analyser.html#cb151-27" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb151-28"><a href="analyser.html#cb151-28" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Pearson<span class="st">'s Chi-squared test</span></span>
<span id="cb151-29"><a href="analyser.html#cb151-29" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; </span></span>
<span id="cb151-30"><a href="analyser.html#cb151-30" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; data:  donnees$sexe and donnees$tabac</span></span>
<span id="cb151-31"><a href="analyser.html#cb151-31" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; X-squared = 2, df = 1, p-value = 0.1</span></span>
<span id="cb151-32"><a href="analyser.html#cb151-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-33"><a href="analyser.html#cb151-33" aria-hidden="true" tabindex="-1"></a><span class="st"># Et pour plus de précision...</span></span>
<span id="cb151-34"><a href="analyser.html#cb151-34" aria-hidden="true" tabindex="-1"></a><span class="st">resultat$statistic</span></span>
<span id="cb151-35"><a href="analyser.html#cb151-35" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; X-squared </span></span>
<span id="cb151-36"><a href="analyser.html#cb151-36" aria-hidden="true" tabindex="-1"></a><span class="st">&gt;      2.34</span></span>
<span id="cb151-37"><a href="analyser.html#cb151-37" aria-hidden="true" tabindex="-1"></a><span class="st">resultat$p.value</span></span>
<span id="cb151-38"><a href="analyser.html#cb151-38" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; [1] 0.126</span></span>
<span id="cb151-39"><a href="analyser.html#cb151-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-40"><a href="analyser.html#cb151-40" aria-hidden="true" tabindex="-1"></a><span class="st"># Le test exact de Fisher</span></span>
<span id="cb151-41"><a href="analyser.html#cb151-41" aria-hidden="true" tabindex="-1"></a><span class="st">resultat.fisher &lt;- fisher.test(TC)</span></span>
<span id="cb151-42"><a href="analyser.html#cb151-42" aria-hidden="true" tabindex="-1"></a><span class="st"># ou encore</span></span>
<span id="cb151-43"><a href="analyser.html#cb151-43" aria-hidden="true" tabindex="-1"></a><span class="st">resultat.fisher &lt;- fisher.test(donnees$sexe, donnees$tabac)</span></span>
<span id="cb151-44"><a href="analyser.html#cb151-44" aria-hidden="true" tabindex="-1"></a><span class="st"># Leur sortie</span></span>
<span id="cb151-45"><a href="analyser.html#cb151-45" aria-hidden="true" tabindex="-1"></a><span class="st">resultat.fisher</span></span>
<span id="cb151-46"><a href="analyser.html#cb151-46" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; </span></span>
<span id="cb151-47"><a href="analyser.html#cb151-47" aria-hidden="true" tabindex="-1"></a><span class="st">&gt;   Fisher'</span>s Exact Test <span class="cf">for</span> Count Data</span>
<span id="cb151-48"><a href="analyser.html#cb151-48" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb151-49"><a href="analyser.html#cb151-49" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> data<span class="sc">:</span>  donnees<span class="sc">$</span>sexe and donnees<span class="sc">$</span>tabac</span>
<span id="cb151-50"><a href="analyser.html#cb151-50" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.2</span></span>
<span id="cb151-51"><a href="analyser.html#cb151-51" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> alternative hypothesis<span class="sc">:</span> true odds ratio is not equal to <span class="dv">1</span></span>
<span id="cb151-52"><a href="analyser.html#cb151-52" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb151-53"><a href="analyser.html#cb151-53" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   <span class="fl">0.641</span> <span class="fl">12.731</span></span>
<span id="cb151-54"><a href="analyser.html#cb151-54" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> sample estimates<span class="sc">:</span></span>
<span id="cb151-55"><a href="analyser.html#cb151-55" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> odds ratio </span>
<span id="cb151-56"><a href="analyser.html#cb151-56" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>       <span class="fl">2.61</span></span>
<span id="cb151-57"><a href="analyser.html#cb151-57" aria-hidden="true" tabindex="-1"></a>resultat.fisher<span class="sc">$</span>p.value</span>
<span id="cb151-58"><a href="analyser.html#cb151-58" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.216</span></span></code></pre></div>
</div>
<div id="rapporter-un-chi2" class="section level3" number="11.3.2">
<h3>
<span class="header-section-number">11.3.2</span> Rapporter un <span class="math inline">\(\chi^2\)</span><a class="anchor" aria-label="anchor" href="#rapporter-un-chi2"><i class="fas fa-link"></i></a>
</h3>
<p>Voici comment rapporter un test de <span class="math inline">\(\chi^2\)</span> dans un article. Comme il a été vu ci-haut, plusieurs options sont possibles</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="analyser.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour le khi carré de Pearson</span></span>
<span id="cb152-2"><a href="analyser.html#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(donnees<span class="sc">$</span>sexe, donnees<span class="sc">$</span>tabac, <span class="at">correct =</span> <span class="cn">FALSE</span>)</span>
<span id="cb152-3"><a href="analyser.html#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb152-4"><a href="analyser.html#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   Pearson<span class="st">'s Chi-squared test</span></span>
<span id="cb152-5"><a href="analyser.html#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; </span></span>
<span id="cb152-6"><a href="analyser.html#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; data:  donnees$sexe and donnees$tabac</span></span>
<span id="cb152-7"><a href="analyser.html#cb152-7" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; X-squared = 2, df = 1, p-value = 0.1</span></span>
<span id="cb152-8"><a href="analyser.html#cb152-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-9"><a href="analyser.html#cb152-9" aria-hidden="true" tabindex="-1"></a><span class="st"># Pour le test exact de Fisher</span></span>
<span id="cb152-10"><a href="analyser.html#cb152-10" aria-hidden="true" tabindex="-1"></a><span class="st">fisher.test(donnees$sexe, donnees$tabac)</span></span>
<span id="cb152-11"><a href="analyser.html#cb152-11" aria-hidden="true" tabindex="-1"></a><span class="st">&gt; </span></span>
<span id="cb152-12"><a href="analyser.html#cb152-12" aria-hidden="true" tabindex="-1"></a><span class="st">&gt;   Fisher'</span>s Exact Test <span class="cf">for</span> Count Data</span>
<span id="cb152-13"><a href="analyser.html#cb152-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb152-14"><a href="analyser.html#cb152-14" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> data<span class="sc">:</span>  donnees<span class="sc">$</span>sexe and donnees<span class="sc">$</span>tabac</span>
<span id="cb152-15"><a href="analyser.html#cb152-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.2</span></span>
<span id="cb152-16"><a href="analyser.html#cb152-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> alternative hypothesis<span class="sc">:</span> true odds ratio is not equal to <span class="dv">1</span></span>
<span id="cb152-17"><a href="analyser.html#cb152-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">95</span> percent confidence interval<span class="sc">:</span></span>
<span id="cb152-18"><a href="analyser.html#cb152-18" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   <span class="fl">0.641</span> <span class="fl">12.731</span></span>
<span id="cb152-19"><a href="analyser.html#cb152-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> sample estimates<span class="sc">:</span></span>
<span id="cb152-20"><a href="analyser.html#cb152-20" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> odds ratio </span>
<span id="cb152-21"><a href="analyser.html#cb152-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>       <span class="fl">2.61</span></span></code></pre></div>
<blockquote>
<p>La relation entre le sexe et le consommation de tabac est investiguée. Il appert que cette relation n’est pas statistiquement significative avec une seuil <span class="math inline">\(\alpha = .05\)</span>, <span class="math inline">\(chi^2(1) = 2.345\)</span>, <span class="math inline">\(p = 0.126\)</span>. Le test exact de Fisher est calculé également et, pareillement, ne rejette pas l’hypothèse nulle, <span class="math inline">\(p =0.216\)</span>.</p>
</blockquote>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="inf%C3%A9rer.html"><span class="header-section-number">10</span> Inférer</a></div>
<div class="next"><a href="simuler.html"><span class="header-section-number">12</span> Simuler</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#analyser"><span class="header-section-number">11</span> Analyser</a></li>
<li>
<a class="nav-link" href="#les-diff%C3%A9rences-de-moyennes"><span class="header-section-number">11.1</span> Les différences de moyennes</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#le-test-t-ind%C3%A9pendant"><span class="header-section-number">11.1.1</span> Le test-\(t\) indépendant</a></li>
<li><a class="nav-link" href="#rapporter-un-test-t-ind%C3%A9pendant"><span class="header-section-number">11.1.2</span> Rapporter un test-\(t\) indépendant</a></li>
<li><a class="nav-link" href="#le-test-t-d%C3%A9pendant"><span class="header-section-number">11.1.3</span> Le test-\(t\) dépendant</a></li>
<li><a class="nav-link" href="#rapporter-un-test-t-d%C3%A9pendant"><span class="header-section-number">11.1.4</span> Rapporter un test-\(t\) dépendant</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#lassociation-lin%C3%A9aire"><span class="header-section-number">11.2</span> L’association linéaire</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#la-covariance"><span class="header-section-number">11.2.1</span> La covariance</a></li>
<li><a class="nav-link" href="#la-corr%C3%A9lation"><span class="header-section-number">11.2.2</span> La corrélation</a></li>
<li><a class="nav-link" href="#rapporter-une-corr%C3%A9lation"><span class="header-section-number">11.2.3</span> Rapporter une corrélation</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#les-donn%C3%A9es-nominales"><span class="header-section-number">11.3</span> Les données nominales</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#le-chi2-pour-table-de-contingence"><span class="header-section-number">11.3.1</span> Le \(\chi^2\) pour table de contingence</a></li>
<li><a class="nav-link" href="#rapporter-un-chi2"><span class="header-section-number">11.3.2</span> Rapporter un \(\chi^2\)</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/quantmeth/MQR/blob/master/11-Analyser.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/quantmeth/MQR/edit/master/11-Analyser.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Méthodes quantitatives avec R</strong>" was written by P.-O. Caron. It was last built on 2023-08-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
