<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 9 Analyser | Méthodes Quantitatives avec R</title>
<meta name="author" content="P.-O. Caron">
<meta name="description" content="En continuation de l’introduction des théories des tests d’hypothèses (voir Inférer) et l’aperçu donnée par le test-\(t\) à échantillon unique, cette section poursuit la présentation en...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content=" 9 Analyser | Méthodes Quantitatives avec R">
<meta property="og:type" content="book">
<meta property="og:url" content="mqr.teluq.ca/analyser.html">
<meta property="og:description" content="En continuation de l’introduction des théories des tests d’hypothèses (voir Inférer) et l’aperçu donnée par le test-\(t\) à échantillon unique, cette section poursuit la présentation en...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 9 Analyser | Méthodes Quantitatives avec R">
<meta name="twitter:description" content="En continuation de l’introduction des théories des tests d’hypothèses (voir Inférer) et l’aperçu donnée par le test-\(t\) à échantillon unique, cette section poursuit la présentation en...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body>
<p>
    \(
    \newcommand{\EX}{\mathbb{E}}
    \)
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style><style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style><link rel="stylesheet" href="bs4_style.css"></p>

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Méthodes Quantitatives avec R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bienvenue!</a></li>
<li><a class="" href="pr%C3%A9face.html">Préface</a></li>
<li class="book-part">Rudiments</li>
<li><a class="" href="commencer.html"><span class="header-section-number">1</span> Commencer</a></li>
<li><a class="" href="programmer.html"><span class="header-section-number">2</span> Programmer</a></li>
<li><a class="" href="calculer.html"><span class="header-section-number">3</span> Calculer</a></li>
<li><a class="" href="exercice-rudiments.html">Exercices</a></li>
<li class="book-part">Jeux de données</li>
<li><a class="" href="importer.html"><span class="header-section-number">4</span> Importer</a></li>
<li><a class="" href="entr%C3%A9e-de-donn%C3%A9es.html"><span class="header-section-number">5</span> Entrée de données</a></li>
<li><a class="" href="manipuler.html"><span class="header-section-number">6</span> Manipuler</a></li>
<li><a class="" href="visualiser.html"><span class="header-section-number">7</span> Visualiser</a></li>
<li><a class="" href="exercice-gestion.html">Exercices</a></li>
<li class="book-part">Statistique</li>
<li><a class="" href="inf%C3%A9rer.html"><span class="header-section-number">8</span> Inférer</a></li>
<li><a class="active" href="analyser.html"><span class="header-section-number">9</span> Analyser</a></li>
<li><a class="" href="simuler.html"><span class="header-section-number">10</span> Simuler</a></li>
<li><a class="" href="exercice-analyse.html">Exercices</a></li>
<li><a class="" href="r%C3%A9f%C3%A9rences.html">Références</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/quantmeth/MQR">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="analyser" class="section level1" number="9">
<h1>
<span class="header-section-number"> 9</span> Analyser<a class="anchor" aria-label="anchor" href="#analyser"><i class="fas fa-link"></i></a>
</h1>
<p>En continuation de l’introduction des théories des tests d’hypothèses (voir <a href="inf%C3%A9rer.html#inf%C3%A9rer">Inférer</a>) et l’aperçu donnée par <a href="inf%C3%A9rer.html#le-test-t-%C3%A0-%C3%A9chantillon-unique">le test-<span class="math inline">\(t\)</span> à échantillon unique</a>, cette section poursuit la présentation en introduisant des analyses statistiques de bases comme les différences de moyennes, l’association linéaire et les tests pour données nominales. Les tests-<span class="math inline">\(t\)</span> indépendant et dépendant, l’analyse de variables, la covariance, la corrélation ainsi que le test du <span class="math inline">\(\chi2\)</span> pour table de contingence sont présentées.</p>
<div id="les-différences-de-moyennes" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Les différences de moyennes<a class="anchor" aria-label="anchor" href="#les-diff%C3%A9rences-de-moyennes"><i class="fas fa-link"></i></a>
</h2>
<div id="test-t-indépendant" class="section level3" number="9.1.1">
<h3>
<span class="header-section-number">9.1.1</span> Test-<em>t</em> indépendant<a class="anchor" aria-label="anchor" href="#test-t-ind%C3%A9pendant"><i class="fas fa-link"></i></a>
</h3>
<p>En général, l’expérimentateur ne s’intéresse pas à comparer une moyenne à une valeur arbitraire, comme c’était le cas avec <a href="inf%C3%A9rer.html#le-test-t-%C3%A0-%C3%A9chantillon-unique">le test-<span class="math inline">\(t\)</span> à échantillon unique</a>. Cela peut lui être assez trivial. Il s’intéresse plutôt à comparer une moyenne à une autre moyenne, soit une différence entre deux groupes indépendants, par exemple, quel est la différence entre un groupe traitement et un groupe contrôle?</p>
<!-- , c'est-à-dire que les participants sont différents entre les deux groupes. ou encore pré et post traitement seront pour l'expérimentateur des analyses indispensables. -->
<p>En se basant sur le test <span class="math inline">\(t\)</span> à échantillon unique, la valeur-<span class="math inline">\(t\)</span> pour deux moyennes se calcule selon l’équation <a href="analyser.html#eq:test2">(9.1)</a></p>
<p><span class="math display" id="eq:test2">\[\begin{equation}
t_{n-2} = \frac{\bar{x_1}-\bar{x_2}}{\sqrt{\frac{s^2_{1}}{n_1}+\frac{s^2_{2}}{n_2}}}
\tag{9.1}
\end{equation}\]</span></p>
<p>où l’indice de la valeur-<span class="math inline">\(t\)</span> est le nombre de degrés de liberté <span class="math inline">\(n-2\)</span>. Comme deux variances sont estimées, deux degrés de libertés sont imputés, ce qui octroi <span class="math inline">\(n-2\)</span> degrés. En plus de considéré <span class="math inline">\(\bar{x_2}\)</span> la valeur <em>arbitaire</em> de comparaison (l’ordre de <span class="math inline">\(\bar{x_2}\)</span> et <span class="math inline">\(\bar{x^1}\)</span> est arbitraire), les deux écart types sont également considérés au dénominateur.</p>
<p>Une fois le calcul réalisé, la logique du test d’hypothèse est la même, à l’exception de l’hypothèse nulle qui correspond maintenant à l’absence de différence entre les deux moyennes.</p>
<p>Voici un exemple de programmation du test-<span class="math inline">\(t\)</span> pour deux groupes indépendants.</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">testt.ind</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># x1 est une variable continue associée au groupe 1</span>
  <span class="co"># x2 est une variable continue associée au groupe 2</span>
  
  <span class="co"># Calcul des moyennes</span>
  <span class="va">x1bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> ; <span class="va">x2bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>
  
  <span class="co"># Calcul des variances</span>
  <span class="va">x1var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> ; <span class="va">x2var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>
  
  <span class="co"># Calcul des tailles d'échantillon</span>
  <span class="va">nx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> ; <span class="va">nx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>
  
  <span class="co"># Valeur-t, degrés de liberté et valeur-p</span>
  <span class="va">vt</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x1bar</span> <span class="op">-</span> <span class="va">x2bar</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">x1var</span> <span class="op">/</span> <span class="va">nx1</span> <span class="op">+</span> <span class="va">x2var</span> <span class="op">/</span> <span class="va">nx2</span><span class="op">)</span>
  <span class="va">dl</span> <span class="op">&lt;-</span> <span class="va">nx1</span> <span class="op">+</span> <span class="va">nx2</span> <span class="op">-</span> <span class="fl">2</span>
  <span class="va">vp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">vt</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">dl</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> 
  <span class="va">statistique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>valeur.t <span class="op">=</span> <span class="va">vt</span>, dl <span class="op">=</span> <span class="va">dl</span>, valeur.p <span class="op">=</span> <span class="va">vp</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">statistique</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Pour générer un exemple de données, le code ci-après crée un échantillon de 15 unités réparties en deux groupes, le premier groupe (<code>gr0</code>) est tiré d’une distribution normale ayant une moyenne de 1 et un écart type de 1, le deuxième groupe (<code>gr1</code>), une moyenne de 0 et un écart type de 1. La syntaxe illustre la création de deux variables pour créer les deux groupes. Il est aussi possible d’envisager la création sur en termes d’équation linéaire,</p>
<p><span class="math display">\[y = \mu_0 + \mu_1x_1 + \epsilon\]</span>
où <span class="math inline">\(y\)</span> est le score observé des unités et les autres variables construisent ce score, <span class="math inline">\(\mu_0\)</span> correspond à la moyenne du groupe référent de population (le groupe “contrôle” en quelque sorte.), <span class="math inline">\(\mu_1\)</span> réfère à la différence de moyenne entre les deux groupes identifiés par <span class="math inline">\(x_1\)</span> qui réfère à l’assignation au groupe, soit 0 pour le groupe “contrôle” et 1 pour le groupe “différent”. Pour ce même exemple, <span class="math inline">\(\mu_1 = -1\)</span>. Par le produit <span class="math inline">\(\mu_1x_1\)</span>, le groupe “contrôle” associé à la valeur 0 n’a pas de modification de la moyenne, <span class="math inline">\(-1*0=0\)</span> alors le groupe “différent” associé à la valeur 1, <span class="math inline">\(-1*1=-1\)</span>. Enfin, <span class="math inline">\(\epsilon\)</span> correspond à la variabilité entre les unités. Cette façon de programmer la création des variables illustre bien l’association linéaire qui existe même dans les différences de moyennes et sera très utile pour des modèles plus compliqués.</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Un exemple de jeu de données programmé de deux façons</span>
<span class="co"># Méthode 1</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2021</span><span class="op">)</span>
<span class="va">gr0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">gr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">15</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="co"># Méthode 2</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2021</span><span class="op">)</span>
<span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="co"># Appartenance au groupe (0 et 1)</span>
<span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Erreur interindividuel</span>
<span class="va">mu1</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="co"># le deuxième groupe a une différence de moyenne de -1</span>
<span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># moyenne du groupe référent</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">mu0</span> <span class="op">+</span> <span class="va">mu1</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">e</span>
<span class="co"># Présenter quelques participants; retirer les crochets pour voir tous</span>
<span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>method1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gr0</span>, <span class="va">gr1</span><span class="op">)</span>, method2 <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">10</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span>
<span class="co">#&gt;       method1 method2</span>
<span class="co">#&gt;  [1,]  2.7300  2.7300</span>
<span class="co">#&gt;  [2,] -0.0822 -0.0822</span>
<span class="co">#&gt;  [3,]  0.7272  0.7272</span>
<span class="co">#&gt;  [4,]  1.1820  1.1820</span>
<span class="co">#&gt;  [5,]  2.5085  2.5085</span>
<span class="co">#&gt;  [6,]  2.6045  2.6045</span>
<span class="co">#&gt;  [7,] -1.8415 -1.8415</span>
<span class="co">#&gt;  [8,]  1.6233  1.6233</span>
<span class="co">#&gt;  [9,]  0.1314  0.1314</span>
<span class="co">#&gt; [10,]  1.4811  1.4811</span>
<span class="co">#&gt; [11,]  1.5133  1.5133</span></code></pre></div>
<p>Les données sont identiques.</p>
<p>Une fois la fonction créée, il est possible de la tester et de la comparer avec la fonction <strong>R</strong> de base <code>test.t()</code>.</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Vérification de la fonction maison</span>
<span class="fu">testt.ind</span><span class="op">(</span><span class="va">gr0</span>, <span class="va">gr1</span><span class="op">)</span>
<span class="co">#&gt; $valeur.t</span>
<span class="co">#&gt; [1] 3.4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dl</span>
<span class="co">#&gt; [1] 28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $valeur.p</span>
<span class="co">#&gt; [1] 0.00205</span>
<span class="co"># Comparer avec la fonction R</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">gr0</span>, <span class="va">gr1</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  gr0 and gr1</span>
<span class="co">#&gt; t = 3, df = 28, p-value = 0.002</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.54 2.18</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of x mean of y </span>
<span class="co">#&gt;     1.332    -0.029</span></code></pre></div>
<p>Les équations et codes précédents ne sont adéquats que si les variances sont égales entre les deux groupes. Cette notion est quelque peu trahie par la spécification dans la fonction <strong>R</strong> de l’argument <code>var.equal = TRUE</code> qui par défaut est <code>FALSE</code>. Pour un test-<span class="math inline">\(t\)</span> indépendant suivant les règles de l’art, il faut appliquer une correction (approximation de Welsh) aux degrés de liberté. Les degrés de liberté deviennent moins élégants, le code devient ainsi.</p>
<p><span class="math display">\[
dl=\frac{\left(\frac{s^2_1}{n_1}+\frac{s^2_2}{n_2}\right)^2}{\frac{\left(\frac{s^2_1}{n_1}\right)^2}{n_1-1}+\frac{\left(\frac{s^2_2}{n_2}\right)^2}{n_2-1}}
\]</span>
En apportant cette correction au code initial.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">testt.ind2</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># x1 est une variable continue associée au groupe 1</span>
  <span class="co"># x2 est une variable continue associée au groupe 2</span>
  <span class="va">x1bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> ; <span class="va">x2bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>
  <span class="va">x1var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> ; <span class="va">x2var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>
  <span class="va">nx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span> ; <span class="va">nx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span>
  
  <span class="co"># erreur type </span>
  <span class="va">et</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">x1var</span> <span class="op">/</span> <span class="va">nx1</span> <span class="op">+</span> <span class="va">x2var</span> <span class="op">/</span> <span class="va">nx2</span><span class="op">)</span>
  <span class="co"># valeur t</span>
  <span class="va">vt</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x1bar</span> <span class="op">-</span> <span class="va">x2bar</span><span class="op">)</span> <span class="op">/</span> <span class="va">et</span>
  <span class="co"># correction des degrés de liberté</span>
  <span class="va">dl</span> <span class="op">&lt;-</span> <span class="va">et</span><span class="op">^</span><span class="fl">4</span> <span class="op">/</span> 
    <span class="op">(</span><span class="op">(</span><span class="va">x1var</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="va">nx1</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">nx1</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">x2var</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="va">nx2</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">nx2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="co"># valeur-p</span>
  <span class="va">vp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">vt</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">dl</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> 
  <span class="va">statistique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>valeur.t <span class="op">=</span> <span class="va">vt</span>, dl <span class="op">=</span> <span class="va">dl</span>, valeur.p <span class="op">=</span> <span class="va">vp</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">statistique</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Le voici comparé la fonction <strong>R</strong> de base.</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">gr0</span>, <span class="va">gr1</span><span class="op">)</span> <span class="co"># Absence de l'argument var.equal = TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  gr0 and gr1</span>
<span class="co">#&gt; t = 3, df = 27, p-value = 0.002</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.539 2.182</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of x mean of y </span>
<span class="co">#&gt;     1.332    -0.029</span>
<span class="fu">testt.ind2</span><span class="op">(</span><span class="va">gr0</span>, <span class="va">gr1</span><span class="op">)</span>
<span class="co">#&gt; $valeur.t</span>
<span class="co">#&gt; [1] 3.4</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dl</span>
<span class="co">#&gt; [1] 26.9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $valeur.p</span>
<span class="co">#&gt; [1] 0.00213</span></code></pre></div>
<p>Les sorties sont identiques.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:disttt"></span>
<img src="09-Analyser_files/figure-html/disttt-1.png" alt="Valeur-$t$ de la différence de moyenne sur la distribution-$t$" width="75%" height="75%"><p class="caption">
Figure 9.1: Valeur-<span class="math inline">\(t\)</span> de la différence de moyenne sur la distribution-<span class="math inline">\(t\)</span>
</p>
</div>
<p>La Figure <a href="analyser.html#fig:disttt">9.1</a> illustre où se situe la moyenne de l’échantillon par rapport à la distribution d’échantillonnage de l’hypothèse nulle. Comme la valeur se retrouve dans la zone de rejet ou, de façon équivalente, la valeur-<span class="math inline">\(p\)</span> est plus petite que la valeur <span class="math inline">\(\alpha\)</span> fixé (ici à 5%), on rejette l’hypothèse nulle, il y a vraisemblablement une différence entre les groupes, ce qui était l’intention derrière la création des données.</p>
</div>
<div id="test-t-dépendant" class="section level3" number="9.1.2">
<h3>
<span class="header-section-number">9.1.2</span> Test-<em>t</em> dépendant<a class="anchor" aria-label="anchor" href="#test-t-d%C3%A9pendant"><i class="fas fa-link"></i></a>
</h3>
<p>Un dernier test-<span class="math inline">\(t\)</span> a présenté est le test permettant de comparer deux de temps de mesure sur les mêmes participants. L’hypothèse désirée est de constater si <span class="math inline">\(\mu_1 = \mu_2\)</span>, soit la moyenne du temps 1 est égale à la moyenne du temps 2. Une habile manipulation mathématique permet de poser cette hypothèse en hypothèse nulle, <span class="math inline">\(\mu_1-\mu_2=0\)</span>. Il est intéressant de noter (ou de rappeler) que la différence entre deux variables est normalement distribuée si la variance est connue ou distribuée en <span class="math inline">\(t\)</span> si la variance est inconnue.</p>
<p>Ce test est utile lorsqu’il faut tester si les participants se sont améliorés ou détériorés entre deux temps de mesure. Pour calculer la valeur-<span class="math inline">\(t\)</span>,</p>
<p><span class="math display">\[ t_{dl_1} = \frac{\bar{x_1}-\bar{x_2}}{\sigma_d/\sqrt{n}} \]</span></p>
<p>avec <span class="math inline">\(n-1\)</span> degrés de liberté à cause de l’estimation de l’écart type. Les étapes subséquentes sont identiques au test-<span class="math inline">\(t\)</span> à groupe unique.</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">testt.dep</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">temps1</span>, <span class="va">temps2</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># temps est une variable continue mesurée </span>
  <span class="co"># à deux occasion auprès des mêmes participants</span>
  <span class="va">difference</span> <span class="op">&lt;-</span> <span class="va">temps1</span> <span class="op">-</span> <span class="va">temps2</span>
  <span class="va">dbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">difference</span><span class="op">)</span>
  <span class="va">dvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">difference</span><span class="op">)</span>
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">difference</span><span class="op">)</span>
  <span class="va">vt</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">dbar</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">dvar</span> <span class="op">/</span> <span class="va">n</span><span class="op">)</span>
  <span class="va">dl</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>
  <span class="va">vp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">vt</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">dl</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span>
  <span class="va">statistique</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>valeur.t <span class="op">=</span> <span class="va">vt</span>, dl <span class="op">=</span> <span class="va">dl</span>, valeur.p <span class="op">=</span> <span class="va">vp</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">statistique</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Pour créer le jeu de données, les étapes sont similaires au test-<span class="math inline">\(t\)</span> indépendant pour des temps de mesure indépendants (sans corrélation) où seules les populations des temps de mesure sont définis. Il est possible de spécifier une corrélation entre les deux de mesures. Cela sera introduit ultérieurement.</p>
<p>Dans ce jeu de données, 25 personnes sont mesurées à deux temps de reprises. Il n’y a pas de corrélation entre les temps de mesure. La variance des temps de mesure est de 1. La différence de moyenne est de 3.</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Un exemple de jeu de données</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">148</span><span class="op">)</span>
<span class="va">temps1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">temps2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">3</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>La fonction base de <strong>R</strong> est encore <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code>, mais il faudra spécifier l’argument <code>paired = TRUE</code> pour commander un test apparié (une autre appellation pour un test-<span class="math inline">\(t\)</span> dépendant).</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">temps1</span>, <span class="va">temps2</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Paired t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  temps1 and temps2</span>
<span class="co">#&gt; t = -3, df = 24, p-value = 0.008</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -3.268 -0.552</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of the differences </span>
<span class="co">#&gt;                   -1.91</span>
<span class="fu">testt.dep</span><span class="op">(</span><span class="va">temps1</span>, <span class="va">temps2</span><span class="op">)</span>
<span class="co">#&gt; $valeur.t</span>
<span class="co">#&gt; [1] -2.9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dl</span>
<span class="co">#&gt; [1] 24</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $valeur.p</span>
<span class="co">#&gt; [1] 0.0078</span></code></pre></div>
<p>Les sorties sont identiques.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:testtttt"></span>
<img src="09-Analyser_files/figure-html/testtttt-1.png" alt="Valeur-$t$ de moyenne de différences sur la distribution-$t$" width="75%" height="75%"><p class="caption">
Figure 9.2: Valeur-<span class="math inline">\(t\)</span> de moyenne de différences sur la distribution-<span class="math inline">\(t\)</span>
</p>
</div>
<p>La Figure <a href="analyser.html#fig:testtttt">9.2</a> montre où se situe la différence de moyenne par rapport à la distribution d’échantillonnage de l’hypothèse nulle. Comme la valeur se retrouve dans la valeur-<span class="math inline">\(p\)</span> est plus petite que la valeur <span class="math inline">\(\alpha\)</span> fixée (ici à 5%), on rejette l’hypothèse nulle, il y a vraisemblablement une différence entre les temps de mesure, ce qui était l’intention derrière la création des données.</p>
</div>
<div id="lanalyse-de-variance-à-un-facteur" class="section level3" number="9.1.3">
<h3>
<span class="header-section-number">9.1.3</span> L’analyse de variance à un facteur<a class="anchor" aria-label="anchor" href="#lanalyse-de-variance-%C3%A0-un-facteur"><i class="fas fa-link"></i></a>
</h3>
<p>L’analyse de variance, souvent appelée ANOVA (<em>ANalysis Of VAriance</em>), permet de comparer une variable continue sur plusieurs groupes ou traitements. Il s’agit d’une extension du test-<span class="math inline">\(t\)</span> indépendant qui compare une variable continue auprès de deux groupes. À plus de deux groupes, l’analyse de variance entre en jeu. <strong>Attention!</strong> Cette section se limite au cas où les groupes sont de tailles identiques (même nombre de participants par groupe, le symbole <span class="math inline">\(n_k\)</span> pour référer à cette quantité) afin d’en simplifier la présentation.</p>
<div id="la-logique-de-lanalyse-de-variance" class="section level4" number="9.1.3.1">
<h4>
<span class="header-section-number">9.1.3.1</span> La logique de l’analyse de variance<a class="anchor" aria-label="anchor" href="#la-logique-de-lanalyse-de-variance"><i class="fas fa-link"></i></a>
</h4>
<p>Comme il a été présenté dans la section sur le test-<span class="math inline">\(t\)</span> indépendant, le modèle sous-jacent à l’analyse de variance à un facteur est une extension de ce modèle pour <span class="math inline">\(k\)</span> groupes. Chaque groupe est associé à une différence de moyennes <span class="math inline">\(\mu_i\)</span>, pour <span class="math inline">\(i = 1,2, ...k\)</span> par rapport à la moyenne groupe référent, <span class="math inline">\(\mu_0\)</span>. Les variables <span class="math inline">\(x_i\)</span> définissent l’appartenance au groupe <span class="math inline">\(i\)</span> par la valeur 1 et 0 pour les autres groupes (codage factice ou <em>dummy coding</em>).</p>
<p><span class="math display">\[y = \mu_0 + \mu_1x_1 + \mu_2x_2+ ... +\mu_kx_k + \epsilon\]</span>
L’hypothèse nulle est la suivante.
<span class="math display">\[\sigma^2_1=\sigma^2_2=...=\sigma^2_k\]</span>
L’analyse de variance est un test omnibus (global) qui ne teste pas où est la différence, mais bien <em>s’il y a au moins une différence</em> entre les groupes. L’hypothèse nulle peut s’avérer fausse de plusieurs façons. Il peut y avoir une ou plusieurs inégalités pour rejeter l’hypothèse nulle.</p>
<p>La logique sous-jacente est basée sur l’idée selon laquelle les moyennes des groupes proviennent d’une même population. Elle compare les hypothèses suivantes : l’hypothèse nulle : les données (les moyennes) proviennent d’une même population; et l’hypothèse opposée : les données ne proviennent pas d’une même population.</p>
<p>Elle suggère ainsi deux types de variances (ou carré moyen, CM, dans ce contexte) : le CMI, carré moyen intergroupe, lorsque l’hypothèse nulle est vraie (la variabilité des moyennes); et le CMR, carré moyen résiduel, lorsque l’hypothèse nulle n’est ni vraie, ni fausse (la variabilité des données).</p>
<p>Pour calculer le CMI, la variance des moyennes des groupes est
<span class="math display">\[s^2_{\bar{x}}=\sum_{i=1}^k\frac{(\bar{x_i}-\overline{\overline{x}})^2}{k-1}\]</span></p>
<p>où <span class="math inline">\(\overline{\overline{x}}\)</span> est la grande moyenne (la moyenne de toutes les unités). Cette statistique se retrouve sur la plan des distributions d’échantillonnage (comment les moyennes se distribuent). Il faut ainsi multiplier cette valeur par <span class="math inline">\(n_k\)</span>, le nombre d’unités par groupes, pour obtenir une estimation de la variance de la population. Ainsi, <span class="math inline">\(\text{CMI} = s^2_{\bar{x}}n_k\)</span>.</p>
<p>Il y a plusieurs méthodes pour calculer le CMR, comme le CMR est envisagé comme la moyenne des variances de groupes, il est pratique d’en référer le calcul à sa définition.</p>
<p><span class="math display">\[
\text{CMR} = \bar{s^2} = \frac{1}{k}\sum_{i=k}^k\sigma_k^2
\]</span>
Lorsque l’hypothèse nulle est vraie, les variances des groupes sont traitées comme le résultat d’une étude sur une même population, comme si <span class="math inline">\(k\)</span> petites études avaient été réalisées. L’estimation du CMI est de l’ordre d’une distribution d’échantillonnage connue par le théorème central limite définissant le comportement des moyennes lorsqu’elles proviennent d’une même population (c’est ce que pose comme hypothèse l’analyse de variance). Toutefois, la valeur du CMI est relative au CMR, la quantité de bruit dans les données.</p>
<p>L’analyse de variance pose alors la question : la variance attribuable aux différentes moyennes des groupes est-elle supérieure à la variance résiduelle? Pour tester cette question, une possibilité est de tester le ratio <span class="math inline">\(\frac{\text{CMI}}{\text{CMR}}\)</span>, ce qui donne une valeur-<span class="math inline">\(F\)</span>. Le ratio de deux variances suit une distribution-<span class="math inline">\(F_{dl_1, dl_2}\)</span> avec deux degrés de liberté différents qui lui sont associés. Autrement dit, la distribution-<span class="math inline">\(F\)</span> est la distribution d’échantillonnage du ratio deux variances.</p>
<p><span class="math display">\[F_{dl_1,dl_2} = \frac{n_ks^2_{\bar{x}}}{\bar{s^2}} = \frac{\text{CMI}}{\text{CMR}}\]</span>
où <span class="math inline">\(dl_1 = k-1\)</span>, et <span class="math inline">\(dl_2 = k(n_k-1)\)</span>. L’interprétation du ratio est ainsi :</p>
<ul>
<li>si <span class="math inline">\(\text{CMI}&gt;\text{CMR}\)</span>, alors <span class="math inline">\(\text{CMI}/\text{CMR}&gt;1\)</span>;</li>
<li>si <span class="math inline">\(\text{CMI}=\text{CMR}\)</span>, alors <span class="math inline">\(\text{CMI}/\text{CMR}=1\)</span>;</li>
<li>si <span class="math inline">\(\text{CMI}&lt;\text{CMR}\)</span>, alors <span class="math inline">\(\text{CMI}/\text{CMR}&lt;1\)</span>.</li>
</ul>
<p>Plus les moyennes sont variables, plus la valeur du CMI est élevée. Plus les unités sont variables, plus le CMR est élevé. S’il existe au moins une différence entre les groupes, le ratio sera en faveur du CMI. En fait, plus <span class="math inline">\(F\)</span> est élevée, toutes autres choses étant égales (les degrés de libertés, p. ex.), plus la probabilité de rejeter l’hypothèse nulle sera grande. Ainsi, lorsque, la valeur-<span class="math inline">\(F\)</span> est obtenue, il est possible de calculer une valeur-<span class="math inline">\(p\)</span>, et le test d’hypothèse revient au même qu’auparavant.</p>
</div>
<div id="la-création-de-données" class="section level4" number="9.1.3.2">
<h4>
<span class="header-section-number">9.1.3.2</span> La création de données<a class="anchor" aria-label="anchor" href="#la-cr%C3%A9ation-de-donn%C3%A9es"><i class="fas fa-link"></i></a>
</h4>
<p>Dans un jeu de données commun, une variable désignera les groupes, et une autre leur score sur une certaine mesure. La syntaxe suivante montre trois façons pour créer une variable facteur.</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nk</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="co"># nombre d'unités par groupe</span>
<span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">4</span>  <span class="co"># nombre de groupes</span>
<span class="co"># En ordre</span>
<span class="va">groupe1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">k</span>, each <span class="op">=</span> <span class="va">nk</span><span class="op">)</span>
<span class="co"># En alternance</span>
<span class="va">groupe2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">k</span>, times <span class="op">=</span> <span class="va">nk</span><span class="op">)</span>
<span class="co"># Aléatoire</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">765</span><span class="op">)</span>
<span class="va">groupe3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">k</span>, size <span class="op">=</span> <span class="op">(</span><span class="va">k</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">groupe1</span>, <span class="va">groupe2</span>, <span class="va">groupe3</span><span class="op">)</span>
<span class="co">#&gt;       groupe1 groupe2 groupe3</span>
<span class="co">#&gt;  [1,]       1       1       4</span>
<span class="co">#&gt;  [2,]       1       2       2</span>
<span class="co">#&gt;  [3,]       1       3       4</span>
<span class="co">#&gt;  [4,]       1       4       3</span>
<span class="co">#&gt;  [5,]       1       1       3</span>
<span class="co">#&gt;  [6,]       2       2       4</span>
<span class="co">#&gt;  [7,]       2       3       3</span>
<span class="co">#&gt;  [8,]       2       4       1</span>
<span class="co">#&gt;  [9,]       2       1       4</span>
<span class="co">#&gt; [10,]       2       2       3</span>
<span class="co">#&gt; [11,]       3       3       3</span>
<span class="co">#&gt; [12,]       3       4       2</span>
<span class="co">#&gt; [13,]       3       1       3</span>
<span class="co">#&gt; [14,]       3       2       3</span>
<span class="co">#&gt; [15,]       3       3       2</span>
<span class="co">#&gt; [16,]       4       4       4</span>
<span class="co">#&gt; [17,]       4       1       4</span>
<span class="co">#&gt; [18,]       4       2       2</span>
<span class="co">#&gt; [19,]       4       3       1</span>
<span class="co">#&gt; [20,]       4       4       1</span></code></pre></div>
<p>Il est aussi possible de remplacer les arguments, <code>1:k</code> par des chaînes de caractères (des catégories au lieu de nombres).</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">categorie</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"char"</span>, <span class="st">"chat"</span>, <span class="st">"cheval"</span>, <span class="st">"chevalier"</span>, <span class="st">"chien"</span><span class="op">)</span>
<span class="va">nk</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">groupe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">categorie</span>, each <span class="op">=</span> <span class="va">nk</span><span class="op">)</span><span class="op">)</span> <span class="co"># Déclarer comme facteur</span>
<span class="va">groupe</span>
<span class="co">#&gt;  [1] char      char      chat      chat      cheval   </span>
<span class="co">#&gt;  [6] cheval    chevalier chevalier chien     chien    </span>
<span class="co">#&gt; Levels: char chat cheval chevalier chien</span></code></pre></div>
<p>Une bonne pratique dans le contexte des comparaisons de moyenne est de déclarer les variables catégorielles comme facteur avec <code><a href="https://rdrr.io/r/base/factor.html">as.factor()</a></code>.</p>
<p>Pour créer des valeurs à ces catégories, une stratégie simple est de créer des valeurs pour chacun des groupes et de les combiner.</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2602</span><span class="op">)</span>
<span class="va">char</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nk</span>, mean <span class="op">=</span> <span class="fl">15</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> 
<span class="va">chat</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nk</span>, mean <span class="op">=</span> <span class="fl">20</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="co"># Différences ici</span>
<span class="va">cheval</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nk</span>, mean <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="co"># et ici</span>
<span class="va">chevalier</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nk</span>, mean <span class="op">=</span> <span class="fl">15</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="va">chien</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nk</span>, mean <span class="op">=</span> <span class="fl">15</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> 
<span class="co"># Combinés</span>
<span class="va">score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">char</span>, <span class="va">chat</span>, <span class="va">cheval</span>, <span class="va">chevalier</span>, <span class="va">chien</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Conserver toutes les informations en un jeu de données</span>
<span class="va">donnees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">groupe</span>, <span class="va">score</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">)</span>
<span class="co">#&gt;   groupe score</span>
<span class="co">#&gt; 1   char    14</span>
<span class="co">#&gt; 2   char    12</span>
<span class="co">#&gt; 3   chat    17</span>
<span class="co">#&gt; 4   chat    21</span>
<span class="co">#&gt; 5 cheval    14</span>
<span class="co">#&gt; 6 cheval    10</span></code></pre></div>
</div>
<div id="dummy-coding" class="section level4" number="9.1.3.3">
<h4>
<span class="header-section-number">9.1.3.3</span> Dummy coding<a class="anchor" aria-label="anchor" href="#dummy-coding"><i class="fas fa-link"></i></a>
</h4>
<p>La plupart du temps, les variables de regroupement, les variables identifiant l’appartenance aux groupes, sont construites avec une variable de type facteur, c’est-à-dire une colonne avec différentes valeurs ou libellés. C’est d’ailleurs ce qui a été fait dans l’exemple précédent. Cette méthode d’identification de groupement implique une programmation plus intensive, surtout pour la création de valeurs. En termes de programmation, il est plus élégant de recourir à une fonction de codage factice. Cela permettra de représenter fidèlement le modèle sous-jacent. Étrangement, il n’y a pas de fonction de base avec <strong>R</strong> pour du codage factice. Une fonction maison permettra d’automatiser la réassignation des groupes (en une seule variable) sur plusieurs variables désignant leur appartenance.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dummy.coding</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># Retourne un codage factice de x</span>
  <span class="co"># avec les facteurs en ordre alphabétique</span>
  
  <span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>    <span class="co"># Extraire une table</span>
  <span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span>   <span class="co"># Nombre de groupes</span>
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>     <span class="co"># Nombre d'unités</span>
  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">k</span><span class="op">)</span> <span class="co"># Création d'une nouvelle variable </span>
  <span class="va">xlev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">X</span><span class="op">[</span><span class="va">i</span>, <span class="va">xlev</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># Identification des groupes</span>
  <span class="op">}</span>
  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>La fonction maison retourne un codage factice pour les <span class="math inline">\(k\)</span> groupes. <strong>Attention</strong>, le codage factice est fait en ordre alphabétique. Comme il est redondant d’avoir <span class="math inline">\(k\)</span> groupes (identifier <span class="math inline">\(k\)</span> groupes nécessite <span class="math inline">\(k-1\)</span> variables), un groupe référent est désigné. Ce dernier aura 0 sur tous les scores. Pour retirer un groupe, l’utilisation des crochets et une valeur négative associés à la colonne du groupe référent feront l’affaire, p. ex. <code>dummy.coding(x)[,-k]</code> déclarera le <span class="math inline">\(k\)</span><sup>e</sup> groupe comme le groupe référent.</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Facteur de groupe</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2602</span><span class="op">)</span>
<span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">categorie</span><span class="op">)</span>
<span class="va">nk</span> <span class="op">&lt;-</span> <span class="fl">2</span>
<span class="va">groupe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">categorie</span>, each <span class="op">=</span> <span class="va">nk</span><span class="op">)</span>
<span class="co"># Groupement</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">dummy.coding</span><span class="op">(</span><span class="va">groupe</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span> <span class="co"># groupe 4 "chien" comme référent</span>
<span class="co"># Spécifications des paramètres</span>
<span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">15</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">0</span><span class="op">)</span>
<span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">k</span> <span class="op">*</span> <span class="va">nk</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="co"># Création des scores</span>
<span class="va">score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mu0</span> <span class="op">+</span> <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">mu</span> <span class="op">+</span> <span class="va">e</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">donnees</span>, <span class="va">score</span><span class="op">)</span>
<span class="co">#&gt;       groupe score score</span>
<span class="co">#&gt; 1       char    14    14</span>
<span class="co">#&gt; 2       char    12    12</span>
<span class="co">#&gt; 3       chat    17    17</span>
<span class="co">#&gt; 4       chat    21    21</span>
<span class="co">#&gt; 5     cheval    14    14</span>
<span class="co">#&gt; 6     cheval    10    10</span>
<span class="co">#&gt; 7  chevalier    12    12</span>
<span class="co">#&gt; 8  chevalier    17    17</span>
<span class="co">#&gt; 9      chien    21    21</span>
<span class="co">#&gt; 10     chien    18    18</span></code></pre></div>
<p>L’expression <code>X %*% mu</code> est une multiplication d’algèbre matricielle qui multiplie la matrice <span class="math inline">\(n \times p\)</span> de codage factice <span class="math inline">\(X\)</span> à une matrice <span class="math inline">\(p\times 1\)</span> de moyennes <span class="math inline">\(\mu\)</span>. L’opération multiple les <span class="math inline">\(p\)</span> éléments d’une ligne de <span class="math inline">\(X\)</span> à la colonne <span class="math inline">\(p\)</span> correspondante de <span class="math inline">\(\mu\)</span>. En algèbre matricielle Le résultat est une matrice <span class="math inline">\(n \times 1\)</span> qui contient les différences de moyennes pour chaque unité. Dans la même ligne de syntaxe, la moyenne de la population (groupe référent), <span class="math inline">\(\mu_0\)</span> est ajoutée et la variation individuelle, <span class="math inline">\(\epsilon\)</span>.</p>
<p>Les scores produits sont identiques. Dans cet exemple par contre, l’origine des différences entre groupes est plus évidente, spécialement en comparant le modèle sous-jacent à l’analyse de variance. La source d’erreur est visible ainsi que les différences de moyennes. La force de cette deuxième méthode est qu’elle pourrait facilement être automatisée pour créer des jeux de données, alors que la première serait plus compliquée. La seconde méthode nécessite six arguments (<span class="math inline">\(n_k\)</span>, <span class="math inline">\(\mu_0\)</span>, <span class="math inline">\(\mu_{1:k}\)</span>, et <span class="math inline">\(\sigma_{e}\)</span> en plus de catégories et définir le groupe référent), la première aurait de la difficulté à spécifier tous les arrangements de différence de moyennes automatiquement, quoiqu’elles seraient plus personnalisables.</p>
</div>
<div id="analyse" class="section level4" number="9.1.3.4">
<h4>
<span class="header-section-number">9.1.3.4</span> Analyse<a class="anchor" aria-label="anchor" href="#analyse"><i class="fas fa-link"></i></a>
</h4>
<p>À toute fin pratique, un jeu de données est recréé avec les catégories et paramètres précédents, mais avec <span class="math inline">\(n_k=20\)</span> unités par groupe. La fonction <strong>R</strong> de base est <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>. Elle prend comme argument une formule, de forme <code>VD ~ VI</code> (variable dépendante prédite par variable indépendante) et un jeu de données duquel prendre les variables. Il existe également une fonction <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code>, une fonction un peu plus complexe que <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>. Pour obtenir toute l’information désirée de la sortie de la fonction, il faut demander un sommaire de la sortie avec <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>.</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Anova de base</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">score</span> <span class="op">~</span> <span class="va">groupe</span>, data <span class="op">=</span> <span class="va">donnees</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>
<span class="co">#&gt;             Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span>
<span class="co">#&gt; groupe       4    834   208.4      14 5.1e-09 ***</span>
<span class="co">#&gt; Residuals   95   1414    14.9                    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  </span>
<span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Fonction maison</span>
<span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">$</span><span class="va">groupe</span><span class="op">)</span>
<span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">gr</span><span class="op">)</span>
<span class="va">nk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="va">k</span>

<span class="co"># Moyennes et variance des groupes</span>
<span class="va">moyenne</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/by.html">by</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">$</span><span class="va">score</span>, <span class="va">donnees</span><span class="op">$</span><span class="va">groupe</span>, <span class="va">mean</span><span class="op">)</span>
<span class="va">variance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/by.html">by</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">$</span><span class="va">score</span>, <span class="va">donnees</span><span class="op">$</span><span class="va">groupe</span>, <span class="va">var</span><span class="op">)</span>

<span class="va">CMI</span> <span class="op">&lt;-</span> <span class="va">nk</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">moyenne</span><span class="op">)</span>
<span class="va">CMR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">variance</span><span class="op">)</span>
<span class="va">dl1</span> <span class="op">&lt;-</span> <span class="va">k</span> <span class="op">-</span> <span class="fl">1</span>
<span class="va">dl2</span> <span class="op">&lt;-</span> <span class="va">k</span> <span class="op">*</span> <span class="op">(</span><span class="va">nk</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">vf</span> <span class="op">&lt;-</span> <span class="va">CMI</span> <span class="op">/</span> <span class="va">CMR</span> 
<span class="va">vp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">pf</a></span><span class="op">(</span><span class="va">vf</span>, df1 <span class="op">=</span> <span class="va">dl1</span>, df2 <span class="op">=</span> <span class="va">dl2</span><span class="op">)</span><span class="op">)</span> 
<span class="co"># Création du tableau</span>
<span class="va">resultats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">5</span><span class="op">)</span> <span class="co"># Tableau vide</span>
<span class="co"># Ajouter noms</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">resultats</span><span class="op">)</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dl"</span>, <span class="st">"SS"</span>, <span class="st">"CM"</span>, <span class="st">"F"</span>, <span class="st">"p"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">resultats</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"groupe"</span>,<span class="st">"residu"</span><span class="op">)</span>
<span class="co"># Ajouter valeurs</span>
<span class="va">resultats</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dl1</span>, <span class="va">CMI</span> <span class="op">*</span> <span class="va">dl1</span>, <span class="va">CMI</span>, <span class="va">vf</span>, <span class="va">vp</span><span class="op">)</span>
<span class="va">resultats</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dl2</span>, <span class="va">CMR</span> <span class="op">*</span> <span class="va">dl2</span>, <span class="va">CMR</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
<span class="va">resultats</span>
<span class="co">#&gt;        dl   SS    CM  F        p</span>
<span class="co">#&gt; groupe  4  834 208.4 14 5.15e-09</span>
<span class="co">#&gt; residu 95 1414  14.9  0 0.00e+00</span></code></pre></div>
<p>Les résultats sont identiques, les seules différences étant dues à l’arrondissement. Comme la valeur-<span class="math inline">\(p\)</span> est de 5.145^{-9}, ce qui est extrêmement plus petit que l’usuel .05 (ou un autre taux d’erreur de type I fixé à l’avance), l’hypothèse nulle est rejetée, il y a vraisemblablement une différence entre les groupes, ce qui est déjà connu. La Figure <a href="analyser.html#fig:ft">9.3</a> illustre très bien la rareté d’un tel jeu de données sous l’hypothèse nulle.</p>
<div class="figure">
<span style="display:block;" id="fig:ft"></span>
<img src="09-Analyser_files/figure-html/ft-1.png" alt="Valeur-$F$ de la comparaison des moyennes" width="672"><p class="caption">
Figure 9.3: Valeur-<span class="math inline">\(F\)</span> de la comparaison des moyennes
</p>
</div>
</div>
</div>
</div>
<div id="lassociation-linéaire" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> L’association linéaire<a class="anchor" aria-label="anchor" href="#lassociation-lin%C3%A9aire"><i class="fas fa-link"></i></a>
</h2>
<div id="la-covariance" class="section level3" number="9.2.1">
<h3>
<span class="header-section-number">9.2.1</span> La covariance<a class="anchor" aria-label="anchor" href="#la-covariance"><i class="fas fa-link"></i></a>
</h3>
<p>La covariance représente une mesure du degré auquel une variable augmente lorsque l’autre augmente. Elle correspond au produit moyen entre deux variables centrées (dont les moyennes sont soustraites). On retrouve l’équation sous la forme suivante.
<span class="math display">\[\text{cov}_{xy} = \sigma_{xy}=\frac{1}{n-1}\sum_{i=1}^n(x_i-\bar{x})(y_i-\bar{y})\]</span></p>
<p>La covariance est une extension multivariée de la variance. La variance est le produit d’une variable <strong>centrée</strong> avec elle-même (le carré de la variable), <span class="math display">\[\sigma^2=\frac{1}{n-1}\sum_{i=1}^nx_ix_i\]</span>.</p>
<p>En transformant <span class="math inline">\(x\)</span> et <span class="math inline">\(y\)</span> pour qu’elles soient <strong>centrées</strong>, l’aspect de produit entre les deux variables devient évident dans l’expression de la covariance.
<span class="math display">\[\text{cov}_{xy} = \frac{1}{n-1}\sum_{i=1}^nxy\]</span>
La programmation de la covariance pourrait se traduire ainsi.</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">covariance</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># X est une data.frame ou matrice de n sujets par p variables</span>
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="co"># centrer variables</span>
  <span class="va">xc</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">yc</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
  <span class="va">prod.xy</span> <span class="op">&lt;-</span> <span class="va">xc</span> <span class="op">*</span> <span class="va">yc</span>
  <span class="va">cov.xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">prod.xy</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">cov.xy</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>La fonction de base <code><a href="https://rdrr.io/r/stats/cor.html">cov()</a></code> sera plus efficace (plus robuste et plus simple) que la fonction maison précédente. La fonction <code><a href="https://rdrr.io/r/stats/cor.html">cov()</a></code> peut tenir compte de plus de deux variables.
La covariance indique la direction de la covariation entre les deux variables, positives ou négatives, mais n’indique pas la force de la relation. Bien qu’une covariance de 0 indique l’absence de colinéarité, une covariance de 120 n’est pas nécessairement plus forte qu’une covariance de 1. La mesure est intrinsèquement influencée par les unités l’échelle de mesure. Il serait aberrant de considérer le système métrique comme moins efficace, car ces mesures sont moins variables que les mesures impériales. (Il y a plusieurs raisons de préférer le système métrique, mais ce n’en est pas une!)</p>
</div>
<div id="la-corrélation" class="section level3" number="9.2.2">
<h3>
<span class="header-section-number">9.2.2</span> La corrélation<a class="anchor" aria-label="anchor" href="#la-corr%C3%A9lation"><i class="fas fa-link"></i></a>
</h3>
<p>La corrélation représente le degré d’association linéaire entre deux variables. Une façon simple de considérer la corrélation est de la concevoir comme une covariance standardisée. Elle varie entre -1 et 1, ces deux dernières valeurs impliquant, respectivement, une relation parfaitement négative et positive entre les deux variables. En plus d’indiquer la direction de la relation, la corrélation suggère une force à ce lien. Lorsque la valeur de la corrélation est nulle, <span class="math inline">\(r=0\)</span>, un diagramme de dispersion ne montre qu’un nuage de point épars (sans structure), plus la corrélation augmente (en terme absolu) plus le nuage tends vers une ligne droite. La Figure <a href="analyser.html#fig:corimage">9.4</a> montre différentes valeurs de corrélation et un exemple de nuage de point qui lui est associé.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:corimage"></span>
<img src="09-Analyser_files/figure-html/corimage-1.png" alt="Illustrations de diagrammes de dispersion associé en fonction de corrélations" width="50%" height="50%"><p class="caption">
Figure 9.4: Illustrations de diagrammes de dispersion associé en fonction de corrélations
</p>
</div>
<p>En statistiques, la corrélation est souvent représentée par la lettre grecque <span class="math inline">\(\rho\)</span> (rho) ou l’usuel <span class="math inline">\(r\)</span> lorsqu’il s’agit d’une estimation à partir d’un échantillon.</p>
<p>Il y a plusieurs méthodes pour calculer la corrélation. Une première est de considérer la corrélation comme le produit de variables standardisées (autrement dit, score-<span class="math inline">\(z\)</span>). Pour la covariance, la moyenne était soustraite de la variable, donc des variables centrées. Pour la corrélation, on divise l’écart type également pour obtenir des variables standardisées.</p>
<p>En admettant que <span class="math inline">\(x\)</span> et <span class="math inline">\(y\)</span> sont déjà <strong>standardisée</strong>, <span class="math inline">\(z_x,z_y\)</span>, comme c’était le cas pour la covariance, l’aspect de produit entre les deux variables est conservé.
<span class="math display">\[\text{cor}_{xy} = r_{xy}= \frac{1}{n-1}\sum_{i=1}^nz_xz_y\]</span></p>
<p>Il est possible de calculer la directement la corrélation à partir de la covariance, soit en divisant par le produit des écarts types des variables.</p>
<p><span class="math display">\[r_{xy} = \frac{\text{cov}_{xy}}{\sigma_x\sigma_y}\]</span></p>
<p>Voici trois options de programmation de la corrélation. La première et la deuxième sont basées sur la covariance. Dans la première, la covariance est calculée de nouveau dans la fonction. La deuxième quant à elle profite avantageusement de l’existence d’une fonction maison qui calcule directement la covariance. La troisième recourt au produit de variables standardisées.</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Option 1 : Calcul complet</span>
<span class="va">correlation1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span>
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="co"># centrer variables</span>
  <span class="va">xc</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">yc</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
  <span class="va">prod.xy</span> <span class="op">&lt;-</span> <span class="va">xc</span> <span class="op">*</span> <span class="va">yc</span>
  <span class="va">cov.xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">prod.xy</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>
  <span class="va">cor.xy</span> <span class="op">&lt;-</span> <span class="va">cov.xy</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">cor.xy</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Option 2 : Basé sur la covariance</span>
<span class="va">correlation2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span>
  <span class="va">cov.xy</span> <span class="op">&lt;-</span> <span class="fu">covariance</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> 
  <span class="va">cor.xy</span> <span class="op">&lt;-</span> <span class="va">cov.xy</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">cor.xy</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># Option 3 : Basé sur des variables standardisées</span>
<span class="va">correlation3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span>
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">xs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">ys</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>
  <span class="va">cor.xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xs</span><span class="op">*</span><span class="va">ys</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">cor.xy</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Évidemment, <strong>R</strong> possède une fonction de base pour le calcul d’une corrélation entre deux variables ou d’une matrice de corrélation (à partir d’un jeu de données de deux variables ou plus). Il s’agit de <code><a href="https://rdrr.io/r/stats/cor.html">cor()</a></code>. Ces trois fonctions maison en plus de la fonction <strong>R</strong> sont comparées ci-dessous. Pour ce faire, un jeu de données est créé possédant les caractéristiques désirées. Dans ce cas-ci, la taille d’échantillon est fixée à <span class="math inline">\(n=10000\)</span> pour assurer une bonne précision dans l’échantillon et une corrélation <span class="math inline">\(r=.7\)</span>.</p>
<p>Une façon simple de produire des données à partir d’une matrice de corrélation (ou de covariance) est d’utiliser la fonction <code>mvrnorm()</code> du package <code>MASS</code>. Elle évitera pour l’instant d’introduire les manipulations mathématiques nécessaires (ce sera donc pour l’instant l’une de ces boîtes noires ayant la confiance de l’utilisateur). La fonction <code>mvrnorm()</code> pour <em>MultiVariate Random NORMmal</em> nécessite trois arguments : La taille d’échantillon <code>n</code>, les moyennes <code>mu</code> des <span class="math inline">\(p\)</span> variables et la matrice de covariance <code>Sigma</code> (la corrélation est un cas particulier de la covariance où les variables sont standardisées). Le lecteur avisé aura noté la ressemblance de nomenclature entre <code>mvrnorm()</code> (multivariée) et
<code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> (univariée). Enfin, la dernière étape est de produire une matrice de covariance <span class="math inline">\(p \times p\)</span>. La fonction <code><a href="https://rdrr.io/r/base/matrix.html">matrix()</a></code> prend une variable de données, dans cet exemple , <code>c(1, r, r, 1)</code> qu’elle répartit ligne par colonne. Comme <span class="math inline">\(p=2\)</span>, cela crée une matrice <span class="math inline">\(2 \times 2\)</span>.</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">820</span><span class="op">)</span>
<span class="co"># Taille d'échantillon importante pour réduire l'erreur d'échantillonnage</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10000</span>
<span class="co"># La corrélation désirée</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">.70</span>
<span class="co"># Création d'une matrice de corrélation</span>
<span class="va">R</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">r</span>, <span class="va">r</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co"># Création des données </span>
<span class="va">donnees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">R</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>
<span class="co"># Voici la matrice de corrélation</span>
<span class="va">R</span>
<span class="co">#&gt;      [,1] [,2]</span>
<span class="co">#&gt; [1,]  1.0  0.7</span>
<span class="co">#&gt; [2,]  0.7  1.0</span>
<span class="co"># Voici une visualisation partielle des données</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">)</span>
<span class="co">#&gt;        x      y</span>
<span class="co">#&gt; 1  0.635  0.914</span>
<span class="co">#&gt; 2 -0.193  0.360</span>
<span class="co">#&gt; 3 -0.602 -1.213</span>
<span class="co">#&gt; 4 -0.841 -0.986</span>
<span class="co">#&gt; 5 -0.105 -1.771</span>
<span class="co">#&gt; 6 -2.147 -1.590</span>
<span class="co"># Vérifications des variables</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; [1] -0.00578</span>
<span class="co">#&gt; [1] -0.00531</span>
<span class="co">#&gt; [1] 0.999</span>
<span class="co">#&gt; [1] 1.01</span>
<span class="co"># Les résultats sont près des attentes</span>
<span class="co"># Vérifications de la corrélations</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">$</span><span class="va">x</span>, <span class="va">donnees</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.699</span>
<span class="fu">correlation1</span><span class="op">(</span><span class="va">donnees</span><span class="op">$</span><span class="va">x</span>, <span class="va">donnees</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.699</span>
<span class="fu">correlation2</span><span class="op">(</span><span class="va">donnees</span><span class="op">$</span><span class="va">x</span>, <span class="va">donnees</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.699</span>
<span class="fu">correlation3</span><span class="op">(</span><span class="va">donnees</span><span class="op">$</span><span class="va">x</span>, <span class="va">donnees</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.699</span>
<span class="co"># Les résultats sont près des attentes et identiques</span></code></pre></div>
<p>Pour tester la probabilité d’obtenir cette valeur, la corrélation <span class="math inline">\(r\)</span> peut se transformer monotonement en valeur-<span class="math inline">\(t\)</span>, ce qui permet de calculer des valeurs-<span class="math inline">\(p\)</span> par la suite.</p>
<p><span class="math display">\[ t_{n-2} = \frac{r}{(\frac{\sqrt{1-r^2}}{\sqrt{n-2}})} \]</span>
Cette formule se traduit simplement en code <strong>R</strong>.</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Création d'une matrice de corrélation, </span>
<span class="co"># il pourrait également s'agir d'un vecteur ou d'un scalaire.</span>
<span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">.5</span>,<span class="fl">.4</span>,<span class="fl">.5</span>,<span class="fl">1</span>,<span class="fl">.3</span>,<span class="fl">.4</span>,<span class="fl">.3</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>
<span class="co"># Nombre d'unités (valeur arbitraire ici)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="co"># Valeurs t</span>
<span class="va">vt</span> <span class="op">&lt;-</span> <span class="va">r</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">r</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span>
<span class="co"># Valeurs-p</span>
<span class="va">vp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">vt</span><span class="op">)</span>, df <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span>
<span class="va">vt</span> ; <span class="va">vp</span>
<span class="co">#&gt;      [,1]  [,2]  [,3]</span>
<span class="co">#&gt; [1,]  Inf 1.633 1.234</span>
<span class="co">#&gt; [2,] 1.63   Inf 0.889</span>
<span class="co">#&gt; [3,] 1.23 0.889   Inf</span>
<span class="co">#&gt;       [,1]  [,2]  [,3]</span>
<span class="co">#&gt; [1,] 0.000 0.141 0.252</span>
<span class="co">#&gt; [2,] 0.141 0.000 0.400</span>
<span class="co">#&gt; [3,] 0.252 0.400 0.000</span></code></pre></div>
<p>Dans le code ci-dessous, l’équation précédente est subtilement réarrangée pour être plus simple et élégante quoiqu’équivalente.
<span class="math display">\[ t_{n-2} = \frac{r}{(\frac{\sqrt{1-r^2}}{\sqrt{n-2}})} = \frac{r\sqrt{n-2}}{\sqrt{1-r^2}}\]</span>
La première a l’avantage de montrer la relation entre l’estimateur et l’erreur type alors que la seconde est moins encombrante.</p>
</div>
</div>
<div id="les-données-nominales" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Les données nominales<a class="anchor" aria-label="anchor" href="#les-donn%C3%A9es-nominales"><i class="fas fa-link"></i></a>
</h2>
<p>Jusqu’à présent, deux types d’association de données ont été présenté : une variable nominale (identifiant des groupes) avec une variable continue (différences de moyenne) et deux variables continues (association linéaire). Dans cette section, l’association entre deux variables nominales est présentée. Une façon de représenter l’association entre deux variables nominales est le tableau de contingence, soit l’illustration d’une distribution d’une variable (en ligne) pour chaque catégorie de l’autre (en colonne). En voici, un exemple.</p>
<div class="inline-table"><table class=" lightable-classic table" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;'>
<caption>
<span id="tab:TCCV">Table 9.1: </span>Tableau de contingence de la relation entre posséder une voiture et le climatoscepticisme
</caption>
<thead>
<tr>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Climatosceptique
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Voiture
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
non
</th>
<th style="text-align:center;">
oui
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
non
</td>
<td style="text-align:center;">
87
</td>
<td style="text-align:center;">
104
</td>
</tr>
<tr>
<td style="text-align:left;">
oui
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
52
</td>
</tr>
</tbody>
</table></div>
<p>Le tableau <a href="analyser.html#tab:TCCV">9.1</a> présente deux variables nominales (<code>climatosceptique</code>, à la verticale, et posséder une <code>voiture</code>, à l’horizontale) ayant chacune deux catégories (<code>oui</code> et <code>non</code>). Il montre les proportions <strong>observées</strong>. Ces variables sont-elles associées? Pour traiter cette question, les proportions attendues jouent un rôle crucial. En fait, l’hypothèse nulle sous la table de contingence postule que toutes les proportions du tableau de contingence sont indépendantes. Mathématiquement, il s’agit de postuler que les proportions d’une variable (en ligne ou en colonne) n’influencent pas celles de l’autre variable. Pour obtenir les proportions <strong>théoriques</strong>, les totaux des lignes et colonnes sont calculés ainsi que le grand total. La fréquence attendue d’une cellule est obtenue en calculant, pour chaque cellule, le produit de sa colonne et de sa ligne respective divisé par le grand total.</p>
<p><span class="math display">\[t_{ij} = \frac{\text{total}_i \times \text{total}_j}{\sum \text{total}}\]</span></p>
<p>L’équation ci-dessus illustre l’idée sous-jacente à la proportion attendue, <span class="math inline">\(t\)</span> d’une cellule de ligne, <span class="math inline">\(i\)</span>, et colonne <span class="math inline">\(j\)</span>.</p>
<div class="inline-table"><table class=" lightable-classic table" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;'>
<caption>
<span id="tab:TCCV2">Table 9.2: </span>Tableau de contingence étendu avec les totaux
</caption>
<thead>
<tr>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Climatosceptique
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Voiture
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Total
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
non
</th>
<th style="text-align:center;">
oui
</th>
<th style="text-align:center;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
non
</td>
<td style="text-align:center;">
87
</td>
<td style="text-align:center;">
104
</td>
<td style="text-align:center;">
191
</td>
</tr>
<tr>
<td style="text-align:left;">
oui
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
52
</td>
<td style="text-align:center;">
59
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:center;">
94
</td>
<td style="text-align:center;">
156
</td>
<td style="text-align:center;">
250
</td>
</tr>
</tbody>
</table></div>
<div id="le-chi2-pour-table-de-contingence" class="section level3" number="9.3.1">
<h3>
<span class="header-section-number">9.3.1</span> Le <span class="math inline">\(\chi^2\)</span> pour table de contingence<a class="anchor" aria-label="anchor" href="#le-chi2-pour-table-de-contingence"><i class="fas fa-link"></i></a>
</h3>
<p>Maintenant que la question statistique et que l’hypothèse nulle sont posées, comment mesurer le degré selon lequel les données s’écartent des attentes <em>théoriques</em>. Le <span class="math inline">\(\chi^2\)</span> (prononcé khi-carré) permet de calculer une telle mesure. Le <span class="math inline">\(\chi^2\)</span> correspond à la distance entre une valeur observée et théorique au carré, pondérée par la valeur théorique.
<span class="math display">\[ \chi^2_v = \sum_{i=1}^{l}\sum_{j=1}^c(\frac{(o_{ij}-t_{ij})^2}{t_{ij}})\]</span>
où <span class="math inline">\(o\)</span> correspond aux valeurs observées, <span class="math inline">\(t\)</span> réfère aux valeurs théoriques, <span class="math inline">\(v\)</span> représente les degrés de liberté et <span class="math inline">\(i\)</span> et <span class="math inline">\(j\)</span> les lignes et colonnes respectivement. Le degré de liberté est
<span class="math display">\[v = (n_{\text{ligne}}-1)(n_{\text{colonne}}-1)\]</span></p>
<p>Si l’hypothèse nulle est vraie, les valeurs observées et théoriques devraient être très près. Le carré permet de calculer une distance euclidienne et le dénominateur pondère la distance. Comme l’analyse de variance, le test de <span class="math inline">\(\chi^2\)</span> pour table de contingence est global, il n’informe pas d’où provient la dépendance, mais bien s’il y a au moins une dépendance.</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">khicarre</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">obs</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># Obs est une table de contingence</span>
  <span class="co"># Somme colonne</span>
  <span class="va">SC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colSums</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span><span class="op">)</span>
  <span class="co"># Somme ligne</span>
  <span class="va">SL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span><span class="op">)</span>
  <span class="co"># Grand total</span>
  <span class="va">TT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span>
  <span class="co"># Proportion théoriques</span>
  <span class="va">theo</span> <span class="op">&lt;-</span> <span class="va">SL</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">SC</span><span class="op">)</span> <span class="op">/</span> <span class="va">TT</span>
  <span class="co"># khi carré</span>
  <span class="va">khi2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">obs</span> <span class="op">-</span> <span class="va">theo</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span> <span class="op">/</span> <span class="va">theo</span><span class="op">)</span>
  <span class="va">dl</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">SL</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">SC</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>
  <span class="va">vp</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="va">khi2</span>, <span class="va">dl</span><span class="op">)</span>
  <span class="co"># Sortie</span>
  <span class="va">statistiques</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>khi2 <span class="op">=</span> <span class="va">khi2</span>, dl <span class="op">=</span> <span class="va">dl</span>, valeur.p <span class="op">=</span> <span class="va">vp</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">statistiques</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Il y a plusieurs techniques pour créer une base de données, l’essentiel étant de lier les proportions désirées. Ici, une variable sexe est créée avec 50-50% de chance d’être l’un ou l’autre sexe. Par la suite, une proportion différente liée au sexe est utilisée pour générer la fréquence de consommation de tabac. La syntaxe sert principalement à identifier les valeurs <code>homme</code> et <code>femme</code> de la première variable pour en associer une valeur <code>tabac</code>.</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">54</span><span class="op">)</span>
  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span>
  <span class="co"># Première variable</span>
  <span class="va">sexe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"homme"</span>,<span class="st">"femme"</span><span class="op">)</span>, 
                size <span class="op">=</span> <span class="va">n</span>, 
                replace <span class="op">=</span> <span class="cn">TRUE</span>, 
                prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">.5</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tabac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>
  <span class="co"># Proportions conditionnelles</span>
  <span class="va">tabac</span><span class="op">[</span><span class="va">sexe</span> <span class="op">==</span> <span class="st">"femme"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"fumeur"</span>,<span class="st">"non-fumeur"</span><span class="op">)</span>, 
                                    size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">sexe</span> <span class="op">==</span> <span class="st">"femme"</span><span class="op">)</span>, 
                                    replace <span class="op">=</span> <span class="cn">TRUE</span>, 
                                    prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.2</span>,<span class="fl">.8</span><span class="op">)</span><span class="op">)</span>
  <span class="va">tabac</span><span class="op">[</span><span class="va">sexe</span> <span class="op">==</span> <span class="st">"homme"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"fumeur"</span>,<span class="st">"non-fumeur"</span><span class="op">)</span>, 
                                    size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">sexe</span> <span class="op">==</span> <span class="st">"homme"</span><span class="op">)</span>, 
                                    replace <span class="op">=</span> <span class="cn">TRUE</span>, 
                                    prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.1</span>,<span class="fl">.9</span><span class="op">)</span><span class="op">)</span>
  <span class="co">#base données</span>
  <span class="va">donnees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">sexe</span>, <span class="va">tabac</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">)</span>
<span class="co">#&gt;        tabac</span>
<span class="co">#&gt; sexe    fumeur non-fumeur</span>
<span class="co">#&gt;   femme      8         38</span>
<span class="co">#&gt;   homme      4         50</span></code></pre></div>
<p>La fonction <code><a href="https://rdrr.io/r/base/table.html">table()</a></code> de <strong>R</strong> génère une table de contingence. La fonction maison et deux méthodes de base <strong>R</strong> sont présentées et produisent les mêmes résultats pour le <span class="math inline">\(\chi^2\)</span>. Un autre, le test exact de Fisher est également présenté. Celui-ci est plus robuste, mais peut requérir plus intensive des ressources de l’ordianteur pour les grosses tables de contingences.</p>
<p>Le test du <span class="math inline">\(\chi^2\)</span> est sujet à certains problèmes qu’il est important de considérer sans quoi l’interprétation pourra être faussée. Si la taille d’échantillon (le nombre d’unités d’observation observées est trop faible), alors le test est biaisé. Par exemple, trois lancers de pile ou face ne sont pas suffisants pour tester une hypothèse de khi-carré, le nombre de résultats différents est de 2, ce qui ne donne pas une approximation satisfaisante de la distribution d’échantillonnage. La convention est de dire qu’une fréquence théorique est trop petite si elle est plus petite que 5. Si ce n’est pas cas, des corrections ou d’autres options doivent être considérées.</p>
<p>Dans le présent exemple, bien que les fréquences attendues respectent les critères usuels, il peut être utile d’envisager un test plus robuste comme le test exact de Fisher ou le <span class="math inline">\(\chi^2\)</span> avec correction de continuité. Le premier se commande avec la fonction <code><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test()</a></code> et le second est la fonction par défaut de <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code>. Pour montrer l’équivalent entre la fonction <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code> et la fonction maison, l’option de correction est désactivée avec l’argument <code>correct = FALSE</code>.</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Table de contingence</span>
<span class="va">TC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">donnees</span><span class="op">)</span>
<span class="co"># Fonction maison</span>
<span class="fu">khicarre</span><span class="op">(</span><span class="va">TC</span><span class="op">)</span>
<span class="co">#&gt; $khi2</span>
<span class="co">#&gt; [1] 2.34</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $dl</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $valeur.p</span>
<span class="co">#&gt; [1] 0.126</span>

<span class="co"># Fonction de base</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">TC</span><span class="op">)</span>
<span class="co">#&gt; Number of cases in table: 100 </span>
<span class="co">#&gt; Number of factors: 2 </span>
<span class="co">#&gt; Test for independence of all factors:</span>
<span class="co">#&gt;  Chisq = 2.3, df = 1, p-value = 0.1</span>

<span class="co"># Autre fonction de base</span>
<span class="va">resultat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">TC</span>, correct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">resultat</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Pearson's Chi-squared test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  TC</span>
<span class="co">#&gt; X-squared = 2, df = 1, p-value = 0.1</span>

<span class="co"># Et pour plus de précision...</span>
<span class="va">resultat</span><span class="op">$</span><span class="va">statistic</span>
<span class="co">#&gt; X-squared </span>
<span class="co">#&gt;      2.34</span>
<span class="va">resultat</span><span class="op">$</span><span class="va">p.value</span>
<span class="co">#&gt; [1] 0.126</span>

<span class="co"># Le test exact de Fisher</span>
<span class="va">resultat.fisher</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">TC</span><span class="op">)</span>
<span class="va">resultat.fisher</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Fisher's Exact Test for Count Data</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  TC</span>
<span class="co">#&gt; p-value = 0.2</span>
<span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;   0.641 12.731</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; odds ratio </span>
<span class="co">#&gt;       2.61</span>
<span class="va">resultat.fisher</span><span class="op">$</span><span class="va">p.value</span>
<span class="co">#&gt; [1] 0.216</span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="inf%C3%A9rer.html"><span class="header-section-number">8</span> Inférer</a></div>
<div class="next"><a href="simuler.html"><span class="header-section-number">10</span> Simuler</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#analyser"><span class="header-section-number">9</span> Analyser</a></li>
<li>
<a class="nav-link" href="#les-diff%C3%A9rences-de-moyennes"><span class="header-section-number">9.1</span> Les différences de moyennes</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#test-t-ind%C3%A9pendant"><span class="header-section-number">9.1.1</span> Test-t indépendant</a></li>
<li><a class="nav-link" href="#test-t-d%C3%A9pendant"><span class="header-section-number">9.1.2</span> Test-t dépendant</a></li>
<li><a class="nav-link" href="#lanalyse-de-variance-%C3%A0-un-facteur"><span class="header-section-number">9.1.3</span> L’analyse de variance à un facteur</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#lassociation-lin%C3%A9aire"><span class="header-section-number">9.2</span> L’association linéaire</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#la-covariance"><span class="header-section-number">9.2.1</span> La covariance</a></li>
<li><a class="nav-link" href="#la-corr%C3%A9lation"><span class="header-section-number">9.2.2</span> La corrélation</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#les-donn%C3%A9es-nominales"><span class="header-section-number">9.3</span> Les données nominales</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#le-chi2-pour-table-de-contingence"><span class="header-section-number">9.3.1</span> Le \(\chi^2\) pour table de contingence</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/quantmeth/MQR/blob/master/09-Analyser.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/quantmeth/MQR/edit/master/09-Analyser.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Méthodes Quantitatives avec R</strong>" was written by P.-O. Caron. It was last built on 2022-05-24.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
