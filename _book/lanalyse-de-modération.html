<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 1 L’analyse de modération | Méthodes Quantitatives avec R</title>
<meta name="author" content="P.-O. Caron">
<meta name="description" content="L’analyse de modération1 est une analyse statistique très populaire dans laquelle la relation entre la variable dépendante (\(y\)) et la variable indépendante (\(x\)) est altérée par une tierce...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content=" 1 L’analyse de modération | Méthodes Quantitatives avec R">
<meta property="og:type" content="book">
<meta property="og:url" content="mqr.teluq.ca/lanalyse-de-modération.html">
<meta property="og:description" content="L’analyse de modération1 est une analyse statistique très populaire dans laquelle la relation entre la variable dépendante (\(y\)) et la variable indépendante (\(x\)) est altérée par une tierce...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 1 L’analyse de modération | Méthodes Quantitatives avec R">
<meta name="twitter:description" content="L’analyse de modération1 est une analyse statistique très populaire dans laquelle la relation entre la variable dépendante (\(y\)) et la variable indépendante (\(x\)) est altérée par une tierce...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
</head>
<body>
<p>
    \(
    \newcommand{\EX}{\mathbb{E}}
    \)
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style><style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style><link rel="stylesheet" href="bs4_style.css"></p>

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Méthodes Quantitatives avec R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bienvenue!</a></li>
<li><a class="" href="pr%C3%A9face.html">Préface</a></li>
<li><a class="active" href="lanalyse-de-mod%C3%A9ration.html"><span class="header-section-number">1</span> L’analyse de modération</a></li>
<li><a class="" href="r%C3%A9f%C3%A9rences.html">Références</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/quantmeth/MQR">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="lanalyse-de-modération" class="section level1" number="1">
<h1>
<span class="header-section-number"> 1</span> L’analyse de modération<a class="anchor" aria-label="anchor" href="#lanalyse-de-mod%C3%A9ration"><i class="fas fa-link"></i></a>
</h1>
<p>L’analyse de modération<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;La section est partiellement basée sur &lt;span class="citation"&gt;Caron et al. (&lt;a href="r%C3%A9f%C3%A9rences.html#ref-Caron20" role="doc-biblioref"&gt;2020&lt;/a&gt;)&lt;/span&gt;.&lt;/p&gt;'><sup>1</sup></a> est une analyse statistique très populaire dans laquelle la relation entre la variable dépendante (<span class="math inline">\(y\)</span>) et la variable indépendante (<span class="math inline">\(x\)</span>) est altérée par une tierce variable, la variable modératrice (<span class="math inline">\(w\)</span>). Aussi appelée modérateur, elle interagit de sorte à accentuer ou amenuiser la force, voire même la direction, de la relation entre <span class="math inline">\(x\)</span> et <span class="math inline">\(y\)</span>.</p>
<p>Bien que la modération ait son chapitre désigné, elle a déjà été rencontrée dans ce livre, notamment, dans les analyses de base (ANOVA) et la régression. L’analyse de modération dans son essence correspond à étudier un effet d’interaction dans un modèle linaire, ou autrement dit, la multiplication entre deux variables, ici <span class="math inline">\(x \times w\)</span>. Ainsi, en recourant aux fonctions <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> ou <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>, la modération se commande en employant le symbole <code>*</code> comme <code>lm(y ~ x * w)</code> ou <code>aov(y ~ x * w)</code>. Toutefois, ayant ses défis qui lui sont propres en création de données et en interprétation, le chapitre suivant propose une description de l’analyse de modération.</p>
<p>Sur le plan quantitatif, l’analyse de modération est un modèle linéaire général réalisé en une seule étape (soit une analyse de la variance ou une régression, en fonction des variables concernées) dans laquelle une
variable dépendante, <span class="math inline">\(y\)</span>, est prédite par trois variables, la variable
variable indépendante, <span class="math inline">\(x\)</span>, l’effet simple se la variable modératrice, <span class="math inline">\(w\)</span>, et leur produit <span class="math inline">\(x \times w=xw\)</span>. En termes d’analyse de la variance,
le produit <span class="math inline">\(xw\)</span> est une interaction. En d’autres termes, dans un le modèle linéaire général (ANOVA, régression), un modérateur se subsume à une interaction. Mathématiquement, la relation s’exprime comme l’équation <a href="lanalyse-de-mod%C3%A9ration.html#eq:moderation">(1.1)</a></p>
<p><span class="math display" id="eq:moderation">\[\begin{equation}
y = \beta_0 + \beta_1 x + \beta_2 w + \beta_3 (x \times w) + \epsilon_y
\tag{1.1}
\end{equation}\]</span></p>
<p>où les <span class="math inline">\(beta_i\)</span> sont les coefficients de régression reliant la variable correspondante à la variable dépendante.</p>
<p>L’analyse de modération est illustrée à la Figure <span class="math inline">\(\ref{mod}\)</span>. Le cadran a (gauche) montre une conceptualisation de l’effet attendu du modérateur, soit l’altération de l’effet entre <span class="math inline">\(x\)</span> et <span class="math inline">\(y\)</span>. Le cadran b (droite) montre, quant à lui, la représentation statistique dans laquelle le lien direct entre <span class="math inline">\(x\)</span>, <span class="math inline">\(w\)</span> et <span class="math inline">\(xw\)</span> par rapport à <span class="math inline">\(y\)</span>.</p>
<p>Une façon de mettre l’accent sur l’effet de modération est de réarranger l’équation <a href="lanalyse-de-mod%C3%A9ration.html#eq:moderation">(1.1)</a> afin d’obtenir l’équation <a href="lanalyse-de-mod%C3%A9ration.html#eq:moderation2">(1.2)</a>, ce qui met en évidence le rôle clé de <span class="math inline">\(w\)</span>.</p>
<p><span class="math display" id="eq:moderation2">\[\begin{equation}
y = \beta_0 + \beta_1 x + (\beta_2 + \beta_3 x) w + \epsilon_y
\tag{1.2}
\end{equation}\]</span></p>
<div id="création-de-données" class="section level2" number="1.1">
<h2>
<span class="header-section-number">1.1</span> Création de données<a class="anchor" aria-label="anchor" href="#cr%C3%A9ation-de-donn%C3%A9es"><i class="fas fa-link"></i></a>
</h2>
<p>Une caractéristique fondamentale de la création d’interactions est qu’elles doivent être créées à partir de ces composantes. Autrement dit, le produit <span class="math inline">\(xw\)</span> comme variable n’est calculable que si <span class="math inline">\(x\)</span> ou <span class="math inline">\(w\)</span> sont d’abord créées. Il faut connaître deux des trois variables pour calculer la troisième. En conséquence, il n’est pas possible de créer des variables d’interaction, comme c’était le cas auparavant avec la fonction <code>MASS::mvrnorn()</code>, malgré que la matrice de covariance et les coefficients de régression soient calculables.</p>
<p>La variance du produit de deux variables peut devenir fort complexe. En fait, l’étude des produits de variables est si complexe, particulièrement lorsque les variables ont des moyennes non nulles qu’il n’y a eu que très dernièrement des développements mathématiques sur leur distribution formelle <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-Cui" role="doc-biblioref">Cui et al., 2016</a>; <a href="r%C3%A9f%C3%A9rences.html#ref-Nadarajah" role="doc-biblioref">Nadarajah &amp; Pagány, 2016</a>)</span>, ce pourquoi les statisticiens préfèrent recourir à du bootstrap pour tester les effets médiateurs.</p>
<p>La variance du produit de deux variables standardisées <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-Craig" role="doc-biblioref">Craig, 1936</a>; <a href="r%C3%A9f%C3%A9rences.html#ref-Haldane" role="doc-biblioref">Haldane, 1942</a>)</span> est
<span class="math display" id="eq:varprod">\[\begin{equation}
\sigma^2_{x \times w} = 1 + \rho_{xw}^2
\tag{1.3}
\end{equation}\]</span></p>
<p>Pour des variables centrées (non complètement standardisées), l’équation <a href="lanalyse-de-mod%C3%A9ration.html#eq:prodvar">(1.4)</a> devient</p>
<!-- À terminer -->
<p><span class="math display" id="eq:prodvar">\[\begin{equation}
sigma^2_{x \times w}
\tag{1.4}
\end{equation}\]</span></p>
<p>Il faudra donc porter une attention particulière à la variance de <span class="math inline">\(xw\)</span> lorsque la variable <span class="math inline">\(y\)</span> sera générée, surtout si un scénario standardisé est envisagé.</p>
</div>
<div id="un-modérateur-continu" class="section level2" number="1.2">
<h2>
<span class="header-section-number">1.2</span> Un modérateur continu<a class="anchor" aria-label="anchor" href="#un-mod%C3%A9rateur-continu"><i class="fas fa-link"></i></a>
</h2>
<p>Dans le cas de deux variables continues (une variable indépendante <span class="math inline">\(x\)</span> et une modératrice <span class="math inline">\(w\)</span>), celles-ci peuvent être créées par système d’équations ou bien avec la matrice de covariance (des deux variables). Une fois <span class="math inline">\(x\)</span> et <span class="math inline">\(w\)</span> générées, il faut les multiplier pour obtenir <span class="math inline">\(xw\)</span>.</p>
<p>La variance de <span class="math inline">\(xw\)</span> suit l’équation <a href="lanalyse-de-mod%C3%A9ration.html#eq:prodvar">(1.4)</a> et les covariances avec les premières variables sont nulles dans la mesure où c’est variable dont symétrique. (Si elles ne sont pas symétriques, il pourrait y avoir des corrélations causées par l’asymétrie). La matrice de covariance (et de corrélation dans ce cas-ci) est ainsi calculable a priori.</p>
<p><span class="math display" id="eq:S1">\[\begin{equation}
\mathbf{S} =
\left( \begin{array}{ccc}
1 &amp; \rho_{xw} &amp; 0 \\
\rho_{xw} &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1+\rho_{xw}^2 \\
\end{array}
\right)
\tag{1.5}
\end{equation}\]</span></p>
<p>En spécifiant les coefficients de régression à l’avance avec <span class="math inline">\(\mathbf{B}\)</span>, la variance résiduelle de la variable dépendante peut être calculée comme
<span class="math display">\[
\sigma^2_{\epsilon_y} = 1 - \mathbf {B \Sigma B}
\]</span></p>
<p>afin d’assurer un scénario complètement standardisé.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span>  <span class="fl">500</span>                     <span class="co"># Tailles d'échantillon</span>
<span class="va">rhoxw</span>  <span class="op">&lt;-</span>  <span class="fl">.5</span>                 <span class="co"># Covariance entre x et y</span>
<span class="va">S</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">rhoxw</span>, <span class="fl">0</span>,   <span class="co"># Matrice de covariance a priori</span>
               <span class="va">rhoxw</span>, <span class="fl">1</span>, <span class="fl">0</span>,
               <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span> <span class="op">+</span> <span class="va">rhoxw</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,
             ncol <span class="op">=</span> <span class="fl">3</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>

<span class="va">B</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">0</span>, <span class="fl">.3</span><span class="op">)</span>             <span class="co"># Coefficients de régression</span>

<span class="co"># Création des deux premières variables</span>
<span class="va">X</span> <span class="op">&lt;-</span>  <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="va">S</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>

<span class="co"># Ajouter en joindant aux deux autres leur produit</span>
<span class="va">X</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">X</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">X</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>

<span class="co"># Calculer la variance résiduelle</span>
<span class="va">var_ey</span> <span class="op">&lt;-</span>  <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">B</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">S</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">B</span><span class="op">)</span>

<span class="co"># Création de la variable dépendante</span>
<span class="va">y</span> <span class="op">&lt;-</span>  <span class="va">X</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">B</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">var_ey</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Mettre le tout en commun</span>
<span class="va">jd1</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">X</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">jd1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"w"</span>, <span class="st">"xw"</span>, <span class="st">"y"</span><span class="op">)</span></code></pre></div>
<p>Le code ci-dessus montre un scénario standardisé (toutes les moyennes sont 0; toutes les variances égalent 1). Le modèle est illustré à la figure <span class="math inline">\(\ref{ex1mod}\)</span>.</p>
<p>Pour simuler une étude réelle, la variable d’interaction n’a pas à être enregistrée dans les deux jeux de données. Elle n’était nécessaire que pour la création de la variable dépendante.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Jeu de données final </span>
<span class="va">jd1</span> <span class="op">&lt;-</span>  <span class="va">jd1</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"w"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span></code></pre></div>
</div>
<div id="un-modérateur-nominale" class="section level2" number="1.3">
<h2>
<span class="header-section-number">1.3</span> Un modérateur nominale<a class="anchor" aria-label="anchor" href="#un-mod%C3%A9rateur-nominale"><i class="fas fa-link"></i></a>
</h2>
<p>Pour créer un jeu de données avec une variable indépendante continue et une variable modératrice nominale, la procédure sera similaire à celle de l’analyse de variance en combinaison avec la technique juste décrite.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">50015610</span><span class="op">)</span>  <span class="co"># Pour reproductibilité</span>
<span class="va">g1</span> <span class="op">&lt;-</span> <span class="fl">5000</span>      <span class="co"># Tailles des trois groupes</span>
<span class="va">g2</span> <span class="op">&lt;-</span> <span class="fl">5000</span>      <span class="co"># Ils pourraient être différents</span>
<span class="va">g3</span> <span class="op">&lt;-</span> <span class="fl">5000</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span>, <span class="va">g3</span><span class="op">)</span><span class="op">)</span> <span class="co"># Nombre total d'unités (somme de tous les groupes)</span>

<span class="co"># Création de variables</span>
<span class="co"># Variable continue</span>
<span class="va">x</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>  <span class="co"># Variable continue</span>
<span class="co"># Vecteur de groupe (facteur)</span>
<span class="va">w</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">g1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">g2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="va">g3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Vérifier que cette `dummy.coding()` se retrouve dans l'environnement</span>
<span class="co"># Voir analyse de base</span>
<span class="co"># Codage factice du groupement</span>
<span class="co"># Le troisième groupe est le référent</span>
<span class="va">W</span> <span class="op">&lt;-</span> <span class="fu">dummy.coding</span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">3</span><span class="op">]</span>

<span class="co"># Mettre tous les prédicteurs ensemble </span>
<span class="co"># pour le modèle linéaire sous forme de matrice</span>
<span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,
          w <span class="op">=</span> <span class="va">W</span>,
          xw <span class="op">=</span> <span class="va">x</span> <span class="op">*</span> <span class="va">W</span><span class="op">)</span></code></pre></div>
<p>En considérant <span class="math inline">\(p_i = \frac{g_i}{n}\)</span> comme la probabilité d’une unité d’être dans le groupe <span class="math inline">\(i\)</span>, la variance d’un groupe représenté par <span class="math inline">\(w_i\)</span> est de <span class="math inline">\(p_i(1-p_i)\)</span>, soit la variance d’une distribution binomiale pour une probabilité <span class="math inline">\(p\)</span>. La covariance avec un autre groupe <span class="math inline">\(j\)</span> est de <span class="math inline">\(-p_ip_h\)</span>, soit que la probabilité d’être dans un groupe est négativement liée à celle d’être dans un autre groupe. Enfin, la variance d’une interaction est de <span class="math inline">\(p_i\)</span>, car il s’agit du pourcentage de <span class="math inline">\(x\)</span> qui se retrouve dans l’interaction <span class="math inline">\(xw_i\)</span>. En conséquence, comme il s’agit de la même information (à cause du multiple de 1 de la variable <span class="math inline">\(w_i\)</span>, c’est-dire appartenir au groupe <span class="math inline">\(i\)</span>), cela mère une covariance accidentelle de <span class="math inline">\(p_i\)</span> entre <span class="math inline">\(x\)</span> et <span class="math inline">\(w_i\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">g1</span><span class="op">/</span><span class="va">n</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">g2</span><span class="op">/</span><span class="va">n</span>
<span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">p1</span>, <span class="va">p2</span>,
              <span class="fl">0</span>, <span class="va">p1</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p1</span><span class="op">)</span>, <span class="op">-</span><span class="va">p1</span><span class="op">*</span><span class="va">p2</span>, <span class="fl">0</span>, <span class="fl">0</span>,
              <span class="fl">0</span>, <span class="op">-</span><span class="va">p1</span><span class="op">*</span><span class="va">p2</span>, <span class="va">p2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p2</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0</span>,
              <span class="va">p1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">p1</span>, <span class="fl">0</span>,
              <span class="va">p2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">p2</span><span class="op">)</span>, 
            ncol <span class="op">=</span> <span class="fl">5</span>, nrow <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">S</span>
<span class="co">#&gt;       [,1]   [,2]   [,3]  [,4]  [,5]</span>
<span class="co">#&gt; [1,] 1.000  0.000  0.000 0.333 0.333</span>
<span class="co">#&gt; [2,] 0.000  0.222 -0.111 0.000 0.000</span>
<span class="co">#&gt; [3,] 0.000 -0.111  0.222 0.000 0.000</span>
<span class="co">#&gt; [4,] 0.333  0.000  0.000 0.333 0.000</span>
<span class="co">#&gt; [5,] 0.333  0.000  0.000 0.000 0.333</span>
<span class="co"># Vérifications</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>
<span class="co">#&gt;          x        1        2         1         2</span>
<span class="co">#&gt; x  0.97900 -0.00703 -0.00136  3.18e-01  3.21e-01</span>
<span class="co">#&gt; 1 -0.00703  0.22224 -0.11112 -6.21e-03  1.21e-03</span>
<span class="co">#&gt; 2 -0.00136 -0.11112  0.22224  3.10e-03 -2.43e-03</span>
<span class="co">#&gt; 1  0.31815 -0.00621  0.00310  3.18e-01 -3.39e-05</span>
<span class="co">#&gt; 2  0.32067  0.00121 -0.00243 -3.39e-05  3.21e-01</span></code></pre></div>
<p>Toutefois, il sera plus simple de standardiser <code>W</code> avant de créer les interactions, ce qui éliminera les covariances accidentelles.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Standardiser les codes factices</span>
<span class="va">W</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">W</span>, MARGIN <span class="op">=</span> <span class="fl">2</span>, FUN <span class="op">=</span> <span class="va">scale</span><span class="op">)</span>

<span class="co"># Mettre tous les prédicteurs ensemble </span>
<span class="co"># pour le modèle linéaire sous forme de matrice</span>
<span class="va">X2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,
           w <span class="op">=</span> <span class="va">W</span>,
           xw <span class="op">=</span> <span class="va">x</span><span class="op">*</span><span class="va">W</span><span class="op">)</span></code></pre></div>
<p>Alors la covariance entre <span class="math inline">\(w_i\)</span> et <span class="math inline">\(w_j\)</span> et la covariance entre <span class="math inline">\(xw_i\)</span> et <span class="math inline">\(xw_j\)</span> deviennent
<span class="math display">\[p_1 p_2 / \sqrt{p_1(1 - p_1) p_2 (1 - p_2)}\]</span>
soit leur covariance originale divisée par leur écart type. Tous les autres valeurs deviennent 1 dans le cas des variances et 0 pour les covariances.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rho</span> <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="va">p1</span> <span class="op">*</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">p1</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p1</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">p2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,
               <span class="fl">0</span>, <span class="fl">1</span>, <span class="va">rho</span>, <span class="fl">0</span>, <span class="fl">0</span>,
               <span class="fl">0</span>, <span class="va">rho</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>,
               <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">1</span>, <span class="va">rho</span>,
               <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">rho</span>, <span class="fl">1</span><span class="op">)</span>, 
             ncol <span class="op">=</span> <span class="fl">5</span>, nrow <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">S2</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span>
<span class="co">#&gt; [1,]    1  0.0  0.0  0.0  0.0</span>
<span class="co">#&gt; [2,]    0  1.0 -0.5  0.0  0.0</span>
<span class="co">#&gt; [3,]    0 -0.5  1.0  0.0  0.0</span>
<span class="co">#&gt; [4,]    0  0.0  0.0  1.0 -0.5</span>
<span class="co">#&gt; [5,]    0  0.0  0.0 -0.5  1.0</span>
<span class="co"># Vérifications</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">X2</span><span class="op">)</span>
<span class="co">#&gt;          x       1        2       1        2</span>
<span class="co">#&gt; x  0.97900 -0.0149 -0.00288 -0.0174 -0.01201</span>
<span class="co">#&gt; 1 -0.01492  1.0000 -0.50000 -0.0174  0.01601</span>
<span class="co">#&gt; 2 -0.00288 -0.5000  1.00000  0.0160 -0.00887</span>
<span class="co">#&gt; 1 -0.01736 -0.0174  0.01601  0.9666 -0.46885</span>
<span class="co">#&gt; 2 -0.01201  0.0160 -0.00887 -0.4689  0.97049</span></code></pre></div>
<p>Ajouter des corrélations entre une variable continue et les groupes sont possibles, mais déborde du cadre de ces textes et des connaissances détaillées jusqu’ici. Mais, c’est possible!</p>
<p>Maintenant, il reste à créer la variable dépendante. Pour ce faire, il faut spécifier cinq coefficients de régressions, car une variable continue, plus deux variables modératrices (facteur transformé en code factice), donnent deux variable d’interaction.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Les coefficients de régression</span>
<span class="va">B</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">.50</span>, <span class="op">-</span><span class="fl">.50</span><span class="op">)</span>

<span class="co"># La variance résiduelle</span>
<span class="co"># La deuxième matrice de covariance est utilisée</span>
<span class="va">var_ey</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">B</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">S2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">B</span>  

<span class="co"># Création de la variable dépendante</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">X2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">B</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">var_ey</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Pour simuler une étude réelle, les variables d’interactions et le codage factices peuvent être écartés dans le jeu de données. Ces variables n’étaient nécessaires que pour la création de la variable dépendante.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Jeu de données final </span>
<span class="va">jd2</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,
                   w <span class="op">=</span> <span class="va">w</span>,
                   y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></code></pre></div>
</div>
<div id="détecter-leffet-de-modération" class="section level2" number="1.4">
<h2>
<span class="header-section-number">1.4</span> Détecter l’effet de modération<a class="anchor" aria-label="anchor" href="#d%C3%A9tecter-leffet-de-mod%C3%A9ration"><i class="fas fa-link"></i></a>
</h2>
<p>Pour détecter les effets modérateurs, l’analyse de modèle linéaire par <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> et <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> joueront parfaitement le rôle. Par contre, il faut noter une différence importante entre les deux fonctions. Le calcul de la somme des carrés est différent entre les deux : <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> utilise le type III et <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> utilise le type I.</p>
<p>Le type III est l’approche par défaut de la plupart des logiciels traditionnels. Il est souvent possible de déterminer ce choix, bien que peu d’expérimentateurs s’en donnent la peine. Le type II et le type IV (le plus souvent identique au type III) existent également. Il s’agit d’un débat controversé parmi les statisticiens.</p>
<p>Pour choisir le meilleur type d’estimateur, de nombreux facteurs entrent en ligne de compte, le plus important étant l’hypothèse de recherche. Il n’y a donc pas de réponse claire, il y a bien quelques recommandations.</p>
<p>Le type I ou III testent le terme d’interaction. Le type I teste séquentiellement le modèle <span class="math inline">\(y = x + w + xw\)</span>, soit d’avos l’effet de <span class="math inline">\(x\)</span>, puis l’effet de <span class="math inline">\(w\)</span> en tenant compte de <span class="math inline">\(x\)</span> (écrit <span class="math inline">\(\text{SC}(w|x)\)</span>, soit la somme des carrés de <span class="math inline">\(w\)</span> considérant <span class="math inline">\(x\)</span>, et enfin l’effet de <span class="math inline">\(x\times w\)</span> par <span class="math inline">\(\text{SC}(xw|x,w)\)</span>. Cela teste très bien l’effet d’interaction, mais les effets simples ne sont pas traités également.</p>
<p>Le type II contourne ce problème en considérant simultanément <span class="math inline">\(\text{SC}(w|x)\)</span> et <span class="math inline">\(\text{SC}(x|w)\)</span>, ce qui est très bien pour tester les effets simples s’il n’y a pas de terme d’interaction. Ainsi, le type II n’est utilisé que s’il n’y pas de terme d’interaction.</p>
<p>Dans le type III <span class="math inline">\(x\)</span>, <span class="math inline">\(w\)</span> et <span class="math inline">\(xw\)</span> ont le même niveau de conditionnement, soit <span class="math inline">\(\text{SC}(x|w,xw)\)</span>, <span class="math inline">\(\text{SC}(w|x,xw)\)</span> et <span class="math inline">\(\text{SC}(xw|x,w)\)</span>, là où le débat naît étant donné les hypothèses concernées ne semblent pas très utiles comme la plupart des expérimentateurs s’intéressent au terme d’interaction, et non aux effets principaux lorsqu’un terme d’interaction est présent. Les programmeurs de <strong>R</strong> championnent cette perspective en définissant l’option de type de sommes de carrés par défaut pour les fonctions <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> et <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>.</p>
<p>Le choix entre <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> (type I) ou <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> (type III) revient à l’expérimentateur. Par contre, la plupart des ouvrages statistiques pour les sciences appliquées recommandent le type III. Les ouvrages de méthodes quantitatives utilisent implicitement le type III. En plus, lorsque le devis n’est pas balancé, le type III est préférable. En fait, si le lecteur veut comparer avec des analyses de modération de d’autres ouvrages, il devra user du type III.</p>
<p>Cela dit, il demeure possible d’utiliser <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> avec les SC de type III, mais il faudra recourir à la fonction <code>Anova()</code> du package <code>car</code> <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-car" role="doc-biblioref">Fox &amp; Weisberg, 2019</a>)</span>.</p>
</div>
<div id="analyse-dun-modérateur-continu" class="section level2" number="1.5">
<h2>
<span class="header-section-number">1.5</span> Analyse d’un modérateur continu<a class="anchor" aria-label="anchor" href="#analyse-dun-mod%C3%A9rateur-continu"><i class="fas fa-link"></i></a>
</h2>
<p>Pour le modèle avec deux variables continues, voici la syntaxe pour rouler <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> qui est très similaire à ce qui se trouve dans le chapitre sur la régression. Pour inclure l’effet d’interaction (modération) dans le modèle, il faut inscrire le <code>*</code> au lieu du <code>+</code>, comme <code>lm(y ~ x * w, data = jd1)</code>. La formule <code>y ~ x + w + x * w</code> fonctionne également.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Réaliser l'analyse avec lm()</span>
<span class="va">res1.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">*</span> <span class="va">w</span>, data <span class="op">=</span> <span class="va">jd1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res1.lm</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = y ~ x * w, data = jd1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -2.7740 -0.6245  0.0226  0.6300  2.8553 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)  0.00333    0.04325    0.08    0.939    </span>
<span class="co">#&gt; x            0.10845    0.04785    2.27    0.024 *  </span>
<span class="co">#&gt; w           -0.02717    0.04525   -0.60    0.549    </span>
<span class="co">#&gt; x:w          0.30368    0.03374    9.00   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  </span>
<span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.884 on 496 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.151,  Adjusted R-squared:  0.146 </span>
<span class="co">#&gt; F-statistic: 29.4 on 3 and 496 DF,  p-value: &lt;2e-16</span>

<span class="co"># Pour comparer avec aov</span>
<span class="va">res1.aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">*</span> <span class="va">w</span>, data <span class="op">=</span> <span class="va">jd1</span>, contrasts <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Warning in model.matrix.default(mt, mf, contrasts): non-list</span>
<span class="co">#&gt; contrasts argument ignored</span>
<span class="co"># L'intercepte est inclu</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res1.aov</span>, intercept <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;              Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span>
<span class="co">#&gt; (Intercept)   1     13    12.8   16.35 6.1e-05 ***</span>
<span class="co">#&gt; x             1      5     5.2    6.60    0.01 *  </span>
<span class="co">#&gt; w             1      0     0.5    0.58    0.45    </span>
<span class="co">#&gt; x:w           1     63    63.4   81.03 &lt; 2e-16 ***</span>
<span class="co">#&gt; Residuals   496    388     0.8                    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  </span>
<span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Comme prévu, les résultats sont différents à cause du calcul de la somme des carrés qui est différente. L’effet modérateur est identique, cela dit, ce sont les effets principaux qui sont différents.</p>
<p>Pour obtenir l’analyse de variance avec le type III, il faut utiliser le package <code>car</code> et sa fonction <code>Anova()</code> en y spécifiant la sortie de la fonction <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> et type de somme de carrés demandée.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res1.anova</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">res1.aov</span>, type <span class="op">=</span> <span class="st">"III"</span><span class="op">)</span>
<span class="va">res1.anova</span> 
<span class="co">#&gt; Anova Table (Type III tests)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: y</span>
<span class="co">#&gt;             Sum Sq  Df F value Pr(&gt;F)    </span>
<span class="co">#&gt; (Intercept)      0   1    0.01  0.939    </span>
<span class="co">#&gt; x                4   1    5.14  0.024 *  </span>
<span class="co">#&gt; w                0   1    0.36  0.549    </span>
<span class="co">#&gt; x:w             63   1   81.03 &lt;2e-16 ***</span>
<span class="co">#&gt; Residuals      388 496                   </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  </span>
<span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Voilà, les effets simples sont maintenant identiques à la sortie de <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.</p>
<p>Pour déterminer s’il y a présence de l’effet de modérateur, il faut se fier à la ligne <code>x:w</code> et la valeur-<span class="math inline">\(p\)</span> <code>Pr(&gt;F)</code> associé qui est ici de 4.752^{-18}. Par contre, il n’est pas tout à fait clair comment interpréter ce résultat. Ce sera fait dans la section portant sur la représentation graphique de al modération.</p>
</div>
<div id="analyse-dun-modérateur-nominal" class="section level2" number="1.6">
<h2>
<span class="header-section-number">1.6</span> Analyse d’un modérateur nominal<a class="anchor" aria-label="anchor" href="#analyse-dun-mod%C3%A9rateur-nominal"><i class="fas fa-link"></i></a>
</h2>
<p>Comme il y a un groupe de référence, <strong>R</strong> choisit par défaut le premier groupe. Dans ce cas, le groupe de référence était le troisième. Pour spécifier ce changement, la fonction <code><a href="https://rdrr.io/r/stats/relevel.html">relevel()</a></code> déclarera le groupe de référence. Le premier argument est la variable et l’argument <code>ref =</code> indique le nouveau groupe de référence. La fonction ne fait que reclasser les valeurs afin que le premier groupe que ne voit <strong>R</strong> ne soit nul autre que le groupe de référence. Ce changement pourrait aussi être fait directement dans le formule de <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> comme <code>lm(y ~ x * relevel(w, ref = 3), data = jd2)</code></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Réaliser l'analyse avec lm()</span>
<span class="va">jd2</span><span class="op">$</span><span class="va">w</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">jd2</span><span class="op">$</span><span class="va">w</span>, ref <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">res2.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">*</span> <span class="va">w</span>, data <span class="op">=</span> <span class="va">jd2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res2.lm</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = y ~ x * w, data = jd2)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;    Min     1Q Median     3Q    Max </span>
<span class="co">#&gt; -1.690 -0.295 -0.002  0.297  1.574 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)  0.000209   0.006202    0.03     0.97    </span>
<span class="co">#&gt; x            0.259007   0.006139   42.19   &lt;2e-16 ***</span>
<span class="co">#&gt; w1           0.009207   0.008771    1.05     0.29    </span>
<span class="co">#&gt; w2          -0.005281   0.008770   -0.60     0.55    </span>
<span class="co">#&gt; x:w1         1.055880   0.008832  119.55   &lt;2e-16 ***</span>
<span class="co">#&gt; x:w2        -1.069859   0.008813 -121.40   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  </span>
<span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.438 on 14994 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.803,  Adjusted R-squared:  0.803 </span>
<span class="co">#&gt; F-statistic: 1.22e+04 on 5 and 14994 DF,  p-value: &lt;2e-16</span>

<span class="co"># Pour comparer avec aov</span>
<span class="va">res2.aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">*</span> <span class="va">w</span>, data <span class="op">=</span> <span class="va">jd2</span><span class="op">)</span>
<span class="co"># L'intercept est inclu</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">res2.aov</span><span class="op">)</span>
<span class="co">#&gt;                Df Sum Sq Mean Sq  F value Pr(&gt;F)    </span>
<span class="co">#&gt; x               1    930     930  4837.35 &lt;2e-16 ***</span>
<span class="co">#&gt; w               2      2       1     5.13 0.0059 ** </span>
<span class="co">#&gt; x:w             2  10821    5411 28144.98 &lt;2e-16 ***</span>
<span class="co">#&gt; Residuals   14994   2882       0                    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  </span>
<span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Somme de carrés de type III pour `aov()`</span>
<span class="va">res2.anova</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html">Anova</a></span><span class="op">(</span><span class="va">res2.aov</span>, type <span class="op">=</span> <span class="st">"III"</span><span class="op">)</span>
<span class="va">res2.anova</span> 
<span class="co">#&gt; Anova Table (Type III tests)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Response: y</span>
<span class="co">#&gt;             Sum Sq    Df F value Pr(&gt;F)    </span>
<span class="co">#&gt; (Intercept)      0     1     0.0   0.97    </span>
<span class="co">#&gt; x              342     1  1779.8 &lt;2e-16 ***</span>
<span class="co">#&gt; w                1     2     1.4   0.25    </span>
<span class="co">#&gt; x:w          10821     2 28145.0 &lt;2e-16 ***</span>
<span class="co">#&gt; Residuals     2882 14994                   </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  </span>
<span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>La fonction <code><a href="https://rdrr.io/pkg/car/man/Anova.html">car::Anova()</a></code> offre un résultat différent pour <span class="math inline">\(w\)</span> et <span class="math inline">\(xw\)</span> car les groupes sont mis en commun. Autrement dit, le vecteur de groupement est analysé comme une seule variable.</p>
<p>Le type III a certainement eu un rôle intéressant dans les résultats. Il montre que <span class="math inline">\(w\)</span> n’est pas significativement lié à <span class="math inline">\(y\)</span>, <span class="math inline">\(p &lt; 0.247\)</span>, ce qui était programmé dans le modèle alors que <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> montre un lien significatif, $p&lt;0.006.</p>
<p>Pour respecter la pratique et pour imiter ce qui est fait par d’autres logiciels ce serait l’effet d’interaction <code>x:w</code> tel que rapporté par <code>res2.anova</code>, soit produite par <code><a href="https://rdrr.io/pkg/car/man/Anova.html">car::Anova()</a></code>. La valeur-<span class="math inline">\(p\)</span> de l’effet d’interaction est de <span class="math inline">\(p&lt;001\)</span>, ce qui signifie qu’il y a un effet modérateur.</p>
<p>Comme le cas précédent, ce résultat est ardu à interpréter.</p>
</div>
<div id="les-graphiques-liés-à-lanalyse-de-modération" class="section level2" number="1.7">
<h2>
<span class="header-section-number">1.7</span> Les graphiques liés à l’analyse de modération<a class="anchor" aria-label="anchor" href="#les-graphiques-li%C3%A9s-%C3%A0-lanalyse-de-mod%C3%A9ration"><i class="fas fa-link"></i></a>
</h2>
<p>À part quelques personnes ayant l’oeil affutée à l’interprétation de modèle linéaire contenant une interaction, il est rare pour tous les autres d’en tirer du sens immédiatement. Ainsi, des analyses graphiques sont plus que pertinentes pour en interpréter les résultats.</p>
<p>Deux graphiques sont particulièrement pertinents : le graphique de Johnson- Neyman et le graphique des pentes simples (<em>simple slopes</em>). Il existe quelques packages pour produire ces graphiques. Dans cet ouvrage, le package <code>interactions</code> <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-interactions" role="doc-biblioref">Long, 2019</a>)</span> sera présenté. Ce package peut traiter des interactions doubles et triples et est compatible avec plusieurs commandes de <code>ggplot2</code>.</p>
<p>Pour réaliser ces graphiques, il faudra d’abord installer et importer le package.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://interactions.jacob-long.com">interactions</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="lanalyse-des-pentes-simples" class="section level2" number="1.8">
<h2>
<span class="header-section-number">1.8</span> L’analyse des pentes simples<a class="anchor" aria-label="anchor" href="#lanalyse-des-pentes-simples"><i class="fas fa-link"></i></a>
</h2>
<p>La méthode <em>classique</em> de sonder d’approfondir un effet d’interaction consiste à calculer la pente du prédicteur à différentes valeurs du modérateur. Cette analyse se réfère à l’analyse des pentes simples. La fonction qui permet de commander cette technique est <code><a href="https://interactions.jacob-long.com/reference/sim_slopes.html">sim_slopes()</a></code>. Il faut y mettre en argument, la sortie de <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> et désigner le prédicteur <code>pred =</code> et le modérateur <code>modx =</code>. Cette analyse est faite avec l’exemple avec la variable de groupement, <code>jd2</code>. L’argument <code>johnson_neyman = FALSE</code> évite simplement un message d’erreur, car le graphique éponyme ne peut être généré lorsque le modérateur est une variable de groupement.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Les statistiques liées aux pentes simples</span>
<span class="fu"><a href="https://interactions.jacob-long.com/reference/sim_slopes.html">sim_slopes</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">res2.lm</span>,
           pred <span class="op">=</span> <span class="va">x</span>,
           modx <span class="op">=</span> <span class="va">w</span>,
           johnson_neyman <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; SIMPLE SLOPES ANALYSIS </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slope of x when w = 2: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    Est.   S.E.    t val.      p</span>
<span class="co">#&gt; ------- ------ --------- ------</span>
<span class="co">#&gt;   -0.81   0.01   -128.25   0.00</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slope of x when w = 1: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Est.   S.E.   t val.      p</span>
<span class="co">#&gt; ------ ------ -------- ------</span>
<span class="co">#&gt;   1.31   0.01   207.10   0.00</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slope of x when w = 3: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Est.   S.E.   t val.      p</span>
<span class="co">#&gt; ------ ------ -------- ------</span>
<span class="co">#&gt;   0.26   0.01    42.19   0.00</span></code></pre></div>
<p>Ce tableau pour les groupes de <span class="math inline">\(w\)</span> si l’effet modérateur est significatif.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Le graphique des pentes simples</span>
<span class="fu"><a href="https://interactions.jacob-long.com/reference/interact_plot.html">interact_plot</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">res2.lm</span>,
           pred <span class="op">=</span> <span class="va">x</span>,
           modx <span class="op">=</span> <span class="va">w</span>, 
           plot.points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ip1"></span>
<img src="13-Moderation_files/figure-html/ip1-1.png" alt="Analyse de pentes simples pour un modérateur nominal" width="672"><p class="caption">
Figure 1.1: Analyse de pentes simples pour un modérateur nominal
</p>
</div>
<p>Le code ci-dessus illustre ce patron de différences avec la Figure <a href="lanalyse-de-mod%C3%A9ration.html#fig:ip1">1.1</a>. L’axe des <span class="math inline">\(x\)</span> et des <span class="math inline">\(y\)</span> montrent la relation entre les variables en fonction des groupes qui sont représentées par des lignes différentes. L’option <code>plot.point = TRUE</code> affiche optionnellement les données dans la figure. La Figure <a href="lanalyse-de-mod%C3%A9ration.html#fig:ip1">1.1</a> montre une tendance positive entre <span class="math inline">\(x\)</span> et <span class="math inline">\(y\)</span> pour le groupe de référence (<code>3</code>) qui s’accentue de façon importante pour le groupe (<code>1</code>), mais qui s’inverse pour le groupe <code>2</code>.</p>
<p>Le graphique des pentes peut aussi être réalisé pour un modérateur continu. La Figure <a href="lanalyse-de-mod%C3%A9ration.html#fig:ip2">1.2</a> illustre ce graphique. Lorsque le modérateur représentait des groupes, les niveaux étaient clairement définis. Dans le cas d’un modérateur continu, des niveaux arbitraire doivent être sélectionner.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://interactions.jacob-long.com/reference/interact_plot.html">interact_plot</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">res1.lm</span>,
           pred <span class="op">=</span> <span class="va">x</span>,
           modx <span class="op">=</span> <span class="va">w</span>, 
           plot.points <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ip2"></span>
<img src="13-Moderation_files/figure-html/ip2-1.png" alt="Analyses des pentes simples pour un modérateur continu" width="672"><p class="caption">
Figure 1.2: Analyses des pentes simples pour un modérateur continu
</p>
</div>
<p>Par défaut, l’analyse est réalisée avec -1 écart type, la moyenne et +1 écart type comme groupement de <span class="math inline">\(w\)</span>. Ces valeurs peuvent être choisies manuellement avec <code>modx.values =</code> en y spécifiant les valeurs d’intérêt. En plus, cet argument est compatible non seulement avec <code><a href="https://interactions.jacob-long.com/reference/interact_plot.html">interact_plot()</a></code> et <code><a href="https://interactions.jacob-long.com/reference/sim_slopes.html">sim_slopes()</a></code>. La Figure <a href="lanalyse-de-mod%C3%A9ration.html#fig:ip3">1.3</a> montre l’analyse des pentes pour des valeurs de <code>modx.values = c(-2, -1, 0, 1, 2)</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://interactions.jacob-long.com/reference/interact_plot.html">interact_plot</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">res1.lm</span>,
           pred <span class="op">=</span> <span class="va">x</span>,
           modx <span class="op">=</span> <span class="va">w</span>, 
           plot.points <span class="op">=</span> <span class="cn">TRUE</span>,
           modx.values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ip3"></span>
<img src="13-Moderation_files/figure-html/ip3-1.png" alt="Analyses des pentes simples pour un modérateur continu" width="672"><p class="caption">
Figure 1.3: Analyses des pentes simples pour un modérateur continu
</p>
</div>
</div>
<div id="le-graphique-de-johnson-neyman" class="section level2" number="1.9">
<h2>
<span class="header-section-number">1.9</span> Le graphique de Johnson-Neyman<a class="anchor" aria-label="anchor" href="#le-graphique-de-johnson-neyman"><i class="fas fa-link"></i></a>
</h2>
<p>Lorsque le modérateur est continu, la méthode la plus rigoureuse d’explorer des effets modérateurs est de calculer l’intervalle de Johnson-Neyman qui indique la plage de valeurs du modérateur selon lesquelles la pente du prédicteur est significative ou non pour un seuil <span class="math inline">\(\alpha\)</span> spécifié. Comme les deux variables doivent être continues, c’est le jeu de données <code>jd1</code> qui sera utilisé pour cet exemple.</p>
<p>La fonction <code><a href="https://interactions.jacob-long.com/reference/sim_slopes.html">sim_slopes()</a></code> génère l’analyse des pentes simples, mais produit également l’intervalle de Johnson-Neyman et le graphique associé. La fonction est utilisée comme précédemment, à l’exception qu’il est possible de demander comme argument <code>jnplot = TRUE</code> pour obtenir le graphique Johnson-Neyman et qu’il n’est plus nécessaire de commander <code>johnson_neyman = FALSE</code> évite un message d’erreur.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://interactions.jacob-long.com/reference/sim_slopes.html">sim_slopes</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">res1.lm</span>,
           pred <span class="op">=</span> <span class="va">x</span>,
           modx <span class="op">=</span> <span class="va">w</span>, 
           jnplot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; JOHNSON-NEYMAN INTERVAL </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; When w is OUTSIDE the interval [-0.71, -0.05], the slope</span>
<span class="co">#&gt; of x is p &lt; .05.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Note: The range of observed values of w is [-3.21, 3.21]</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:jn1"></span>
<img src="13-Moderation_files/figure-html/jn1-1.png" alt="Le graphiqu Johnson-Neyman pour interpréter les effets modérateurs" width="672"><p class="caption">
Figure 1.4: Le graphiqu Johnson-Neyman pour interpréter les effets modérateurs
</p>
</div>
<pre><code>#&gt; SIMPLE SLOPES ANALYSIS 
#&gt; 
#&gt; Slope of x when w = -1.0052 (- 1 SD): 
#&gt; 
#&gt;    Est.   S.E.   t val.      p
#&gt; ------- ------ -------- ------
#&gt;   -0.20   0.06    -3.30   0.00
#&gt; 
#&gt; Slope of x when w =  0.0202 (Mean): 
#&gt; 
#&gt;   Est.   S.E.   t val.      p
#&gt; ------ ------ -------- ------
#&gt;   0.11   0.05     2.40   0.02
#&gt; 
#&gt; Slope of x when w =  1.0456 (+ 1 SD): 
#&gt; 
#&gt;   Est.   S.E.   t val.      p
#&gt; ------ ------ -------- ------
#&gt;   0.43   0.06     7.29   0.00</code></pre>
<p>La Figure <a href="lanalyse-de-mod%C3%A9ration.html#fig:jn1">1.4</a> montre le graphique Johnson-Neyman. La zone bleue indique le niveau de modérateur où l’effet de <span class="math inline">\(x\)</span> est significativement différent de la pente de <span class="math inline">\(x\)</span> lorsque l’effet du modérateur est nul. La zone rouge montre l’étendue où il n’y a pas d’effet de modération. L’étendue est également précisée dans la première phrase imprimée de la sortie. La sortie a également produit la sortie de l’analyse de pentes simples ou l’information obtenue du graphique Johnson-Neyman est répétée d’une façon différente.</p>
<p>Dans cet exemple, plus l’unité à un niveau de modérateur élevé (en termes absolus), plus il accentue l’effet de la variable indépendante (zones bleues). Lae modérateur joue donc un rôle très important dans ce modèle.</p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="pr%C3%A9face.html">Préface</a></div>
<div class="next"><a href="r%C3%A9f%C3%A9rences.html">Références</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#lanalyse-de-mod%C3%A9ration"><span class="header-section-number">1</span> L’analyse de modération</a></li>
<li><a class="nav-link" href="#cr%C3%A9ation-de-donn%C3%A9es"><span class="header-section-number">1.1</span> Création de données</a></li>
<li><a class="nav-link" href="#un-mod%C3%A9rateur-continu"><span class="header-section-number">1.2</span> Un modérateur continu</a></li>
<li><a class="nav-link" href="#un-mod%C3%A9rateur-nominale"><span class="header-section-number">1.3</span> Un modérateur nominale</a></li>
<li><a class="nav-link" href="#d%C3%A9tecter-leffet-de-mod%C3%A9ration"><span class="header-section-number">1.4</span> Détecter l’effet de modération</a></li>
<li><a class="nav-link" href="#analyse-dun-mod%C3%A9rateur-continu"><span class="header-section-number">1.5</span> Analyse d’un modérateur continu</a></li>
<li><a class="nav-link" href="#analyse-dun-mod%C3%A9rateur-nominal"><span class="header-section-number">1.6</span> Analyse d’un modérateur nominal</a></li>
<li><a class="nav-link" href="#les-graphiques-li%C3%A9s-%C3%A0-lanalyse-de-mod%C3%A9ration"><span class="header-section-number">1.7</span> Les graphiques liés à l’analyse de modération</a></li>
<li><a class="nav-link" href="#lanalyse-des-pentes-simples"><span class="header-section-number">1.8</span> L’analyse des pentes simples</a></li>
<li><a class="nav-link" href="#le-graphique-de-johnson-neyman"><span class="header-section-number">1.9</span> Le graphique de Johnson-Neyman</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/quantmeth/MQR/blob/master/13-Moderation.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/quantmeth/MQR/edit/master/13-Moderation.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Méthodes Quantitatives avec R</strong>" was written by P.-O. Caron. It was last built on 2022-05-20.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
