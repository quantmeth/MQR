<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 19 Explorer | Méthodes quantitatives avec R</title>
<meta name="author" content="P.-O. Caron">
<meta name="description" content="Comme il a été vu, l’analyse en composantes principales (ACP) fait partie de la famille des analyses factorielles exploratoires. Elle est exploratoire, car les loadings sont complètement libres....">
<meta name="generator" content="bookdown 0.31 with bs4_book()">
<meta property="og:title" content=" 19 Explorer | Méthodes quantitatives avec R">
<meta property="og:type" content="book">
<meta property="og:url" content="mqr.teluq.ca/explorer.html">
<meta property="og:description" content="Comme il a été vu, l’analyse en composantes principales (ACP) fait partie de la famille des analyses factorielles exploratoires. Elle est exploratoire, car les loadings sont complètement libres....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 19 Explorer | Méthodes quantitatives avec R">
<meta name="twitter:description" content="Comme il a été vu, l’analyse en composantes principales (ACP) fait partie de la famille des analyses factorielles exploratoires. Elle est exploratoire, car les loadings sont complètement libres....">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- 
    \(
    \newcommand{\EX}{\mathbb{E}}
    \)
    --><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Méthodes quantitatives avec R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bienvenue!</a></li>
<li><a class="" href="pr%C3%A9face.html">Préface</a></li>
<li class="book-part">Rudiments</li>
<li><a class="" href="commencer.html"><span class="header-section-number">1</span> Commencer</a></li>
<li><a class="" href="programmer.html"><span class="header-section-number">2</span> Programmer</a></li>
<li><a class="" href="calculer.html"><span class="header-section-number">3</span> Calculer</a></li>
<li><a class="" href="r%C3%A9diger.html"><span class="header-section-number">4</span> Rédiger</a></li>
<li><a class="" href="exercice-rudiments.html">Exercices</a></li>
<li class="book-part">Jeux de données</li>
<li><a class="" href="entrer.html"><span class="header-section-number">5</span> Entrer</a></li>
<li><a class="" href="importer.html"><span class="header-section-number">6</span> Importer</a></li>
<li><a class="" href="manipuler.html"><span class="header-section-number">7</span> Manipuler</a></li>
<li><a class="" href="visualiser.html"><span class="header-section-number">8</span> Visualiser</a></li>
<li><a class="" href="exercice-gestion.html">Exercices</a></li>
<li class="book-part">Statistiques</li>
<li><a class="" href="d%C3%A9crire.html"><span class="header-section-number">9</span> Décrire</a></li>
<li><a class="" href="inf%C3%A9rer.html"><span class="header-section-number">10</span> Inférer</a></li>
<li><a class="" href="analyser.html"><span class="header-section-number">11</span> Analyser</a></li>
<li><a class="" href="simuler.html"><span class="header-section-number">12</span> Simuler</a></li>
<li><a class="" href="exercice-analyse.html">Exercices</a></li>
<li class="book-part">Modèles linéaires</li>
<li><a class="" href="comparer.html"><span class="header-section-number">13</span> Comparer</a></li>
<li><a class="" href="pr%C3%A9dire.html"><span class="header-section-number">14</span> Prédire</a></li>
<li><a class="" href="cr%C3%A9er.html"><span class="header-section-number">15</span> Créer</a></li>
<li><a class="" href="m%C3%A9dier.html"><span class="header-section-number">16</span> Médier</a></li>
<li><a class="" href="mod%C3%A9rer.html"><span class="header-section-number">17</span> Modérer</a></li>
<li><a class="" href="exercice-lineaire.html">Exercices</a></li>
<li class="book-part">Analyses factorielles</li>
<li><a class="" href="d%C3%A9composer.html"><span class="header-section-number">18</span> Décomposer</a></li>
<li><a class="active" href="explorer.html"><span class="header-section-number">19</span> Explorer</a></li>
<li><a class="" href="r%C3%A9duire.html"><span class="header-section-number">20</span> Réduire</a></li>
<li class="book-part">Annexes</li>
<li><a class="" href="solutions.html">Solutions</a></li>
<li><a class="" href="r%C3%A9f%C3%A9rences.html">Références</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/quantmeth/MQR">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="explorer" class="section level1" number="19">
<h1>
<span class="header-section-number"> 19</span> Explorer<a class="anchor" aria-label="anchor" href="#explorer"><i class="fas fa-link"></i></a>
</h1>
<p>Comme il a été vu, <a href="explorer.html#lanalyse-en-composantes-principales-1">l’analyse en composantes principales</a> (ACP) fait partie de la famille des <strong>analyses factorielles exploratoires</strong>. Elle est <strong>exploratoire</strong>, car les loadings sont complètement libres. De plus, l’ACP n’impose pas de structure sur les données. Elle réorganise les variables corrélées (une matrice de covariance) en nouvelles variables orthogonales (décorrélées) les unes des autres (composantes). L’ACP n’informe pas du nombre de composantes <em>signifiantes</em> (importantes) dans le jeu de données. S’il y a <span class="math inline">\(p\)</span> variables, elle réorganise la variance en <span class="math inline">\(p\)</span> dimensions. Cependant, le statisticien opportuniste sait que l’information pertinente se trouve dans <a href="d%C3%A9composer.html#les-valeurs-propres">les valeurs propres</a> les plus élevées et peut les utiliser pour résumer les données.</p>
<p>Le statisticien peut toutefois tenter d’isoler la structure factorielle sous-jacente aux données. Plutôt que de réorganiser la matrice de corrélation par une rotation géométrique, il peut tenter d’extraire des facteurs latents de cette matrice. Cette technique se nomme l’<strong>analyse factorielle exploratoire</strong>. Elle impose une structure aux données, soit un nombre de facteurs, mais demeure exploratoire, car les loadings restent libres.</p>
<p>À ce stade, il est intéressant de se pencher sur ce qu’est la structure factorielle sous-jacente à la matrice de corrélation avant d’expliquer l’analyse qui permet de la retrouver. La création de données aidera à en mieux comprendre les tenants et aboutissants.</p>
<div id="création-de-données-2" class="section level2" number="19.1">
<h2>
<span class="header-section-number">19.1</span> Création de données<a class="anchor" aria-label="anchor" href="#cr%C3%A9ation-de-donn%C3%A9es-2"><i class="fas fa-link"></i></a>
</h2>
<p>Pour construire un jeu de données ayant une structure factorielle, il faut d’abord concevoir cette structure. Il s’agit <a href="d%C3%A9composer.html#les-loadings">des loadings</a> des facteurs<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Ne pas se tromper avec les vecteurs propres&lt;/p&gt;"><sup>36</sup></a>. Il s’agit d’une matrice <span class="math inline">\(k \times p\)</span>, c’est-à-dire nombre de facteurs par nombre de variables.</p>
<p>Il est plus simple de considérer pour l’instant une structure standardisée, c’est-à-dire que les variables produites auront des variances de 1 (les moyennes sont écartées, car elles ne sont pas nécessaires). Lors de la spécification de la structure factorielle, il faut s’assurer que la somme des carrés des loadings de chaque variable ne dépasse pas <span class="math inline">\(1\)</span>, soit la variance désirée des variables. Ne pas respecter cette limite ne crée pas forcément une erreur. Seulement, le scénario ne sera plus standardisé.</p>
<p>La Figure <a href="explorer.html#fig:FactStruct">19.1</a> illustre un exemple de modèle. Les rectangles sont des variables manifestes (observées) à partir desquelles les variables encerclées représentent des facteurs sous-jacents, soit des variables latentes (retrouvées à partir des variables manifestes).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:FactStruct"></span>
<img src="image/factstruct.png" alt="Structure factorielle" width="50%" height="50%"><p class="caption">
Figure 19.1: Structure factorielle
</p>
</div>
<p>La syntaxe ci-dessous reconstruit le modèle de la Figure <a href="explorer.html#fig:FactStruct">19.1</a>. La variable <code>phi</code>, pour <span class="math inline">\(\Phi\)</span>, contient les loadings des deux composantes pour créer les six variables. Les lignes (les variables) sont identifiées par <code>i</code> et les colonnes (les facteurs) sont identifiées par <code>F</code>.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="explorer.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la matrice de recette de fabrication</span></span>
<span id="cb253-2"><a href="explorer.html#cb253-2" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(.<span class="dv">9</span>, .<span class="dv">8</span>, .<span class="dv">7</span>,  <span class="dv">0</span>,  <span class="dv">0</span>, .<span class="dv">4</span>,</span>
<span id="cb253-3"><a href="explorer.html#cb253-3" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>, .<span class="dv">4</span>, .<span class="dv">5</span>, .<span class="dv">6</span>), </span>
<span id="cb253-4"><a href="explorer.html#cb253-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">nrow =</span> <span class="dv">6</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb253-5"><a href="explorer.html#cb253-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-6"><a href="explorer.html#cb253-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Identification des variables et facteurs</span></span>
<span id="cb253-7"><a href="explorer.html#cb253-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(phi) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"F1"</span>, <span class="st">"F2"</span>)</span>
<span id="cb253-8"><a href="explorer.html#cb253-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(phi) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">rep</span>(<span class="st">"i"</span>,<span class="dv">6</span>), <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb253-9"><a href="explorer.html#cb253-9" aria-hidden="true" tabindex="-1"></a>phi</span>
<span id="cb253-10"><a href="explorer.html#cb253-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>     F1  F2</span>
<span id="cb253-11"><a href="explorer.html#cb253-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i1 <span class="fl">0.9</span> <span class="fl">0.0</span></span>
<span id="cb253-12"><a href="explorer.html#cb253-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i2 <span class="fl">0.8</span> <span class="fl">0.0</span></span>
<span id="cb253-13"><a href="explorer.html#cb253-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i3 <span class="fl">0.7</span> <span class="fl">0.0</span></span>
<span id="cb253-14"><a href="explorer.html#cb253-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i4 <span class="fl">0.0</span> <span class="fl">0.4</span></span>
<span id="cb253-15"><a href="explorer.html#cb253-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i5 <span class="fl">0.0</span> <span class="fl">0.5</span></span>
<span id="cb253-16"><a href="explorer.html#cb253-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i6 <span class="fl">0.4</span> <span class="fl">0.6</span></span></code></pre></div>
<div id="première-technique" class="section level3" number="19.1.1">
<h3>
<span class="header-section-number">19.1.1</span> Première technique<a class="anchor" aria-label="anchor" href="#premi%C3%A8re-technique"><i class="fas fa-link"></i></a>
</h3>
<p>À partir de <code>phi</code>, il est possible d’obtenir la matrice de corrélation de la population <span class="math inline">\(\text{P}\)</span> (<span class="math inline">\(\rho\)</span> majuscule) par l’équation <a href="explorer.html#eq:fact2cor">(19.1)</a></p>
<p><span class="math display" id="eq:fact2cor">\[\begin{equation}
\text{P} = \Phi \Phi^{\prime}
\tag{19.1}
\end{equation}\]</span></p>
<p>ou en code <strong>R</strong>.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="explorer.html#cb254-1" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> phi <span class="sc">%*%</span> <span class="fu">t</span>(phi)</span>
<span id="cb254-2"><a href="explorer.html#cb254-2" aria-hidden="true" tabindex="-1"></a>R</span>
<span id="cb254-3"><a href="explorer.html#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      i1   i2   i3   i4   i5   i6</span>
<span id="cb254-4"><a href="explorer.html#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i1 <span class="fl">0.81</span> <span class="fl">0.72</span> <span class="fl">0.63</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.36</span></span>
<span id="cb254-5"><a href="explorer.html#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i2 <span class="fl">0.72</span> <span class="fl">0.64</span> <span class="fl">0.56</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.32</span></span>
<span id="cb254-6"><a href="explorer.html#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i3 <span class="fl">0.63</span> <span class="fl">0.56</span> <span class="fl">0.49</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.28</span></span>
<span id="cb254-7"><a href="explorer.html#cb254-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i4 <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.16</span> <span class="fl">0.20</span> <span class="fl">0.24</span></span>
<span id="cb254-8"><a href="explorer.html#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i5 <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.20</span> <span class="fl">0.25</span> <span class="fl">0.30</span></span>
<span id="cb254-9"><a href="explorer.html#cb254-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i6 <span class="fl">0.36</span> <span class="fl">0.32</span> <span class="fl">0.28</span> <span class="fl">0.24</span> <span class="fl">0.30</span> <span class="fl">0.52</span></span></code></pre></div>
<p>Le lecteur attentif aura remarqué qu’il ne s’agit pas encore d’une matrice de corrélation : la diagonale n’est pas constituée de 1. Le résultat de <span class="math inline">\(\Phi\Phi^{\prime}\)</span> représente la <strong>matrice de corrélation réduite</strong>.</p>
<p>Il reste à ajouter le bruit, la variance résiduelle, ce qui est fait en changeant la diagonale de <span class="math inline">\(R\)</span> pour l’unité, <span class="math inline">\(\text{diag}(R) = 1\)</span>. D’ailleurs, si une valeur de la diagonale <code>R</code> dépasse 1, alors le scénario standardisé n’est pas respecté. Il s’agit d’une des méthodes pour s’en assurer.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="explorer.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(R) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb255-2"><a href="explorer.html#cb255-2" aria-hidden="true" tabindex="-1"></a>R</span>
<span id="cb255-3"><a href="explorer.html#cb255-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      i1   i2   i3   i4  i5   i6</span>
<span id="cb255-4"><a href="explorer.html#cb255-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i1 <span class="fl">1.00</span> <span class="fl">0.72</span> <span class="fl">0.63</span> <span class="fl">0.00</span> <span class="fl">0.0</span> <span class="fl">0.36</span></span>
<span id="cb255-5"><a href="explorer.html#cb255-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i2 <span class="fl">0.72</span> <span class="fl">1.00</span> <span class="fl">0.56</span> <span class="fl">0.00</span> <span class="fl">0.0</span> <span class="fl">0.32</span></span>
<span id="cb255-6"><a href="explorer.html#cb255-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i3 <span class="fl">0.63</span> <span class="fl">0.56</span> <span class="fl">1.00</span> <span class="fl">0.00</span> <span class="fl">0.0</span> <span class="fl">0.28</span></span>
<span id="cb255-7"><a href="explorer.html#cb255-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i4 <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">1.00</span> <span class="fl">0.2</span> <span class="fl">0.24</span></span>
<span id="cb255-8"><a href="explorer.html#cb255-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i5 <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.20</span> <span class="fl">1.0</span> <span class="fl">0.30</span></span>
<span id="cb255-9"><a href="explorer.html#cb255-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i6 <span class="fl">0.36</span> <span class="fl">0.32</span> <span class="fl">0.28</span> <span class="fl">0.24</span> <span class="fl">0.3</span> <span class="fl">1.00</span></span></code></pre></div>
<p>Avec la matrice <code>R</code> calculée, il est évidemment possible, comme il a été fait précédemment de recourir à la fonction <code><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">MASS::mvrnorm()</a></code> avec comme argument <code>Sigma = R</code> pour la matrice de corrélation afin de créer <code>n</code> participants. Il ne reste qu’à choisir une taille d’échantillon.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="explorer.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour la reproductibilité</span></span>
<span id="cb256-2"><a href="explorer.html#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">33</span>)</span>
<span id="cb256-3"><a href="explorer.html#cb256-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-4"><a href="explorer.html#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Création du jeu de données</span></span>
<span id="cb256-5"><a href="explorer.html#cb256-5" aria-hidden="true" tabindex="-1"></a>jd <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">50</span>, </span>
<span id="cb256-6"><a href="explorer.html#cb256-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">ncol</span>(R)), </span>
<span id="cb256-7"><a href="explorer.html#cb256-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Sigma =</span> R)</span>
<span id="cb256-8"><a href="explorer.html#cb256-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(jd)</span>
<span id="cb256-9"><a href="explorer.html#cb256-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>           i1     i2      i3     i4      i5     i6</span>
<span id="cb256-10"><a href="explorer.html#cb256-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>,]  <span class="fl">0.0147</span> <span class="sc">-</span><span class="fl">0.464</span>  <span class="fl">0.5397</span>  <span class="fl">1.187</span> <span class="sc">-</span><span class="fl">0.2932</span>  <span class="fl">0.335</span></span>
<span id="cb256-11"><a href="explorer.html#cb256-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">2</span>,] <span class="sc">-</span><span class="fl">0.4613</span> <span class="sc">-</span><span class="fl">0.288</span>  <span class="fl">0.0302</span>  <span class="fl">0.960</span>  <span class="fl">1.2070</span>  <span class="fl">0.789</span></span>
<span id="cb256-12"><a href="explorer.html#cb256-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">3</span>,] <span class="sc">-</span><span class="fl">1.1191</span> <span class="sc">-</span><span class="fl">0.980</span> <span class="sc">-</span><span class="fl">0.2839</span> <span class="sc">-</span><span class="fl">0.684</span>  <span class="fl">0.0166</span> <span class="sc">-</span><span class="fl">0.700</span></span>
<span id="cb256-13"><a href="explorer.html#cb256-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">4</span>,] <span class="sc">-</span><span class="fl">0.2842</span>  <span class="fl">0.619</span>  <span class="fl">0.0473</span> <span class="sc">-</span><span class="fl">1.013</span>  <span class="fl">0.8804</span>  <span class="fl">0.139</span></span>
<span id="cb256-14"><a href="explorer.html#cb256-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">5</span>,]  <span class="fl">1.0263</span>  <span class="fl">2.322</span>  <span class="fl">1.4843</span>  <span class="fl">2.451</span> <span class="sc">-</span><span class="fl">0.5138</span>  <span class="fl">1.936</span></span>
<span id="cb256-15"><a href="explorer.html#cb256-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">6</span>,] <span class="sc">-</span><span class="fl">0.6026</span> <span class="sc">-</span><span class="fl">0.569</span> <span class="sc">-</span><span class="fl">0.5789</span> <span class="sc">-</span><span class="fl">1.501</span>  <span class="fl">2.2906</span>  <span class="fl">0.157</span></span></code></pre></div>
</div>
<div id="deuxième-technique" class="section level3" number="19.1.2">
<h3>
<span class="header-section-number">19.1.2</span> Deuxième technique<a class="anchor" aria-label="anchor" href="#deuxi%C3%A8me-technique"><i class="fas fa-link"></i></a>
</h3>
<p>Passer par <code><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">MASS::mvrnorm()</a></code> est toutefois contre-productif, puisque la fonction <code>mvrnorm()</code> utilise l’ACP pour extraire une structure factorielle pour ensuite générer les données. Une autre façon de créer des données est en passant par <a href="cr%C3%A9er.html#la-loi-de-la-somme-des-variances">la loi de la somme des variances</a>. Chaque loading <span class="math inline">\(\phi_k\)</span> d’une variable <span class="math inline">\(x_i\)</span> est dans ce contexte <a href="cr%C3%A9er.html#ajout-des-constantes-d%C3%A9chelle-beta">une constante d’échelle</a> jointe à un score factoriel normalement distribué <span class="math inline">\(z_k\)</span>. L’équation <a href="explorer.html#eq:fact2var">(19.2)</a> représente cette relation.</p>
<p><span class="math display" id="eq:fact2var">\[\begin{equation}
x_i = \phi_1 z_1 + ... + \phi_k z_k + \epsilon
\tag{19.2}
\end{equation}\]</span></p>
<p>Ce qui rappelle le modèle linéaire général de l’équation <a href="pr%C3%A9dire.html#eq:modling">(14.19)</a> (section <a href="pr%C3%A9dire.html#pr%C3%A9dire">Prédire</a>). La variable <span class="math inline">\(\epsilon\)</span> correspond à la variance résiduelle, c’est-à-dire la part de variance de la variable non expliquée par les facteurs.</p>
<p>En désirant <a href="cr%C3%A9er.html#le-sc%C3%A9nario-standardis%C3%A9">le scénario standardisé</a>, la variance de <span class="math inline">\(x\)</span> est fixée à 1 et isoler <span class="math inline">\(\epsilon\)</span> pour en déterminer la variance garantit ce scénario. Cela revient à calculer l’équation <a href="explorer.html#eq:resvarfact">(19.3)</a>.</p>
<p><span class="math display" id="eq:resvarfact">\[\begin{equation}
\sigma^2_\epsilon =  1 - (\phi_1^2 + ... + \phi_k^2)  
\tag{19.3}
\end{equation}\]</span></p>
<p>Les écarts types des <span class="math inline">\(\epsilon\)</span> de chaque <span class="math inline">\(p\)</span> variable de la structure factorielle <code>phi</code> se calculent simplement avec <strong>R</strong>.</p>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sd.eps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">phi</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Maintenant, il faut ajouter cette variable à la structure factorielle. Comme les résidus sont tous indépendants par définition, ils ont tous leur propre facteur (chacun sa colonne), ce qui se fait bien avec la syntaxe suivante.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="explorer.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(sd.eps)</span>
<span id="cb258-2"><a href="explorer.html#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>       [,<span class="dv">1</span>] [,<span class="dv">2</span>]  [,<span class="dv">3</span>]  [,<span class="dv">4</span>]  [,<span class="dv">5</span>]  [,<span class="dv">6</span>]</span>
<span id="cb258-3"><a href="explorer.html#cb258-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>,] <span class="fl">0.436</span>  <span class="fl">0.0</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.000</span></span>
<span id="cb258-4"><a href="explorer.html#cb258-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">2</span>,] <span class="fl">0.000</span>  <span class="fl">0.6</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.000</span></span>
<span id="cb258-5"><a href="explorer.html#cb258-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">3</span>,] <span class="fl">0.000</span>  <span class="fl">0.0</span> <span class="fl">0.714</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.000</span></span>
<span id="cb258-6"><a href="explorer.html#cb258-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">4</span>,] <span class="fl">0.000</span>  <span class="fl">0.0</span> <span class="fl">0.000</span> <span class="fl">0.917</span> <span class="fl">0.000</span> <span class="fl">0.000</span></span>
<span id="cb258-7"><a href="explorer.html#cb258-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">5</span>,] <span class="fl">0.000</span>  <span class="fl">0.0</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.866</span> <span class="fl">0.000</span></span>
<span id="cb258-8"><a href="explorer.html#cb258-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">6</span>,] <span class="fl">0.000</span>  <span class="fl">0.0</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.000</span> <span class="fl">0.693</span></span></code></pre></div>
<p>Il suffit maintenant de joindre cette matrice à <code>phi</code>.</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phi2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">phi</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">sd.eps</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Il est tentant de joindre directement le vecteur <code>sd.eps</code> à <code>phi</code>. Par contre, joindre ce vecteur comme <code>cbind(phi, sd.eps)</code> implique une structure à trois facteurs : les résidus sont corrélés par les loadings de ce troisième facteur. En utilisant <code>diag(se.eps)</code>, chaque résidu à son propre facteur et est indépendant des autres. La structure finale possède <span class="math inline">\(k\)</span> (nombre de facteurs, 2 dans cet exemple) communs en plus de <span class="math inline">\(p\)</span> (nombre de variables, 6 dans cet exemple) facteurs résiduels et ainsi <span class="math inline">\(k + p\)</span> dimensions.</p>
<p>Comme à l’équation <a href="explorer.html#eq:fact2cor">(19.1)</a>, <code>phi2</code> permet d’obtenir la matrice de corrélation de la population.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="explorer.html#cb260-1" aria-hidden="true" tabindex="-1"></a>R2 <span class="ot">&lt;-</span> phi2 <span class="sc">%*%</span> <span class="fu">t</span>(phi2)</span>
<span id="cb260-2"><a href="explorer.html#cb260-2" aria-hidden="true" tabindex="-1"></a>R2</span>
<span id="cb260-3"><a href="explorer.html#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      i1   i2   i3   i4  i5   i6</span>
<span id="cb260-4"><a href="explorer.html#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i1 <span class="fl">1.00</span> <span class="fl">0.72</span> <span class="fl">0.63</span> <span class="fl">0.00</span> <span class="fl">0.0</span> <span class="fl">0.36</span></span>
<span id="cb260-5"><a href="explorer.html#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i2 <span class="fl">0.72</span> <span class="fl">1.00</span> <span class="fl">0.56</span> <span class="fl">0.00</span> <span class="fl">0.0</span> <span class="fl">0.32</span></span>
<span id="cb260-6"><a href="explorer.html#cb260-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i3 <span class="fl">0.63</span> <span class="fl">0.56</span> <span class="fl">1.00</span> <span class="fl">0.00</span> <span class="fl">0.0</span> <span class="fl">0.28</span></span>
<span id="cb260-7"><a href="explorer.html#cb260-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i4 <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">1.00</span> <span class="fl">0.2</span> <span class="fl">0.24</span></span>
<span id="cb260-8"><a href="explorer.html#cb260-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i5 <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.20</span> <span class="fl">1.0</span> <span class="fl">0.30</span></span>
<span id="cb260-9"><a href="explorer.html#cb260-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i6 <span class="fl">0.36</span> <span class="fl">0.32</span> <span class="fl">0.28</span> <span class="fl">0.24</span> <span class="fl">0.3</span> <span class="fl">1.00</span></span></code></pre></div>
<p>Exactement le même résultat que l’autre méthode, et ce, sans avoir à modifier la diagonale par l’unité. Les variances résiduelles sont déjà calculées.</p>
<p>Une fois la structure factorielle obtenue, il faut générer les scores des participants (les valeurs <span class="math inline">\(z\)</span> de l’équation <a href="explorer.html#eq:fact2var">(19.2)</a>). Une technique usuelle est de créer une matrice <span class="math inline">\((k + p) \times n\)</span> de scores normaux, soit le nombre de facteurs plus le nombre de variables (pour les résidus) en ligne par <span class="math inline">\(n\)</span> le nombre d’unités en colonnes. Cette matrice représente les scores factoriaux de chaque unité pour chacun des scores et sont multipliés avec la structure factorielle. Autrement dit, chaque poids (loadings) est multiplié à une distribution normale qui représente le score du participant pour ce facteur.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="explorer.html#cb261-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span>; k <span class="ot">&lt;-</span> <span class="dv">2</span>; p <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb261-2"><a href="explorer.html#cb261-2" aria-hidden="true" tabindex="-1"></a>score.ind <span class="ot">&lt;-</span>  <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p <span class="sc">*</span> k), </span>
<span id="cb261-3"><a href="explorer.html#cb261-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">nrow =</span> (k <span class="sc">+</span> p), </span>
<span id="cb261-4"><a href="explorer.html#cb261-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ncol =</span> n)</span>
<span id="cb261-5"><a href="explorer.html#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Warning <span class="cf">in</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p <span class="sc">*</span> k), <span class="at">nrow =</span> (k <span class="sc">+</span> p), <span class="at">ncol =</span></span>
<span id="cb261-6"><a href="explorer.html#cb261-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> n)<span class="sc">:</span> data length differs from size of matrix<span class="sc">:</span> [<span class="dv">6000</span> <span class="sc">!=</span> <span class="dv">8</span> x</span>
<span id="cb261-7"><a href="explorer.html#cb261-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="dv">500</span>]</span></code></pre></div>
<p>Il ne reste plus qu’à faire le produit matricielle de <code>phi2</code> (<span class="math inline">\(\left[ \Phi, \text{diag}(\epsilon) \right]\)</span>) et des scores individuels (<code>score.ind</code>).</p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jd2</span> <span class="op">&lt;-</span> <span class="va">phi2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">score.ind</span></span></code></pre></div>
<p>La variable <code>jd2</code> contient tous les scores des <span class="math inline">\(n\)</span> participants sur les <span class="math inline">\(p\)</span> variables. Pour obtenir la base de données dans le sens usuel, il suffit de faire une transpose à <code>jd</code> avec la fonction <code><a href="https://rdrr.io/r/base/t.html">t()</a></code>.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="explorer.html#cb263-1" aria-hidden="true" tabindex="-1"></a>jd2 <span class="ot">&lt;-</span> <span class="fu">t</span>(jd2)</span>
<span id="cb263-2"><a href="explorer.html#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(jd2)</span>
<span id="cb263-3"><a href="explorer.html#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>          i1     i2      i3      i4     i5     i6</span>
<span id="cb263-4"><a href="explorer.html#cb263-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>,]  <span class="fl">0.111</span> <span class="sc">-</span><span class="fl">0.886</span> <span class="sc">-</span><span class="fl">0.9769</span>  <span class="fl">0.5398</span>  <span class="fl">1.562</span>  <span class="fl">1.698</span></span>
<span id="cb263-5"><a href="explorer.html#cb263-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">2</span>,] <span class="sc">-</span><span class="fl">1.332</span> <span class="sc">-</span><span class="fl">0.808</span> <span class="sc">-</span><span class="fl">1.0043</span>  <span class="fl">0.0559</span>  <span class="fl">0.372</span> <span class="sc">-</span><span class="fl">1.006</span></span>
<span id="cb263-6"><a href="explorer.html#cb263-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">3</span>,] <span class="sc">-</span><span class="fl">1.451</span> <span class="sc">-</span><span class="fl">1.331</span> <span class="sc">-</span><span class="fl">1.7075</span>  <span class="fl">0.4404</span> <span class="sc">-</span><span class="fl">1.145</span> <span class="sc">-</span><span class="fl">2.224</span></span>
<span id="cb263-7"><a href="explorer.html#cb263-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">4</span>,]  <span class="fl">0.439</span> <span class="sc">-</span><span class="fl">0.528</span>  <span class="fl">1.4282</span> <span class="sc">-</span><span class="fl">0.8922</span>  <span class="fl">0.437</span> <span class="sc">-</span><span class="fl">0.076</span></span>
<span id="cb263-8"><a href="explorer.html#cb263-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">5</span>,] <span class="sc">-</span><span class="fl">0.387</span> <span class="sc">-</span><span class="fl">0.488</span> <span class="sc">-</span><span class="fl">0.0509</span>  <span class="fl">0.5412</span>  <span class="fl">0.346</span> <span class="sc">-</span><span class="fl">0.262</span></span>
<span id="cb263-9"><a href="explorer.html#cb263-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">6</span>,]  <span class="fl">0.526</span>  <span class="fl">1.163</span>  <span class="fl">0.2766</span>  <span class="fl">0.1620</span>  <span class="fl">0.747</span>  <span class="fl">0.944</span></span></code></pre></div>
<p>Voilà une base de données prêtes à être utiliser pour une analyse factorielle. En pratique, pour donner un peu plus de réalisme, il est possible d’ajouter une moyenne (additionner), de modifier l’écart type (multiplier) de chacune des variables, d’arrondir les scores, et plus en fonction des besoins.</p>
</div>
<div id="lanalyse-en-composantes-principales-1" class="section level3" number="19.1.3">
<h3>
<span class="header-section-number">19.1.3</span> L’analyse en composantes principales<a class="anchor" aria-label="anchor" href="#lanalyse-en-composantes-principales-1"><i class="fas fa-link"></i></a>
</h3>
<p>À titre de comparaison, voici les résultats de l’analyse en composantes principales.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="explorer.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyse en composantes principales</span></span>
<span id="cb264-2"><a href="explorer.html#cb264-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cor</span>(jd2))</span>
<span id="cb264-3"><a href="explorer.html#cb264-3" aria-hidden="true" tabindex="-1"></a>res</span>
<span id="cb264-4"><a href="explorer.html#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">eigen</span>() decomposition</span>
<span id="cb264-5"><a href="explorer.html#cb264-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="er">$</span>values</span>
<span id="cb264-6"><a href="explorer.html#cb264-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">2.503</span> <span class="fl">1.340</span> <span class="fl">0.888</span> <span class="fl">0.588</span> <span class="fl">0.427</span> <span class="fl">0.253</span></span>
<span id="cb264-7"><a href="explorer.html#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb264-8"><a href="explorer.html#cb264-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>vectors</span>
<span id="cb264-9"><a href="explorer.html#cb264-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>         [,<span class="dv">1</span>]   [,<span class="dv">2</span>]    [,<span class="dv">3</span>]    [,<span class="dv">4</span>]    [,<span class="dv">5</span>]     [,<span class="dv">6</span>]</span>
<span id="cb264-10"><a href="explorer.html#cb264-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>,] <span class="sc">-</span><span class="fl">0.5659</span>  <span class="fl">0.133</span>  <span class="fl">0.0015</span>  <span class="fl">0.0729</span> <span class="sc">-</span><span class="fl">0.1699</span>  <span class="fl">0.79231</span></span>
<span id="cb264-11"><a href="explorer.html#cb264-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">2</span>,] <span class="sc">-</span><span class="fl">0.5394</span>  <span class="fl">0.129</span>  <span class="fl">0.1006</span>  <span class="fl">0.0207</span> <span class="sc">-</span><span class="fl">0.6224</span> <span class="sc">-</span><span class="fl">0.54259</span></span>
<span id="cb264-12"><a href="explorer.html#cb264-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">3</span>,] <span class="sc">-</span><span class="fl">0.5118</span>  <span class="fl">0.143</span> <span class="sc">-</span><span class="fl">0.0587</span>  <span class="fl">0.3666</span>  <span class="fl">0.7118</span> <span class="sc">-</span><span class="fl">0.27061</span></span>
<span id="cb264-13"><a href="explorer.html#cb264-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">4</span>,] <span class="sc">-</span><span class="fl">0.0330</span> <span class="sc">-</span><span class="fl">0.555</span>  <span class="fl">0.7725</span>  <span class="fl">0.3039</span>  <span class="fl">0.0111</span>  <span class="fl">0.04282</span></span>
<span id="cb264-14"><a href="explorer.html#cb264-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">5</span>,] <span class="sc">-</span><span class="fl">0.0431</span> <span class="sc">-</span><span class="fl">0.629</span> <span class="sc">-</span><span class="fl">0.6206</span>  <span class="fl">0.4303</span> <span class="sc">-</span><span class="fl">0.1780</span> <span class="sc">-</span><span class="fl">0.00138</span></span>
<span id="cb264-15"><a href="explorer.html#cb264-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">6</span>,] <span class="sc">-</span><span class="fl">0.3520</span> <span class="sc">-</span><span class="fl">0.491</span> <span class="sc">-</span><span class="fl">0.0676</span> <span class="sc">-</span><span class="fl">0.7631</span>  <span class="fl">0.2128</span> <span class="sc">-</span><span class="fl">0.05277</span></span>
<span id="cb264-16"><a href="explorer.html#cb264-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-17"><a href="explorer.html#cb264-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Les deux premières valeurs propres</span></span>
<span id="cb264-18"><a href="explorer.html#cb264-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-19"><a href="explorer.html#cb264-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Les loadings des deux premières composantes</span></span>
<span id="cb264-20"><a href="explorer.html#cb264-20" aria-hidden="true" tabindex="-1"></a>ld <span class="ot">&lt;-</span> res<span class="sc">$</span>vectors[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%*%</span> </span>
<span id="cb264-21"><a href="explorer.html#cb264-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diag</span>(<span class="fu">sqrt</span>(res<span class="sc">$</span>values)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb264-22"><a href="explorer.html#cb264-22" aria-hidden="true" tabindex="-1"></a>ld</span>
<span id="cb264-23"><a href="explorer.html#cb264-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>         [,<span class="dv">1</span>]   [,<span class="dv">2</span>]</span>
<span id="cb264-24"><a href="explorer.html#cb264-24" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>,] <span class="sc">-</span><span class="fl">0.8954</span>  <span class="fl">0.154</span></span>
<span id="cb264-25"><a href="explorer.html#cb264-25" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">2</span>,] <span class="sc">-</span><span class="fl">0.8534</span>  <span class="fl">0.149</span></span>
<span id="cb264-26"><a href="explorer.html#cb264-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">3</span>,] <span class="sc">-</span><span class="fl">0.8097</span>  <span class="fl">0.165</span></span>
<span id="cb264-27"><a href="explorer.html#cb264-27" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">4</span>,] <span class="sc">-</span><span class="fl">0.0522</span> <span class="sc">-</span><span class="fl">0.642</span></span>
<span id="cb264-28"><a href="explorer.html#cb264-28" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">5</span>,] <span class="sc">-</span><span class="fl">0.0682</span> <span class="sc">-</span><span class="fl">0.729</span></span>
<span id="cb264-29"><a href="explorer.html#cb264-29" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">6</span>,] <span class="sc">-</span><span class="fl">0.5569</span> <span class="sc">-</span><span class="fl">0.568</span></span></code></pre></div>
<p>Elle est assez près de la structure originale, mais pas exactement. Et ce n’est pas à cause du relativement petit <code>n</code> ou de <a href="calculer.html#les-graines">la graine</a>. La cause est bel et bien que l’objectif de l’ACP est de <strong>réorganiser la variance plutôt que de rechercher une structure factorielle</strong>. L’ACP ne sait pas que la <em>vraie</em> structure contient des facteurs communs entre les variables. Pour tester la présence de facteurs communs, il faut procéder avec une autre analyse : l’<strong>analyse factorielle exploratoire (AFE)</strong>.</p>
</div>
</div>
<div id="analyse-factorielle-exploratoire" class="section level2" number="19.2">
<h2>
<span class="header-section-number">19.2</span> Analyse factorielle exploratoire<a class="anchor" aria-label="anchor" href="#analyse-factorielle-exploratoire"><i class="fas fa-link"></i></a>
</h2>
<p>Pour réaliser une analyse factorielle exploratoire, la fonction <code><a href="https://rdrr.io/r/stats/factanal.html">factanal()</a></code> de <strong>R</strong> prend un jeu de données et le nombre de facteurs à tester. La fonction détecte automatiquement s’il s’agit d’un jeu de données ou une matrice de covariance; l’un ou l’autre peut être fourni.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="explorer.html#cb265-1" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">factanal</span>(jd2, <span class="at">factors =</span> <span class="dv">1</span>)</span>
<span id="cb265-2"><a href="explorer.html#cb265-2" aria-hidden="true" tabindex="-1"></a>res1</span>
<span id="cb265-3"><a href="explorer.html#cb265-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb265-4"><a href="explorer.html#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Call<span class="sc">:</span></span>
<span id="cb265-5"><a href="explorer.html#cb265-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">factanal</span>(<span class="at">x =</span> jd2, <span class="at">factors =</span> <span class="dv">1</span>)</span>
<span id="cb265-6"><a href="explorer.html#cb265-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb265-7"><a href="explorer.html#cb265-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Uniquenesses<span class="sc">:</span></span>
<span id="cb265-8"><a href="explorer.html#cb265-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>    i1    i2    i3    i4    i5    i6 </span>
<span id="cb265-9"><a href="explorer.html#cb265-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fl">0.156</span> <span class="fl">0.376</span> <span class="fl">0.487</span> <span class="fl">1.000</span> <span class="fl">1.000</span> <span class="fl">0.851</span> </span>
<span id="cb265-10"><a href="explorer.html#cb265-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb265-11"><a href="explorer.html#cb265-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Loadings<span class="sc">:</span></span>
<span id="cb265-12"><a href="explorer.html#cb265-12" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>    Factor1</span>
<span id="cb265-13"><a href="explorer.html#cb265-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i1  <span class="fl">0.919</span> </span>
<span id="cb265-14"><a href="explorer.html#cb265-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i2  <span class="fl">0.790</span> </span>
<span id="cb265-15"><a href="explorer.html#cb265-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i3  <span class="fl">0.716</span> </span>
<span id="cb265-16"><a href="explorer.html#cb265-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i4        </span>
<span id="cb265-17"><a href="explorer.html#cb265-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i5        </span>
<span id="cb265-18"><a href="explorer.html#cb265-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i6  <span class="fl">0.386</span> </span>
<span id="cb265-19"><a href="explorer.html#cb265-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb265-20"><a href="explorer.html#cb265-20" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>                Factor1</span>
<span id="cb265-21"><a href="explorer.html#cb265-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> SS loadings      <span class="fl">2.131</span></span>
<span id="cb265-22"><a href="explorer.html#cb265-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Proportion Var   <span class="fl">0.355</span></span>
<span id="cb265-23"><a href="explorer.html#cb265-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb265-24"><a href="explorer.html#cb265-24" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Test of the hypothesis that <span class="dv">1</span> factor is sufficient.</span>
<span id="cb265-25"><a href="explorer.html#cb265-25" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> The chi square statistic is <span class="fl">86.9</span> on <span class="dv">9</span> degrees of freedom.</span>
<span id="cb265-26"><a href="explorer.html#cb265-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> The p<span class="sc">-</span>value is <span class="fl">6.84e-15</span></span></code></pre></div>
<p>C’est aussi simple que l’ACP (même plus!). La sortie procure trois statistiques d’intérêt : les loadings, la proportion de variance expliquée (<code>Proportion Var</code>) et un test de <span class="math inline">\(\chi^2\)</span> avec sa valeur-<span class="math inline">\(p\)</span>. Les loadings entre -.1 et .1 ne sont pas affichés afin d’attirer l’attention sur la structure. Les loadings peuvent être extraits avec la fonction <code><a href="https://rdrr.io/r/stats/loadings.html">loadings()</a></code> ou en élément de liste. L’utilisation de <code>[]</code> permet d’afficher complètement la matrice de loadings.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="explorer.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loadings</span>(res1)</span>
<span id="cb266-2"><a href="explorer.html#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb266-3"><a href="explorer.html#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Loadings<span class="sc">:</span></span>
<span id="cb266-4"><a href="explorer.html#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>    Factor1</span>
<span id="cb266-5"><a href="explorer.html#cb266-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i1  <span class="fl">0.919</span> </span>
<span id="cb266-6"><a href="explorer.html#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i2  <span class="fl">0.790</span> </span>
<span id="cb266-7"><a href="explorer.html#cb266-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i3  <span class="fl">0.716</span> </span>
<span id="cb266-8"><a href="explorer.html#cb266-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i4        </span>
<span id="cb266-9"><a href="explorer.html#cb266-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i5        </span>
<span id="cb266-10"><a href="explorer.html#cb266-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i6  <span class="fl">0.386</span> </span>
<span id="cb266-11"><a href="explorer.html#cb266-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb266-12"><a href="explorer.html#cb266-12" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>                Factor1</span>
<span id="cb266-13"><a href="explorer.html#cb266-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> SS loadings      <span class="fl">2.131</span></span>
<span id="cb266-14"><a href="explorer.html#cb266-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Proportion Var   <span class="fl">0.355</span></span>
<span id="cb266-15"><a href="explorer.html#cb266-15" aria-hidden="true" tabindex="-1"></a>res1<span class="sc">$</span>loadings[]</span>
<span id="cb266-16"><a href="explorer.html#cb266-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>    Factor1</span>
<span id="cb266-17"><a href="explorer.html#cb266-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i1  <span class="fl">0.9187</span></span>
<span id="cb266-18"><a href="explorer.html#cb266-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i2  <span class="fl">0.7896</span></span>
<span id="cb266-19"><a href="explorer.html#cb266-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i3  <span class="fl">0.7165</span></span>
<span id="cb266-20"><a href="explorer.html#cb266-20" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i4 <span class="sc">-</span><span class="fl">0.0140</span></span>
<span id="cb266-21"><a href="explorer.html#cb266-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i5 <span class="sc">-</span><span class="fl">0.0124</span></span>
<span id="cb266-22"><a href="explorer.html#cb266-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i6  <span class="fl">0.3864</span></span></code></pre></div>
<p>La valeur-<span class="math inline">\(p\)</span> concerne la qualité de de l’ajustement de la strucuture à <code>factors</code> facteurs. Comme la valeur-<span class="math inline">\(p\)</span> est significative à un facteur, <span class="math inline">\(p &lt; .001\)</span>, cela signifie que la structure testée (un facteur) n’est pas vraisemblable. Il faut tester pour deux facteurs.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="explorer.html#cb267-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">factanal</span>(jd2, <span class="at">factors =</span> <span class="dv">2</span>)</span>
<span id="cb267-2"><a href="explorer.html#cb267-2" aria-hidden="true" tabindex="-1"></a>res2</span>
<span id="cb267-3"><a href="explorer.html#cb267-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb267-4"><a href="explorer.html#cb267-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Call<span class="sc">:</span></span>
<span id="cb267-5"><a href="explorer.html#cb267-5" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">factanal</span>(<span class="at">x =</span> jd2, <span class="at">factors =</span> <span class="dv">2</span>)</span>
<span id="cb267-6"><a href="explorer.html#cb267-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb267-7"><a href="explorer.html#cb267-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Uniquenesses<span class="sc">:</span></span>
<span id="cb267-8"><a href="explorer.html#cb267-8" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>    i1    i2    i3    i4    i5    i6 </span>
<span id="cb267-9"><a href="explorer.html#cb267-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fl">0.154</span> <span class="fl">0.378</span> <span class="fl">0.487</span> <span class="fl">0.910</span> <span class="fl">0.849</span> <span class="fl">0.288</span> </span>
<span id="cb267-10"><a href="explorer.html#cb267-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb267-11"><a href="explorer.html#cb267-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Loadings<span class="sc">:</span></span>
<span id="cb267-12"><a href="explorer.html#cb267-12" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>    Factor1 Factor2</span>
<span id="cb267-13"><a href="explorer.html#cb267-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i1  <span class="fl">0.920</span>         </span>
<span id="cb267-14"><a href="explorer.html#cb267-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i2  <span class="fl">0.788</span>         </span>
<span id="cb267-15"><a href="explorer.html#cb267-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i3  <span class="fl">0.716</span>         </span>
<span id="cb267-16"><a href="explorer.html#cb267-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i4          <span class="fl">0.298</span> </span>
<span id="cb267-17"><a href="explorer.html#cb267-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i5          <span class="fl">0.387</span> </span>
<span id="cb267-18"><a href="explorer.html#cb267-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i6  <span class="fl">0.373</span>   <span class="fl">0.757</span> </span>
<span id="cb267-19"><a href="explorer.html#cb267-19" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb267-20"><a href="explorer.html#cb267-20" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>                Factor1 Factor2</span>
<span id="cb267-21"><a href="explorer.html#cb267-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> SS loadings      <span class="fl">2.121</span>   <span class="fl">0.812</span></span>
<span id="cb267-22"><a href="explorer.html#cb267-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Proportion Var   <span class="fl">0.354</span>   <span class="fl">0.135</span></span>
<span id="cb267-23"><a href="explorer.html#cb267-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Cumulative Var   <span class="fl">0.354</span>   <span class="fl">0.489</span></span>
<span id="cb267-24"><a href="explorer.html#cb267-24" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb267-25"><a href="explorer.html#cb267-25" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Test of the hypothesis that <span class="dv">2</span> factors are sufficient.</span>
<span id="cb267-26"><a href="explorer.html#cb267-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> The chi square statistic is <span class="fl">5.31</span> on <span class="dv">4</span> degrees of freedom.</span>
<span id="cb267-27"><a href="explorer.html#cb267-27" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> The p<span class="sc">-</span>value is <span class="fl">0.257</span></span></code></pre></div>
<p>Les mêmes statistiques, mais pour deux facteurs, sont obtenues. Les résultats sont très près de la structure originale. La valeur-<span class="math inline">\(p\)</span> n’est plus significative, ce qui suggère que le modèle semble bien de deux facteurs.</p>
<div id="extraire-les-scores" class="section level3" number="19.2.1">
<h3>
<span class="header-section-number">19.2.1</span> Extraire les scores<a class="anchor" aria-label="anchor" href="#extraire-les-scores"><i class="fas fa-link"></i></a>
</h3>
<p>Une fois le nombre de facteurs déterminé (voir <a href="r%C3%A9duire.html#r%C3%A9duire">Réduire</a> à ce sujet), les scores factoriels des participants peuvent être utilisés. Pour les obtenir, il faut commander de nouveau l’analyse factorielle en y indiquant le type de scores désiré, soit <code>regression</code> ou <code>Bartlett</code>. Cela ajoutera les scores dans la liste de sortie de la fonction sous l’appellation <code>scores</code>. Voici un exemple.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="explorer.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Commander l'analyse avec l'argument scores = "regression"</span></span>
<span id="cb268-2"><a href="explorer.html#cb268-2" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">factanal</span>(jd2, <span class="at">factors =</span> <span class="dv">2</span>, <span class="at">scores =</span> <span class="st">"regression"</span>)</span>
<span id="cb268-3"><a href="explorer.html#cb268-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-4"><a href="explorer.html#cb268-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Les scores factoriels se retouvent dans la sortie</span></span>
<span id="cb268-5"><a href="explorer.html#cb268-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(res2<span class="sc">$</span>scores)</span>
<span id="cb268-6"><a href="explorer.html#cb268-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      Factor1 Factor2</span>
<span id="cb268-7"><a href="explorer.html#cb268-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>,]  <span class="sc">-</span><span class="fl">0.244</span>  <span class="fl">1.7256</span></span>
<span id="cb268-8"><a href="explorer.html#cb268-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">2</span>,]  <span class="sc">-</span><span class="fl">1.259</span> <span class="sc">-</span><span class="fl">0.4500</span></span>
<span id="cb268-9"><a href="explorer.html#cb268-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">3</span>,]  <span class="sc">-</span><span class="fl">1.588</span> <span class="sc">-</span><span class="fl">1.5611</span></span>
<span id="cb268-10"><a href="explorer.html#cb268-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">4</span>,]   <span class="fl">0.384</span> <span class="sc">-</span><span class="fl">0.2586</span></span>
<span id="cb268-11"><a href="explorer.html#cb268-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">5</span>,]  <span class="sc">-</span><span class="fl">0.399</span> <span class="sc">-</span><span class="fl">0.0404</span></span>
<span id="cb268-12"><a href="explorer.html#cb268-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">6</span>,]   <span class="fl">0.667</span>  <span class="fl">0.7026</span></span></code></pre></div>
</div>
</div>
<div id="calculs-de-lanalyse-factorielle-exploratoire" class="section level2" number="19.3">
<h2>
<span class="header-section-number">19.3</span> Calculs de l’analyse factorielle exploratoire<a class="anchor" aria-label="anchor" href="#calculs-de-lanalyse-factorielle-exploratoire"><i class="fas fa-link"></i></a>
</h2>
<p>Il existe deux techniques plus connues pour réaliser l’analyse factorielle exploratoire : la <strong>factorisation en axes principaux</strong> (PAF; <em>principal axis factoring</em>) et l’<strong>analyse factorielle par maximum de vraisemblance</strong> (MLFA; <em>maximum likelihood factor analysis</em>).</p>
<p>La PAF tente de retrouver la matrice de corrélation originale sans bruit, c’est-à-dire la <strong>matrice de corrélation réduite</strong> dans laquelle la diagonale n’est pas constituée de <span class="math inline">\(1\)</span> soit <code>phi %*% t(phi)</code> (en code) ou <span class="math inline">\(\Phi\Phi^\prime\)</span> (en équation). Elle se base sur l’ACP (la fonction maison ci-dessous utilise <code><a href="https://rdrr.io/r/base/eigen.html">eigen()</a></code>) avec quelques raffinements supplémentaires.</p>
<p>La logique est de prendre les loadings <span class="math inline">\(\phi\)</span> d’un nombre arbitraire de <span class="math inline">\(k\)</span> facteurs, puis de calculer la communalité des variables, soit l’équation <a href="explorer.html#eq:com">(19.4)</a> pour la variable <span class="math inline">\(i\)</span></p>
<p><span class="math display" id="eq:com">\[\begin{equation}
C_i = \sum_{i=1}^k \Phi_i^2
\tag{19.4}
\end{equation}\]</span></p>
<p>pour enfin soustraire de deux communalités subséquentes la différence jusqu’à ce que celle-ci converge le plus près possible de 0 (donc, virtuellement aucune différence entre les deux communalités). Autrement dit, l’objectif de la PAF est de retrouver la matrice de corrélation réduite.</p>
<p>Pour ce faire, il faut utiliser une technique itérative. En optimisation, il faut prendre quelques précautions pour s’assurer du bon fonctionnement du logiciel :</p>
<ul>
<li><p>fixer un maximum d’itérations afin de s’assurer d’éviter d’entrer dans une boucle interminable duquel le logiciel ne peut s’échapper;</p></li>
<li><p>fixer un seuil de convergence à atteindre afin de déterminer une fin à l’optimisation.</p></li>
</ul>
<p>Ces deux règles évitent aux programmeurs de fixer son écran pendant des heures pendant lesquelles le programme calcule des résultats de boucles interminables.</p>
<p>Ces deux recommandations se retrouvent en arguments et peuvent être modifiées</p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paf</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">covmat</span>, </span>
<span>                <span class="va">nfactors</span>, </span>
<span>                <span class="va">converge</span> <span class="op">=</span> <span class="fl">.000001</span>, </span>
<span>                <span class="va">max.iter</span> <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Nombre de variables</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">covmat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Boucle d'estimation avec itérations</span></span>
<span>  <span class="co"># maximales (max.iter)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">max.iter</span><span class="op">)</span><span class="op">{</span></span>
<span>    </span>
<span>    <span class="co"># ACP de la matrice</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">covmat</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Les loadings</span></span>
<span>    <span class="va">ld</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">vector</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="va">nfactors</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">nfactors</span><span class="op">]</span>, ncol <span class="op">=</span> <span class="va">nfactors</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Les communalités</span></span>
<span>    <span class="va">co</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="va">ld</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># La différence à optimiser</span></span>
<span>    <span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">covmat</span><span class="op">)</span> <span class="op">-</span> <span class="va">co</span></span>
<span>    </span>
<span>    <span class="co"># Si toutes les différences sont plus petites que</span></span>
<span>    <span class="co"># `convergence`, alors `break` cesse la boucle</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">converge</span><span class="op">)</span><span class="op">)</span> <span class="kw">break</span></span>
<span>    </span>
<span>    <span class="co"># Si non,</span></span>
<span>    <span class="co"># mettre à jour la nouvelle diagonale</span></span>
<span>    <span class="co"># de la matrice et continuer</span></span>
<span>    <span class="va">covmat</span> <span class="op">&lt;-</span> <span class="va">covmat</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Sortie</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>uniquenesses <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="va">co</span>,</span>
<span>              loadings <span class="op">=</span> <span class="va">ld</span>,</span>
<span>              covmat <span class="op">=</span> <span class="va">covmat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Noter l’ajout de <code>ncol =</code> dans la fonction <code><a href="https://rdrr.io/r/base/diag.html">diag()</a></code>. Cela a pour but de forcer <em>R</em> à créer une matrice <span class="math inline">\(1 \times 1\)</span><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Essayer &lt;code&gt;diag(1.5)&lt;/code&gt; pour observer le comportement de &lt;strong&gt;R&lt;/strong&gt;. Ce n’est pas le résultat attendu.&lt;/p&gt;"><sup>37</sup></a>. Enfin, noter l’introduction de <code><a href="https://rdrr.io/r/base/Control.html">break</a></code> (aperçu dans la section <a href="programmer.html#les-variables">Les variables</a>) qui permet de mettre fin à une boucle lorsque une condition est atteinte.</p>
<p>À toute fin de comparaison, voici la technique PAF maison (<code>paf()</code>) et l’analyse factorielle de <strong>R</strong>.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="explorer.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">factanal</span>(<span class="at">covmat =</span> R, <span class="at">n.obs =</span> n, <span class="at">factors =</span> <span class="dv">2</span>)</span>
<span id="cb270-2"><a href="explorer.html#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb270-3"><a href="explorer.html#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Call<span class="sc">:</span></span>
<span id="cb270-4"><a href="explorer.html#cb270-4" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="fu">factanal</span>(<span class="at">factors =</span> <span class="dv">2</span>, <span class="at">covmat =</span> R, <span class="at">n.obs =</span> n)</span>
<span id="cb270-5"><a href="explorer.html#cb270-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb270-6"><a href="explorer.html#cb270-6" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Uniquenesses<span class="sc">:</span></span>
<span id="cb270-7"><a href="explorer.html#cb270-7" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>   i1   i2   i3   i4   i5   i6 </span>
<span id="cb270-8"><a href="explorer.html#cb270-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fl">0.19</span> <span class="fl">0.36</span> <span class="fl">0.51</span> <span class="fl">0.84</span> <span class="fl">0.75</span> <span class="fl">0.48</span> </span>
<span id="cb270-9"><a href="explorer.html#cb270-9" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb270-10"><a href="explorer.html#cb270-10" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Loadings<span class="sc">:</span></span>
<span id="cb270-11"><a href="explorer.html#cb270-11" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>    Factor1 Factor2</span>
<span id="cb270-12"><a href="explorer.html#cb270-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i1  <span class="fl">0.899</span>         </span>
<span id="cb270-13"><a href="explorer.html#cb270-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i2  <span class="fl">0.799</span>         </span>
<span id="cb270-14"><a href="explorer.html#cb270-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i3  <span class="fl">0.699</span>         </span>
<span id="cb270-15"><a href="explorer.html#cb270-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i4          <span class="fl">0.399</span> </span>
<span id="cb270-16"><a href="explorer.html#cb270-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i5          <span class="fl">0.499</span> </span>
<span id="cb270-17"><a href="explorer.html#cb270-17" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i6  <span class="fl">0.368</span>   <span class="fl">0.620</span> </span>
<span id="cb270-18"><a href="explorer.html#cb270-18" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb270-19"><a href="explorer.html#cb270-19" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span>                Factor1 Factor2</span>
<span id="cb270-20"><a href="explorer.html#cb270-20" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> SS loadings      <span class="fl">2.071</span>   <span class="fl">0.799</span></span>
<span id="cb270-21"><a href="explorer.html#cb270-21" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Proportion Var   <span class="fl">0.345</span>   <span class="fl">0.133</span></span>
<span id="cb270-22"><a href="explorer.html#cb270-22" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> Cumulative Var   <span class="fl">0.345</span>   <span class="fl">0.478</span></span>
<span id="cb270-23"><a href="explorer.html#cb270-23" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb270-24"><a href="explorer.html#cb270-24" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> Test of the hypothesis that <span class="dv">2</span> factors are sufficient.</span>
<span id="cb270-25"><a href="explorer.html#cb270-25" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> The chi square statistic is <span class="dv">0</span> on <span class="dv">4</span> degrees of freedom.</span>
<span id="cb270-26"><a href="explorer.html#cb270-26" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> The p<span class="sc">-</span>value is <span class="dv">1</span></span>
<span id="cb270-27"><a href="explorer.html#cb270-27" aria-hidden="true" tabindex="-1"></a><span class="fu">paf</span>(<span class="at">covmat =</span> R, <span class="at">nfactors =</span> <span class="dv">2</span>)</span>
<span id="cb270-28"><a href="explorer.html#cb270-28" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="er">$</span>uniquenesses</span>
<span id="cb270-29"><a href="explorer.html#cb270-29" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>] <span class="fl">0.19</span> <span class="fl">0.36</span> <span class="fl">0.51</span> <span class="fl">0.84</span> <span class="fl">0.75</span> <span class="fl">0.48</span></span>
<span id="cb270-30"><a href="explorer.html#cb270-30" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb270-31"><a href="explorer.html#cb270-31" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>loadings</span>
<span id="cb270-32"><a href="explorer.html#cb270-32" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>         [,<span class="dv">1</span>]   [,<span class="dv">2</span>]</span>
<span id="cb270-33"><a href="explorer.html#cb270-33" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">1</span>,] <span class="sc">-</span><span class="fl">0.8865</span> <span class="sc">-</span><span class="fl">0.155</span></span>
<span id="cb270-34"><a href="explorer.html#cb270-34" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">2</span>,] <span class="sc">-</span><span class="fl">0.7880</span> <span class="sc">-</span><span class="fl">0.138</span></span>
<span id="cb270-35"><a href="explorer.html#cb270-35" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">3</span>,] <span class="sc">-</span><span class="fl">0.6895</span> <span class="sc">-</span><span class="fl">0.121</span></span>
<span id="cb270-36"><a href="explorer.html#cb270-36" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">4</span>,] <span class="sc">-</span><span class="fl">0.0689</span>  <span class="fl">0.394</span></span>
<span id="cb270-37"><a href="explorer.html#cb270-37" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">5</span>,] <span class="sc">-</span><span class="fl">0.0862</span>  <span class="fl">0.493</span></span>
<span id="cb270-38"><a href="explorer.html#cb270-38" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> [<span class="dv">6</span>,] <span class="sc">-</span><span class="fl">0.4974</span>  <span class="fl">0.522</span></span>
<span id="cb270-39"><a href="explorer.html#cb270-39" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> </span>
<span id="cb270-40"><a href="explorer.html#cb270-40" aria-hidden="true" tabindex="-1"></a><span class="er">&gt;</span> <span class="er">$</span>covmat</span>
<span id="cb270-41"><a href="explorer.html#cb270-41" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      i1   i2   i3   i4   i5   i6</span>
<span id="cb270-42"><a href="explorer.html#cb270-42" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i1 <span class="fl">0.81</span> <span class="fl">0.72</span> <span class="fl">0.63</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.36</span></span>
<span id="cb270-43"><a href="explorer.html#cb270-43" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i2 <span class="fl">0.72</span> <span class="fl">0.64</span> <span class="fl">0.56</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.32</span></span>
<span id="cb270-44"><a href="explorer.html#cb270-44" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i3 <span class="fl">0.63</span> <span class="fl">0.56</span> <span class="fl">0.49</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.28</span></span>
<span id="cb270-45"><a href="explorer.html#cb270-45" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i4 <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.16</span> <span class="fl">0.20</span> <span class="fl">0.24</span></span>
<span id="cb270-46"><a href="explorer.html#cb270-46" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i5 <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.20</span> <span class="fl">0.25</span> <span class="fl">0.30</span></span>
<span id="cb270-47"><a href="explorer.html#cb270-47" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i6 <span class="fl">0.36</span> <span class="fl">0.32</span> <span class="fl">0.28</span> <span class="fl">0.24</span> <span class="fl">0.30</span> <span class="fl">0.52</span></span></code></pre></div>
<p>Les résultats sont très près, beaucoup plus que l’ACP de la matrice <code>R</code>. La sortie <code>uniqueness</code> correspond à <code>1-C</code>, la variance résiduelle. Dans les cas, elles sont virtuellement identiques. Dans la sortie de <code>paf()</code>, la matrice de corrélation réduite de <code>R</code> est sortie et montre qu’elle correspond à ce qui est attendu, soit <span class="math inline">\(\Phi\Phi^{\prime}\)</span>.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="explorer.html#cb271-1" aria-hidden="true" tabindex="-1"></a>phi <span class="sc">%*%</span> <span class="fu">t</span>(phi)</span>
<span id="cb271-2"><a href="explorer.html#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      i1   i2   i3   i4   i5   i6</span>
<span id="cb271-3"><a href="explorer.html#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i1 <span class="fl">0.81</span> <span class="fl">0.72</span> <span class="fl">0.63</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.36</span></span>
<span id="cb271-4"><a href="explorer.html#cb271-4" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i2 <span class="fl">0.72</span> <span class="fl">0.64</span> <span class="fl">0.56</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.32</span></span>
<span id="cb271-5"><a href="explorer.html#cb271-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i3 <span class="fl">0.63</span> <span class="fl">0.56</span> <span class="fl">0.49</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.28</span></span>
<span id="cb271-6"><a href="explorer.html#cb271-6" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i4 <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.16</span> <span class="fl">0.20</span> <span class="fl">0.24</span></span>
<span id="cb271-7"><a href="explorer.html#cb271-7" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i5 <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.20</span> <span class="fl">0.25</span> <span class="fl">0.30</span></span>
<span id="cb271-8"><a href="explorer.html#cb271-8" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i6 <span class="fl">0.36</span> <span class="fl">0.32</span> <span class="fl">0.28</span> <span class="fl">0.24</span> <span class="fl">0.30</span> <span class="fl">0.52</span></span>
<span id="cb271-9"><a href="explorer.html#cb271-9" aria-hidden="true" tabindex="-1"></a><span class="fu">paf</span>(<span class="at">covmat =</span> R, <span class="at">nfactors =</span> <span class="dv">2</span>)<span class="sc">$</span>covmat</span>
<span id="cb271-10"><a href="explorer.html#cb271-10" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span>      i1   i2   i3   i4   i5   i6</span>
<span id="cb271-11"><a href="explorer.html#cb271-11" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i1 <span class="fl">0.81</span> <span class="fl">0.72</span> <span class="fl">0.63</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.36</span></span>
<span id="cb271-12"><a href="explorer.html#cb271-12" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i2 <span class="fl">0.72</span> <span class="fl">0.64</span> <span class="fl">0.56</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.32</span></span>
<span id="cb271-13"><a href="explorer.html#cb271-13" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i3 <span class="fl">0.63</span> <span class="fl">0.56</span> <span class="fl">0.49</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.28</span></span>
<span id="cb271-14"><a href="explorer.html#cb271-14" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i4 <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.16</span> <span class="fl">0.20</span> <span class="fl">0.24</span></span>
<span id="cb271-15"><a href="explorer.html#cb271-15" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i5 <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.00</span> <span class="fl">0.20</span> <span class="fl">0.25</span> <span class="fl">0.30</span></span>
<span id="cb271-16"><a href="explorer.html#cb271-16" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> i6 <span class="fl">0.36</span> <span class="fl">0.32</span> <span class="fl">0.28</span> <span class="fl">0.24</span> <span class="fl">0.30</span> <span class="fl">0.52</span></span></code></pre></div>
<p>Les résultats sont toutefois légèrement différents pour les loadings. Cela est dû au fait que <code><a href="https://rdrr.io/r/stats/factanal.html">factanal()</a></code> n’utilise pas la méthode PAF, mais bien le MLFA. Cette technique n’est pas détaillée ici. Elle est très similaire à PAF à l’exception qu’elle focalise sur l’estimation des loadings pour dériver les communalités, plutôt que d’utiliser seulement les communalités. Pour produire une fonction similaire, il faut passer par l’optimisation avec <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> (vue dans <a href="d%C3%A9composer.html#les-calculs-de-lanalyse-en-composantes-principales">Les calculs de l’analyse en composantes principales</a>).</p>
</div>
<div id="rapporter-lanalyse-factorielle" class="section level2" number="19.4">
<h2>
<span class="header-section-number">19.4</span> Rapporter l’analyse factorielle<a class="anchor" aria-label="anchor" href="#rapporter-lanalyse-factorielle"><i class="fas fa-link"></i></a>
</h2>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="d%C3%A9composer.html"><span class="header-section-number">18</span> Décomposer</a></div>
<div class="next"><a href="r%C3%A9duire.html"><span class="header-section-number">20</span> Réduire</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#explorer"><span class="header-section-number">19</span> Explorer</a></li>
<li>
<a class="nav-link" href="#cr%C3%A9ation-de-donn%C3%A9es-2"><span class="header-section-number">19.1</span> Création de données</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#premi%C3%A8re-technique"><span class="header-section-number">19.1.1</span> Première technique</a></li>
<li><a class="nav-link" href="#deuxi%C3%A8me-technique"><span class="header-section-number">19.1.2</span> Deuxième technique</a></li>
<li><a class="nav-link" href="#lanalyse-en-composantes-principales-1"><span class="header-section-number">19.1.3</span> L’analyse en composantes principales</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#analyse-factorielle-exploratoire"><span class="header-section-number">19.2</span> Analyse factorielle exploratoire</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#extraire-les-scores"><span class="header-section-number">19.2.1</span> Extraire les scores</a></li></ul>
</li>
<li><a class="nav-link" href="#calculs-de-lanalyse-factorielle-exploratoire"><span class="header-section-number">19.3</span> Calculs de l’analyse factorielle exploratoire</a></li>
<li><a class="nav-link" href="#rapporter-lanalyse-factorielle"><span class="header-section-number">19.4</span> Rapporter l’analyse factorielle</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/quantmeth/MQR/blob/master/19-Explorer.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/quantmeth/MQR/edit/master/19-Explorer.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Méthodes quantitatives avec R</strong>" was written by P.-O. Caron. It was last built on 2023-04-20.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
