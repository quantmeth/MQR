<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title> 8 Visualiser | Méthodes quantitatives avec R</title>
<meta name="author" content="P.-O. Caron">
<meta name="description" content="La visualisation de données est l’un des deux objectifs fondamentaux de R (l’autre étant évidemment de faire des statistiques). Il existe plusieurs méthodes et packages pour produire rapidement et...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content=" 8 Visualiser | Méthodes quantitatives avec R">
<meta property="og:type" content="book">
<meta property="og:url" content="mqr.teluq.ca/visualiser.html">
<meta property="og:description" content="La visualisation de données est l’un des deux objectifs fondamentaux de R (l’autre étant évidemment de faire des statistiques). Il existe plusieurs méthodes et packages pour produire rapidement et...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" 8 Visualiser | Méthodes quantitatives avec R">
<meta name="twitter:description" content="La visualisation de données est l’un des deux objectifs fondamentaux de R (l’autre étant évidemment de faire des statistiques). Il existe plusieurs méthodes et packages pour produire rapidement et...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- 
    \(
    \newcommand{\EX}{\mathbb{E}}
    \)
    --><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Méthodes quantitatives avec R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Bienvenue!</a></li>
<li><a class="" href="pr%C3%A9face.html">Préface</a></li>
<li class="book-part">Rudiments</li>
<li><a class="" href="commencer.html"><span class="header-section-number">1</span> Commencer</a></li>
<li><a class="" href="programmer.html"><span class="header-section-number">2</span> Programmer</a></li>
<li><a class="" href="calculer.html"><span class="header-section-number">3</span> Calculer</a></li>
<li><a class="" href="r%C3%A9diger.html"><span class="header-section-number">4</span> Rédiger</a></li>
<li><a class="" href="exercice-rudiments.html">Exercices</a></li>
<li class="book-part">Jeux de données</li>
<li><a class="" href="entrer.html"><span class="header-section-number">5</span> Entrer</a></li>
<li><a class="" href="importer.html"><span class="header-section-number">6</span> Importer</a></li>
<li><a class="" href="manipuler.html"><span class="header-section-number">7</span> Manipuler</a></li>
<li><a class="active" href="visualiser.html"><span class="header-section-number">8</span> Visualiser</a></li>
<li><a class="" href="exercice-gestion.html">Exercices</a></li>
<li class="book-part">Statistiques</li>
<li><a class="" href="d%C3%A9crire.html"><span class="header-section-number">9</span> Décrire</a></li>
<li><a class="" href="inf%C3%A9rer.html"><span class="header-section-number">10</span> Inférer</a></li>
<li><a class="" href="analyser.html"><span class="header-section-number">11</span> Analyser</a></li>
<li><a class="" href="simuler.html"><span class="header-section-number">12</span> Simuler</a></li>
<li><a class="" href="exercice-analyse.html">Exercices</a></li>
<li class="book-part">Modèles linéaires</li>
<li><a class="" href="comparer.html"><span class="header-section-number">13</span> Comparer</a></li>
<li><a class="" href="pr%C3%A9dire.html"><span class="header-section-number">14</span> Prédire</a></li>
<li><a class="" href="cr%C3%A9er.html"><span class="header-section-number">15</span> Créer</a></li>
<li><a class="" href="m%C3%A9dier.html"><span class="header-section-number">16</span> Médier</a></li>
<li><a class="" href="mod%C3%A9rer.html"><span class="header-section-number">17</span> Modérer</a></li>
<li><a class="" href="exercice-lineaire.html">Exercices</a></li>
<li class="book-part">Analyses factorielles</li>
<li><a class="" href="d%C3%A9composer.html"><span class="header-section-number">18</span> Décomposer</a></li>
<li><a class="" href="explorer.html"><span class="header-section-number">19</span> Explorer</a></li>
<li><a class="" href="r%C3%A9duire.html"><span class="header-section-number">20</span> Réduire</a></li>
<li><a class="" href="exercice-factoriel.html">Exercices</a></li>
<li class="book-part">Annexes</li>
<li><a class="" href="solutions.html">Solutions</a></li>
<li><a class="" href="r%C3%A9f%C3%A9rences.html">Références</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/quantmeth/MQR">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="visualiser" class="section level1" number="8">
<h1>
<span class="header-section-number"> 8</span> Visualiser<a class="anchor" aria-label="anchor" href="#visualiser"><i class="fas fa-link"></i></a>
</h1>
<p>La visualisation de données est l’un des deux objectifs fondamentaux de <strong>R</strong> (l’autre étant évidemment de faire des statistiques). Il existe plusieurs méthodes et packages pour produire rapidement et simplement des graphiques. Beaucoup de matériel se retrouve en ligne pour maîtriser les graphiques, mais surtout les personnaliser. L’objectif, bien modeste, de cette section n’est pas de rendre le lecteur maître de la production de figures, mais bien de lui faire faire ses premiers pas et de l’outiller pour qu’il puisse produire simplement et rapidement des graphiques de qualité.</p>
<p>L’exemple de cette section est basé sur celui de la section <a href="manipuler.html#manipuler">Manipuler</a>. Voici la syntaxe pour obtenir le jeu de données de nouveau.</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jd</span> <span class="op">&lt;-</span> <span class="va">starwars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">sex</span>, <span class="va">mass</span>, <span class="va">height</span>, <span class="va">species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="st">"Human"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>height <span class="op">=</span> <span class="va">height</span>  <span class="op">/</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>IMC <span class="op">=</span> <span class="va">mass</span> <span class="op">/</span> <span class="va">height</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>  </span></code></pre></div>
<div id="ggplot2" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> ggplot2<a class="anchor" aria-label="anchor" href="#ggplot2"><i class="fas fa-link"></i></a>
</h2>
<p>Le package <code>ggplot2</code> est une extension du <code>tidyverse</code> avec lequel il est possible de créer simplement et rapidement des graphiques. Ces graphiques sont de qualité de publications, idéale pour les articles scientifiques. Le package fournit un langage graphique pour la création intuitive de graphiques compliqués. Il permet à l’utilisateur de créer des graphiques qui représentent des données numériques et catégorielles univariées et multivariées.</p>
<p>La logique de <code>ggplot2</code> repose sur la grammaire des graphiques (<em>Grammar of Graphics</em>), l’idée selon laquelle toutes les figures peuvent être construites à partir des mêmes composantes. Il s’agit de la deuxième version du package. Voilà pour l’appellation <em>ggplot2</em>.</p>
<p>Dans la grammaire de graphique, une figure possède huit niveaux, dont les trois principaux sont les suivants :</p>
<ul>
<li><p><em>data</em>, les données utilisées;</p></li>
<li><p><em>mapping (aesthetic)</em>, cartographier les variables, c’est-à-dire, établir la carte des variables (abscisses, ordonnées, couleur, forme, taille, etc.);</p></li>
<li><p><em>geometric représentation</em>, la représentation géométrique ou le type de représentation graphique, par exemple, diagramme de dispersion, histogramme, boîte à moustache, etc.</p></li>
</ul>
<p>Les cinq autres son, <em>statistics</em>, <em>facet</em>, <em>coordinate space</em>, <em>labels</em>, <em>theme</em> permettent de personnaliser la figure.</p>
<p>Les composantes les plus importantes sont les trois premières, soit les données, la cartographie et la représentation géométrique. Ce sont les éléments de base pour débuter le graphique. Les autres composantes viennent bonifier la figure tout en l’ajustant au besoin de l’utilisateur.</p>
<p>La fonction <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> met en place la figure. Le résultat d’utiliser la fonction <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> seule est illustrée à la Figure <a href="visualiser.html#fig:ggplotseul">8.1</a></p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">jd</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ggplotseul"></span>
<img src="08-Visualiser_files/figure-html/ggplotseul-1.png" alt="La fonction ggplot() seule - Rien" width="75%" height="75%"><p class="caption">
Figure 8.1: La fonction ggplot() seule - Rien
</p>
</div>
<p>Il est aussi possible de <em>piper</em> (prononcé avec un fort accent anglophone) les données dans la fonction.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Pour afficher des graphiques, il faut ajouter <code>+</code>, puis une représentation géométrique ainsi que la cartographie (<em>mapping</em>). La cartographie (<code>aes(mapping = )</code>, où <em>aes</em> désigne l’esthétisme, <em>aesthetic</em>) peut se trouver dans <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> ou dans la représentation géométrique. Si elle est dans <code>ggplot</code>, elle est passée aux autres niveaux.</p>
<p>Voici une liste des représentations géométriques possibles :</p>
<ul>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> crée une ligne qui lie toutes les valeurs, très utiles pour une série temporelle (abscisse = temps, ordonnée = variable dépendante);</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> crée un diagramme de dispersion ou un nuage de point, très utile pour les corrélations;</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> crée un diagramme à bâton, idéal pour présenter des proportions, des fréquences ou des données comptées;</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> crée un histogramme des variables;</p></li>
<li><p><code>geom_box()</code> crée une boîte à moustache, idéal pour identifier des valeurs aberrantes et comparer la variabilité entre des groupes;</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> crée la ligne de prédiction des données avec des intervalles de confiances, la plupart des utilisateurs voudront certainement ces arguments <code>method = lm</code> (par défaut) ou sans l’erreur standard (<code>se = FALSE</code>);</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar()</a></code> ajoute des barres d’erreur ou des intervalles de confiances spécifiées.</p></li>
</ul>
<p>Certaines cartographies sont d’ailleurs compatibles, <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> et <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>, par exemple.</p>
<p>La Figure <a href="visualiser.html#fig:ggplotpoint">8.2</a> montre un diagramme de dispersion construit à partir du jeu de données <code>jd</code> <em>pipé</em> dans la fonction <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. Dans cette fonction, la cartographie est passée <code>mapping = aes(x = mass, y = height)</code> à un second niveau, <code>geom_point)</code> par le <code>+</code> et la représentation est produite.</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mass</span>, y <span class="op">=</span> <span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:ggplotpoint"></span>
<img src="08-Visualiser_files/figure-html/ggplotpoint-1.png" alt="Diagramme de dispersion" width="75%" height="75%"><p class="caption">
Figure 8.2: Diagramme de dispersion
</p>
</div>
<p>Voici une liste d’exemples de différentes représentations visuelles des données.</p>
</div>
<div id="diagramme-de-dispersion" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> Diagramme de dispersion<a class="anchor" aria-label="anchor" href="#diagramme-de-dispersion"><i class="fas fa-link"></i></a>
</h2>
<p>Pour réaliser un diagramme de dispersion, la fonction se nomme <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>. La cartographie identifie la variable à l’axe des <span class="math inline">\(x\)</span> (horizontal) et des <span class="math inline">\(y\)</span> (vertical). Dans cet exemple, il s’agit du poids (<span class="math inline">\(x\)</span>) et de la taille (<span class="math inline">\(y\)</span>). La cartographie ne se limite pas aux axes par contre. Dans cet exemple, la forme <code>shape</code> est aussi un dimension manipulée. Il peut s’agir de <code>color</code> et même de <code>size</code>. Dans la syntaxe ci-dessous, l’argument <code>size</code> est placé à l’extérieur de <em>mapping</em>. Il s’agit alors d’une constante (elle change la taille des points), c’est-à-dire qu’elle ne varie pas relativement à une variable.</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mass</span>, y <span class="op">=</span> <span class="va">height</span>, shape <span class="op">=</span> <span class="va">sex</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:diagdisp"></span>
<img src="08-Visualiser_files/figure-html/diagdisp-1.png" alt="Le lien entre le poids et la taille en fonction du sexe" width="75%" height="75%"><p class="caption">
Figure 8.3: Le lien entre le poids et la taille en fonction du sexe
</p>
</div>
<p>La Figure <a href="visualiser.html#fig:diagdisp2">8.4</a> montre le résultat si `size``est ajouté au <em>mapping</em> pour identifier l’IMC. Les unités avec un plus grand IMC obtiennent un plus gros pointeur.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mass</span>, y <span class="op">=</span> <span class="va">height</span>, shape <span class="op">=</span> <span class="va">sex</span>, size <span class="op">=</span> <span class="va">IMC</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:diagdisp2"></span>
<img src="08-Visualiser_files/figure-html/diagdisp2-1.png" alt="Le lien entre le poids et la taille en fonction de l'IMC et du sexe" width="75%" height="75%"><p class="caption">
Figure 8.4: Le lien entre le poids et la taille en fonction de l’IMC et du sexe
</p>
</div>
<p>On peut y ajouter la droite de régression, comme la Figure <a href="visualiser.html#fig:diagdisp3">8.5</a> le montre. Sans <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code>, la figure ne produit la droite. Les arguments de <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code> indique l’utilisation du modèle linéaire, <code>method = lm</code>, et l’absence des intervalles de confiance, <code>se = FALSE</code>. Dans cette syntaxe, comme le <em>mapping</em> est ajouté à <code>ggplot</code> directement, il se généralise directement à <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> et <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="visualiser.html#cb102-1" aria-hidden="true" tabindex="-1"></a>jd <span class="sc">%&gt;%</span> </span>
<span id="cb102-2"><a href="visualiser.html#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> mass, <span class="at">y =</span> height)) <span class="sc">+</span> </span>
<span id="cb102-3"><a href="visualiser.html#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb102-4"><a href="visualiser.html#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb102-5"><a href="visualiser.html#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="st">`</span><span class="at">geom_smooth()</span><span class="st">`</span> using formula <span class="ot">=</span> <span class="st">'y ~ x'</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:diagdisp3"></span>
<img src="08-Visualiser_files/figure-html/diagdisp3-1.png" alt="Le lien entre le poids et la taille en fonction de l'IMC" width="75%" height="75%"><p class="caption">
Figure 8.5: Le lien entre le poids et la taille en fonction de l’IMC
</p>
</div>
</div>
<div id="boîte-à-moustache" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Boîte à moustache<a class="anchor" aria-label="anchor" href="#bo%C3%AEte-%C3%A0-moustache"><i class="fas fa-link"></i></a>
</h2>
<p>La boîte à moustaches (<em>box-and-whisker plot</em>) est une figure permettant de voir la variabilité des données. Elle résume seulement quelques indicateurs de position soit la médiane, les quartiles, le minimum, et le maximum. Ce diagramme est utilisé principalement pour détecter des valeurs aberrantes et comparer la variabilité entre les groupes. C’est la représentation géométrique <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code> qui permettra de créer des boîtes à moustache. La cartographie prend en argument un variable nominale en <code>x</code> et une variable continue en <code>y</code>. La Figure <a href="visualiser.html#fig:boxplot1">8.6</a> montre un exemple de boîte à moustache.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">jd</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sex</span>, y <span class="op">=</span> <span class="va">IMC</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:boxplot1"></span>
<img src="08-Visualiser_files/figure-html/boxplot1-1.png" alt="Boîte à moustache de l'IMC en fonction du sexe" width="75%" height="75%"><p class="caption">
Figure 8.6: Boîte à moustache de l’IMC en fonction du sexe
</p>
</div>
<p>Une fonction intéressante est la fonction <code><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip()</a></code> qui tourne (<em>flip</em>) les axes, les coordonnées. L’axe <span class="math inline">\(x\)</span> prend la place de <span class="math inline">\(y\)</span>; <span class="math inline">\(y\)</span> prend la place de <span class="math inline">\(x\)</span>. Elle peut être pratique pour améliorer la qualité visuelle de certains graphiques.</p>
</div>
<div id="histogramme" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Histogramme<a class="anchor" aria-label="anchor" href="#histogramme"><i class="fas fa-link"></i></a>
</h2>
<p>Un histogramme permet de représenter la répartition empirique d’une variable. Il donne un aperçu de la distribution sous-jacente, soit comment les données sont distribuées. Cette figure permet de voir la forme de la distribution et permet de voir si elle ne démontre pas d’anomalie. La représentation graphique <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram()</a></code> produit des histogrammes. S’il faut en produire pour différentes variables, une stratégie simple est de les produire en série.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Trois histogrammes en trois figures</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">jd</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">height</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">jd</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mass</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">jd</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">IMC</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Des techniques plus avancées permettent de créer la Figure <a href="visualiser.html#fig:hist">8.7</a> d’un seul coup<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Notamment, le code nécessite &lt;code&gt;gather()&lt;/code&gt; de &lt;code&gt;tidyr&lt;/code&gt;&lt;span class="citation"&gt;(&lt;a href="r%C3%A9f%C3%A9rences.html#ref-R-tidyr" role="doc-biblioref"&gt;Wickham &amp;amp; Girlich, 2022&lt;/a&gt;)&lt;/span&gt; et &lt;code&gt;keep()&lt;/code&gt; de &lt;code&gt;purrr&lt;/code&gt; &lt;span class="citation"&gt;(&lt;a href="r%C3%A9f%C3%A9rences.html#ref-R-purrr" role="doc-biblioref"&gt;Henry &amp;amp; Wickham, 2020&lt;/a&gt;)&lt;/span&gt;.&lt;/p&gt;'><sup>8</sup></a>.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Trois histogrammes en une seule figure</span></span>
<span><span class="co"># en optimisant avec le tidyverse</span></span>
<span><span class="va">jd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html">keep</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">key</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:hist"></span>
<img src="08-Visualiser_files/figure-html/hist-1.png" alt="Histogrammes des variables continues" width="75%" height="75%"><p class="caption">
Figure 8.7: Histogrammes des variables continues
</p>
</div>
<p>Enfin, s’il est désiré de comparer deux distributions de groupes différents, l’argument <code>fill</code> dans la cartographie indique à la fonction de différencier les valeurs selon le <em>remplissage</em> des histogrammes.</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">IMC</span>, fill <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_grey.html">scale_fill_grey</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:hist2"></span>
<img src="08-Visualiser_files/figure-html/hist2-1.png" alt="Histogrammes de l'IMC par rapport au sexe" width="75%" height="75%"><p class="caption">
Figure 8.8: Histogrammes de l’IMC par rapport au sexe
</p>
</div>
<p>Dans la Figure <a href="visualiser.html#fig:hist2">8.8</a>, l’argument <code>position = "identity"</code> indique de traiter les deux groupes comme différents, autrement les colonnes s’additionnent dans le graphique. L’argument <code>alpha = .7</code> permet une transparence entre les couleurs, autrement, les valeurs <em>derrière</em> les autres ne paraissent pas. La valeur de <code>alpha</code> va de 0 (transparent) à 1 (opaque) et fonctionne dans la plupart des contextes, surtout ceux liés à <code>ggplot2</code>.</p>
</div>
<div id="les-barres-derreurs" class="section level2" number="8.5">
<h2>
<span class="header-section-number">8.5</span> Les barres d’erreurs<a class="anchor" aria-label="anchor" href="#les-barres-derreurs"><i class="fas fa-link"></i></a>
</h2>
<p>Les barres d’erreur sont une représentation géométrique à part entière. La fonction pour les commandées est <code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar()</a></code>. Elle nécessite deux arguments, soit l’intervalle de confiance maximale et minimale autour des moyennes à afficher.</p>
<p>La Figure <a href="visualiser.html#fig:erreurbar">8.9</a> illustre les différences entre moyennes avec des barres d’erreur à partir de la base de données <code>ToothGrowth</code>, une étude de l’effet de la vitamine C (<code>dose</code>) selon leur administration (jus ou supplément <code>supp</code>) sur la longueur des dents des cochons d’inde. Il y a deux facteurs et une variable continue.</p>
<p>La première étape est de tirer les statistiques sommaires, moyennes, écart type, tailles des groupes. La syntaxe tire profit de <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> pour tirer les groupes et en faire le sommaire. Le sommaire <code>summarise</code> permet d’obtenir les statistiques, notamment la moyenne, l’erreur standard (<code>se</code>) pour en calculer l’intervalle autour de la moyenne <code>ci</code>.</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stat.descr</span> <span class="op">&lt;-</span> <span class="va">ToothGrowth</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">dose</span>, <span class="va">supp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mlen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">len</span><span class="op">)</span>,</span>
<span>            sdlen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">len</span><span class="op">)</span>,</span>
<span>            nlen <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>            se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">len</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">.975</span>, df <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">se</span>,</span>
<span>            .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stat.descr</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dose</span>,</span>
<span>             y <span class="op">=</span> <span class="va">mlen</span>, </span>
<span>             shape <span class="op">=</span> <span class="va">supp</span><span class="op">)</span>,</span>
<span>         size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">mlen</span> <span class="op">-</span> <span class="va">ci</span>,</span>
<span>                      ymax <span class="op">=</span> <span class="va">mlen</span> <span class="op">+</span> <span class="va">ci</span><span class="op">)</span>, </span>
<span>                  width <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:erreurbar"></span>
<img src="08-Visualiser_files/figure-html/erreurbar-1.png" alt="Les effets de la vitamine C sur les cochons d'inde" width="75%" height="75%"><p class="caption">
Figure 8.9: Les effets de la vitamine C sur les cochons d’inde
</p>
</div>
<p>Une fois ces statistiques calculées et enregistrées dans le nouveau jeu de données <code>jd</code>, il est possible de créer le graphique avec les représentations géométriques désirées. Remarquez comment spécifier la cartographie dans le niveau <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> rend la syntaxe moins compliquée. Cette syntaxe produit un graphique avec <code>dose</code> à l’axe des <span class="math inline">\(x\)</span>, <code>supp</code> comme pointeurs et les moyennes de <code>len</code> (longueur moyenne des dents). La fonction <code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar()</a></code> indique où placer les limites inférieures et supérieures des intervalles. Les arguments <code>size = 5</code> et <code>width = .05</code> sont ajoutés simplment pour l’esthétisme. L’argument <code>.groups = "drop"</code> de <code>summarise</code> permet d’éviter une avertissement expliquant qu’une variable de groupement est utilisé pour regrouper les résultats à la fin. Ajouter ou retirer cet argument ne change pas les calculs, ni la Figure <a href="visualiser.html#fig:erreurbar">8.9</a>.</p>
</div>
<div id="de-meilleures-barres-derreurs-pour-les-devis-inter-participants" class="section level2" number="8.6">
<h2>
<span class="header-section-number">8.6</span> De meilleures barres d’erreurs pour les devis inter participants<a class="anchor" aria-label="anchor" href="#de-meilleures-barres-derreurs-pour-les-devis-inter-participants"><i class="fas fa-link"></i></a>
</h2>
<p>Il existe un package <code>superb</code> <span class="citation">(<a href="r%C3%A9f%C3%A9rences.html#ref-superb" role="doc-biblioref">Cousineau et al., 2021</a>)</span> qui permet d’obtenir des graphiques à barre d’erreur avec précision et facilement ajustable. Une fois installé et importé dans l’environnement, <code>superb</code> offre la fonction principale <code>superbPlot</code> permet la création de ces figures.</p>
<p>Il y a deux avantages principales a utilisé <code>superb</code>. La première est qu’elle permet des ajustements avec l’argument <code>adjustments</code> afin de préciser le type de barres d’erreurs<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Oui, oui, il en existe plusieurs!&lt;/p&gt;"><sup>9</sup></a>, comme <code>"single"</code>, <code>"difference"</code>, ou <code>"tryon"</code>. Généralement, ce sera l’option <code>purpose = "difference"</code> qui sera désirée. Deuxièmement, <code>superb</code> tient aussi compte des devis intra participants avec l’argument <code>WSFactors</code>, ce qui permet l’utilisation de différentes techniques de décorrélation des temps de mesure. La fonction produit de bien meilleurs graphiques à barres d’erreurs avec plus d’ajustement et de précision.</p>
<p>La Figure <a href="visualiser.html#fig:erreurbar2">8.10</a> reproduit la Figure <a href="visualiser.html#fig:erreurbar">8.9</a>. Dans le code, il faut préciser les facteurs inter participants <code>BSFactors</code> (pour <em>between subject</em> ou <em>BS</em>) et la variable dépendante, <code>variable</code>. La fonction contrôle aussi le type de graphique avec <code>plotStyle</code>.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dcousin3.github.io/superb/">superb</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="http://dcousin3.github.io/superb/reference/superbPlot.html">superbPlot</a></span><span class="op">(</span><span class="va">ToothGrowth</span>, </span>
<span>    BSFactors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dose"</span>,<span class="st">"supp"</span><span class="op">)</span>, </span>
<span>    variables <span class="op">=</span> <span class="st">"len"</span>,</span>
<span>    plotStyle <span class="op">=</span> <span class="st">"line"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:erreurbar2"></span>
<img src="08-Visualiser_files/figure-html/erreurbar2-1.png" alt="Les effets de la vitamine C sur les cochons d'inde avec `superb`" width="75%" height="75%"><p class="caption">
Figure 8.10: Les effets de la vitamine C sur les cochons d’inde avec <code>superb</code>
</p>
</div>
<p>La fonction retourne souvent des messages d’avertissement (orange) pour préciser certaines décisions qu’elle peut avoir pris. Le code ci-dessus retourne le message : <code>superb::FYI: The variables will be plotted in that order: dose, supp (use factorOrder to change).</code>. C’est à l’utilisateur d’en prendre note et de s’assurer que c’était bien ce qui était désiré, ce qui est le cas ici.</p>
<p>Pour plus de flexibilité pour l’utilisateur, les statistiques descriptives peuvent être obtenues afin de produire personnellement les figures, comme cela avait été fait dans le premier exemple sur <a href="visualiser.html#les-barres-derreurs">Les barres d’erreurs</a>.</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stat.descr</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://dcousin3.github.io/superb/reference/superbData.html">superbData</a></span><span class="op">(</span><span class="va">ToothGrowth</span>, </span>
<span>                         BSFactors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dose"</span>,<span class="st">"supp"</span><span class="op">)</span>, </span>
<span>                         variables <span class="op">=</span> <span class="st">"len"</span>,</span>
<span>                         adjustments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Attention! Cette variable est une liste contenant deux éléments, les statistiques descriptives (<code>$summaryStatistics</code>) et les données brutes (<code>$rawData</code>). Elle peuvent être extraites avec le signe <code>$</code>, comme <code>stat.descr$summaryStatistics</code>.</p>
<p>Pour reproduire la Figure <a href="visualiser.html#fig:erreurbar">8.9</a> avec le jeu de données extrait de <code><a href="http://dcousin3.github.io/superb/reference/superbData.html">superbData()</a></code>, il faut procéder à quelques ajustements, comme le nom des variables qui ne sont pas les mêmes, et le fait que la variable <code>dose</code> est maintenant traitée en variable nominale, alors qu’il est souhaitable qu’elle soit numérique pour utiliser la représentation géométrique <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code>. La Figure <a href="visualiser.html#fig:erreurbar3">8.11</a> illustre le résultat.</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stat.descr</span><span class="op">$</span><span class="va">summaryStatistics</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">dose</span><span class="op">)</span>,</span>
<span>             y <span class="op">=</span> <span class="va">center</span>, </span>
<span>             shape <span class="op">=</span> <span class="va">supp</span><span class="op">)</span>,</span>
<span>         size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">center</span> <span class="op">+</span> <span class="va">lowerwidth</span>,</span>
<span>                      ymax <span class="op">=</span> <span class="va">center</span> <span class="op">+</span> <span class="va">upperwidth</span><span class="op">)</span>, </span>
<span>                  width <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:erreurbar3"></span>
<img src="08-Visualiser_files/figure-html/erreurbar3-1.png" alt="Les effets de la vitamine C sur les cochons d'inde avec `superb`" width="75%" height="75%"><p class="caption">
Figure 8.11: Les effets de la vitamine C sur les cochons d’inde avec <code>superb</code>
</p>
</div>
</div>
<div id="de-meilleures-barres-derreur-pour-les-devis-intra-participants" class="section level2" number="8.7">
<h2>
<span class="header-section-number">8.7</span> De meilleures barres d’erreur pour les devis intra participants<a class="anchor" aria-label="anchor" href="#de-meilleures-barres-derreur-pour-les-devis-intra-participants"><i class="fas fa-link"></i></a>
</h2>
<p>La fonction <code><a href="http://dcousin3.github.io/superb/reference/superbPlot.html">superbPlot()</a></code> permet non seulement de produire des barres d’erreurs pour les devis inter participants (deux ou plusieurs groupes de participants différent dans chaque groupe), mais également pour les devis intra partipants (les mêmes participants mesurés plusieurs fois). Elle excelle d’ailleurs dans ce domaine, car elle permet d’ajuster pour type d’intervalle de confiance désiré, mais aussi pour l’ajustement intra participant.</p>
<p>Voici un jeu de données synthétiques pour réaliser une figure avec un devis intra participant. Voir <a href="analyser.html#le-test-t-d%C3%A9pendant">Le test-<span class="math inline">\(t\)</span> dépendant</a> pour plus de détails sur la création de ces données.</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Un exemple de jeu de données</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">148</span><span class="op">)</span></span>
<span><span class="va">temps1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">difference</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">temps2</span> <span class="op">&lt;-</span> <span class="va">temps1</span> <span class="op">+</span> <span class="va">difference</span></span>
<span><span class="va">jd_intra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>temps1 <span class="op">=</span> <span class="va">temps1</span>,</span>
<span>                 temps2 <span class="op">=</span> <span class="va">temps2</span><span class="op">)</span></span></code></pre></div>
<p>Pour produire la figure, il faut définir le facteur intra participant (<em>within subject</em> ou <em>WS</em>) par l’argument <code>WSFactors</code>. Cette argument est particulier, il nécessite un mot arbitraire pour identifier l’effet temporelle, ici <code>WSFactors = "temps</code>, mais aussi entre parenthèses, le nombre de temps de mesures, ici <code>"(2)"</code>, ce qui forme l’argument complet <code>WSFactors = "temps(2)"</code>. Ensuite, pour la variable dépendante, on combine ensemble tous les temps de mesure spécifiés, ici <code>variables = c("temps1", "temps2")</code>. Il reste à définir le style de graphique et les ajustements. Pour l’objectif (<code>purpose</code>), ce sont les mêmes options que pour les devis inter participants, soit (<code>"single"</code>, <code>"difference"</code> ou <code>"tryon"</code>).</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="http://dcousin3.github.io/superb/reference/superbPlot.html">superbPlot</a></span><span class="op">(</span><span class="va">jd_intra</span>, </span>
<span>    WSFactors <span class="op">=</span> <span class="st">"temps(2)"</span>, </span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"temps1"</span>, <span class="st">"temps2"</span><span class="op">)</span>,</span>
<span>    plotStyle <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>    adjustments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:erreurbar4"></span>
<img src="08-Visualiser_files/figure-html/erreurbar4-1.png" alt="Comparaison de deux temps de mesure avec `superb` (sans décorrélation)" width="75%" height="75%"><p class="caption">
Figure 8.12: Comparaison de deux temps de mesure avec <code>superb</code> (sans décorrélation)
</p>
</div>
<p>La Figure <a href="visualiser.html#fig:erreurbar4">8.12</a> montre le résultat obtenu.</p>
<p>Le package <code>superb</code> permet aussi l’utilisation de techniques de décorrélation comme <code>"CM"</code>, <code>"LM"</code>, <code>"CA"</code> ou <code>"none"</code> (par défaut) pour améliorer les intervalles de confiance. Consultez la documentation pour en savoir plus sur son fonctionnement et ce qui conviendra le mieux à la situation qui se présente. Pour l’implantation, il suffit d’ajouter à la liste d’arguments fournie à <code>adjustements</code>, le type de décorrlation désirée, ici <code>decorrelation = "CM"</code>).</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="http://dcousin3.github.io/superb/reference/superbPlot.html">superbPlot</a></span><span class="op">(</span><span class="va">jd_intra</span>, </span>
<span>    WSFactors <span class="op">=</span> <span class="st">"temps(2)"</span>, </span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"temps1"</span>, <span class="st">"temps2"</span><span class="op">)</span>,</span>
<span>    plotStyle <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>    adjustments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span>, decorrelation <span class="op">=</span> <span class="st">"CM"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:erreurbar5"></span>
<img src="08-Visualiser_files/figure-html/erreurbar5-1.png" alt="Comparaison de deux temps de mesure avec `superb` (avec décorrélation)" width="75%" height="75%"><p class="caption">
Figure 8.13: Comparaison de deux temps de mesure avec <code>superb</code> (avec décorrélation)
</p>
</div>
<p>Les barres d’erreur de la Figure <a href="visualiser.html#fig:erreurbar5">8.13</a> sont légèrement différentes de la Figure <a href="visualiser.html#fig:erreurbar4">8.12</a>, mais plus adéquates pour illustrer les résultats.</p>
</div>
<div id="quelques-trucs-en-rafale" class="section level2" number="8.8">
<h2>
<span class="header-section-number">8.8</span> Quelques trucs en rafale<a class="anchor" aria-label="anchor" href="#quelques-trucs-en-rafale"><i class="fas fa-link"></i></a>
</h2>
<p>Il est possible de renommer les axes avec <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab()</a></code> et <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab()</a></code> et le titre avec <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code>.</p>
<p>Plusieurs ajustements des axes sont possibles avec <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous()</a></code> et <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous()</a></code> et leur équivalent nominal <code><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_y_discrete()</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete()</a></code> , comme ajuster les limites (<code>limits</code>), les marqueurs (<code>breaks</code>) et les libellées des marqueurs (<code>labels</code>).</p>
<p>Il est possible de séparer une Figure en différents cadran en spécifiant une variable de séparation avec <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> ou <code><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid()</a></code>.</p>
</div>
<div id="exporter-la-figure" class="section level2" number="8.9">
<h2>
<span class="header-section-number">8.9</span> Exporter la figure<a class="anchor" aria-label="anchor" href="#exporter-la-figure"><i class="fas fa-link"></i></a>
</h2>
<p>Pour exporter une figure, <code>ggplot2</code> offre la très conviviale fonction <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave()</a></code> qui permet d’enregistrer <strong>la dernière figure</strong> produite en fichier. Celle-ci vient avec plusieurs options pour gérer l’enregistrement.</p>
<p>L’option <code>filename</code> gère le nom du fichier le nom et le type de fichier, comme les usuels <code>"pdf"</code>, <code>"jpeg"</code>, <code>"png"</code>, ou les moins fréquents, mais aussi pratiques <code>"bmp"</code>, <code>"eps"</code>, <code>"tiff"</code>, <code>"ps"</code>, <code>"tex"</code>, <code>"svg"</code> et <code>"wmf"</code>.</p>
<p>Les options <code>width</code> (largeur), <code>height</code> (hauteur), et <code>units</code> (unités, comme <code>"in"</code>, pouce, <code>"cm"</code>, centimètre, <code>"mm"</code>, millimètre ou <code>"px"</code>, pixel) gère la taille de la figure.</p>
<p>La taille de résolution de la figure est gérée avec l’argument <code>dpi</code>, ce qui peut être utile pour augmenter la qualité de la figure produite.</p>
<p>Voici un exemple.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="visualiser.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Préalablement produire une figure</span></span>
<span id="cb114-2"><a href="visualiser.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"mafigure.pdf"</span>,</span>
<span id="cb114-3"><a href="visualiser.html#cb114-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="st">"6"</span></span>
<span id="cb114-4"><a href="visualiser.html#cb114-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">heigth =</span> <span class="st">"8"</span>,</span>
<span id="cb114-5"><a href="visualiser.html#cb114-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">unit =</span> <span class="st">"cm"</span>)</span></code></pre></div>
<p>Il faudra éventuellement ajuster la taille et la qualité de la figure en fonction de la sortie désirée. Quelques essais seront probablement nécessaires pour y arriver.</p>
</div>
<div id="pour-aller-plus-loin-1" class="section level2" number="8.10">
<h2>
<span class="header-section-number">8.10</span> Pour aller plus loin<a class="anchor" aria-label="anchor" href="#pour-aller-plus-loin-1"><i class="fas fa-link"></i></a>
</h2>
<p>Il existe une multitudes de livres, de sites web, de tutoriels en ligne et d’atelier pour donner l’occasion au lecteur d’aller plus loin dans sa conception graphique. Voici quelques ouvrages de références : Le <em>R Graphics Cookbook</em> (Chang) repérable à <a href="https://r-graphics.org/" class="uri">https://r-graphics.org/</a>, <em>ggplot2: elegant graphics for data analysis</em> (Wickham) repérable à <a href="https://ggplot2-book.org/" class="uri">https://ggplot2-book.org/</a> ou <em>R Graphics</em> (Murrel) repérable à <a href="https://www.stat.auckland.ac.nz/~paul/RG2e/" class="uri">https://www.stat.auckland.ac.nz/~paul/RG2e/</a>.</p>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="manipuler.html"><span class="header-section-number">7</span> Manipuler</a></div>
<div class="next"><a href="exercice-gestion.html">Exercices</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#visualiser"><span class="header-section-number">8</span> Visualiser</a></li>
<li><a class="nav-link" href="#ggplot2"><span class="header-section-number">8.1</span> ggplot2</a></li>
<li><a class="nav-link" href="#diagramme-de-dispersion"><span class="header-section-number">8.2</span> Diagramme de dispersion</a></li>
<li><a class="nav-link" href="#bo%C3%AEte-%C3%A0-moustache"><span class="header-section-number">8.3</span> Boîte à moustache</a></li>
<li><a class="nav-link" href="#histogramme"><span class="header-section-number">8.4</span> Histogramme</a></li>
<li><a class="nav-link" href="#les-barres-derreurs"><span class="header-section-number">8.5</span> Les barres d’erreurs</a></li>
<li><a class="nav-link" href="#de-meilleures-barres-derreurs-pour-les-devis-inter-participants"><span class="header-section-number">8.6</span> De meilleures barres d’erreurs pour les devis inter participants</a></li>
<li><a class="nav-link" href="#de-meilleures-barres-derreur-pour-les-devis-intra-participants"><span class="header-section-number">8.7</span> De meilleures barres d’erreur pour les devis intra participants</a></li>
<li><a class="nav-link" href="#quelques-trucs-en-rafale"><span class="header-section-number">8.8</span> Quelques trucs en rafale</a></li>
<li><a class="nav-link" href="#exporter-la-figure"><span class="header-section-number">8.9</span> Exporter la figure</a></li>
<li><a class="nav-link" href="#pour-aller-plus-loin-1"><span class="header-section-number">8.10</span> Pour aller plus loin</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/quantmeth/MQR/blob/master/08-Visualiser.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/quantmeth/MQR/edit/master/08-Visualiser.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Méthodes quantitatives avec R</strong>" was written by P.-O. Caron. It was last built on 2024-09-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
